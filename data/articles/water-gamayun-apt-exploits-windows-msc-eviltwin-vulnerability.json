{
  "id": "8412e817-3f3f-4409-bf6e-83b7056de636",
  "slug": "water-gamayun-apt-exploits-windows-msc-eviltwin-vulnerability",
  "headline": "Water Gamayun APT Exploits Novel 'MSC EvilTwin' Windows Flaw in Stealthy Attacks",
  "title": "Russia-Aligned Water Gamayun APT Exploits Windows MMC Vulnerability (CVE-2025-26633) in Sophisticated Campaign",
  "summary": "The Russia-aligned APT group Water Gamayun is actively exploiting a novel vulnerability in the Windows Microsoft Management Console (MMC), tracked as CVE-2025-26633. The attack, analyzed by Zscaler and dubbed 'MSC EvilTwin,' uses a malicious .msc file to proxy code execution through the trusted mmc.exe binary, making it difficult to detect. The multi-stage campaign begins with a malicious download and uses embedded commands to execute hidden PowerShell payloads. This technique allows the attackers to install backdoors and information stealers while evading traditional security measures, showcasing the group's continued sophistication in developing stealthy intrusion methods.",
  "full_report": "## Executive Summary\nResearchers have uncovered a sophisticated campaign by the Russia-aligned APT group **Water Gamayun** (also known as EncryptHub) that leverages a newly identified vulnerability in the Windows Microsoft Management Console (MMC). The vulnerability, **[CVE-2025-26633](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-26633)**, has been dubbed \"MSC EvilTwin\" and allows for arbitrary code execution through a trusted Windows process, `mmc.exe`. The attack chain, detailed by **[Zscaler's](https://www.zscaler.com/)** threat hunting team, involves tricking a user into opening a malicious `.msc` file. This file exploits the vulnerability to load a rogue component that, in turn, executes a series of obfuscated PowerShell payloads. This method of proxying execution through a legitimate system binary is a powerful defense evasion technique. The campaign's objective is believed to be the deployment of the group's signature malware, including backdoors and information stealers, for long-term espionage.\n\n---\n\n## Vulnerability Details\n- **CVE ID:** **[CVE-2025-26633](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-26633)**\n- **Affected Software:** **[Microsoft](https://www.microsoft.com/)** Windows (Microsoft Management Console - `mmc.exe`)\n- **Vulnerability Type:** Code execution via multilingual path resolution flaw.\n\n The \"MSC EvilTwin\" vulnerability resides in how the MMC handles path resolution for snap-in modules. By crafting a malicious `.msc` file, an attacker can cause `mmc.exe` to load a malicious snap-in from an attacker-controlled path. Because `mmc.exe` is a signed, trusted Microsoft binary, this action may not be flagged as suspicious by basic security tools. The malicious snap-in's TaskPad can contain embedded commands, which in this campaign are used to launch a Base64-encoded PowerShell script, kicking off the next stage of the attack while a decoy document is displayed to the user.\n\n## Threat Overview\nThe multi-stage attack proceeds as follows:\n1.  **Initial Access:** The user is redirected from a legitimate website to a lookalike domain and tricked into downloading a RAR archive disguised as a PDF.\n2.  **Execution:** The archive contains a malicious `.msc` file. When the user opens it, `mmc.exe` is launched, exploiting **CVE-2025-26633**.\n3.  **Defense Evasion:** `mmc.exe` loads a rogue snap-in, which executes an embedded PowerShell command. This technique is a form of signed binary proxy execution.\n4.  **Payload Delivery:** The initial PowerShell script is heavily obfuscated and runs a series of hidden stages to download and execute the final payload. \n\nWhile the C2 server for the final payload was inactive during analysis, Water Gamayun is known to deploy malware such as the **SilentPrism** and **DarkWisp** backdoors, or the **EncryptHub** and **Rhadamanthys** information stealers.\n\n## Technical Analysis\nThis campaign showcases the actor's focus on stealth and defense evasion by living off the land and abusing trusted system components.\n\n**MITRE ATT&CK Techniques Observed:**\n- **Initial Access:** [`T1189 - Drive-by Compromise`](https://attack.mitre.org/techniques/T1189/) leading to user download of a malicious file.\n- **Execution:** [`T1204.002 - Malicious File`](https://attack.mitre.org/techniques/T1204/002/) (opening the `.msc` file).\n- **Defense Evasion & Execution:** [`T1218.014 - Signed Script Proxy Execution`](https://attack.mitre.org/techniques/T1218/014/) is the core of the attack, using `mmc.exe` to run malicious code. The use of PowerShell also maps to [`T1059.001 - PowerShell`](https://attack.mitre.org/techniques/T1059/001/).\n- **Defense Evasion:** [`T1027 - Obfuscated Files or Information`](https://attack.mitre.org/techniques/T1027/) is used for the Base64-encoded PowerShell payload.\n- **Command and Control:** [`T1071.001 - Web Protocols`](https://attack.mitre.org/techniques/T1071/001/) would be used by the final payload to communicate with the C2 server.\n\n## Impact Assessment\nThe primary impact of this campaign is successful, stealthy espionage. By using a novel vulnerability and proxying execution through `mmc.exe`, Water Gamayun can bypass security controls and establish a persistent foothold in target networks. Once their backdoors or stealers are installed, they can exfiltrate sensitive data, intellectual property, and credentials over a long period. For affected government and enterprise networks, this can lead to significant data loss and a compromise of strategic information. The reliance on a trusted binary makes detection challenging, meaning the attackers could dwell in the network for an extended time before being discovered.\n\n## IOCs\nNo specific file hashes or C2 domains were provided in the source articles.\n\n## Cyber Observables for Detection\n- **Command Line Monitoring:** Look for `mmc.exe` being launched with unusual file paths or from suspicious sources (e.g., from a `.zip` or `.rar` file in the user's `Downloads` folder).\n- **Process Relationships:** Monitor for `mmc.exe` spawning child processes, especially `powershell.exe`. This is highly anomalous behavior for the Microsoft Management Console and a strong indicator of this attack technique.\n- **PowerShell Logging:** Enable PowerShell Script Block Logging (Event ID 4104) to capture and analyze the content of PowerShell scripts, even if they are Base64-encoded or run in memory.\n\n| Type | Value | Description |\n|---|---|---|\n| `process_name` | `mmc.exe` | Monitor for `mmc.exe` spawning child processes like `powershell.exe` or `cmd.exe`. |\n| `file_name` | `*.msc` | Scrutinize `.msc` files originating from untrusted sources like email attachments or web downloads. |\n| `command_line_pattern` | `powershell.exe -enc` | The presence of encoded PowerShell commands is a common evasion technique that warrants investigation. |\n\n## Detection & Response\n- **EDR Rule Creation:** Configure EDR solutions to alert on the specific parent-child process relationship of `mmc.exe` launching `powershell.exe`. This is a high-fidelity detection for the MSC EvilTwin technique ([`D3-PA: Process Analysis`](https://d3fend.mitre.org/technique/d3f:ProcessAnalysis)).\n- **File Analysis:** Use sandboxing technology ([`D3-DA: Dynamic Analysis`](https://d3fend.mitre.org/technique/d3f:DynamicAnalysis)) to analyze `.msc` files from suspicious sources. A sandbox can detonate the file in a safe environment and reveal the subsequent malicious PowerShell execution.\n- **Threat Hunting:** Proactively hunt for the observables listed above. Query historical process execution logs for instances of `mmc.exe` spawning unexpected child processes.\n\n## Mitigation\n- **Patching:** Apply the security update from Microsoft that addresses **CVE-2025-26633** as soon as it becomes available ([`D3-SU: Software Update`](https://d3fend.mitre.org/technique/d3f:SoftwareUpdate)).\n- **Attack Surface Reduction:** Block `.msc` files from being downloaded from the internet or received as email attachments if there is no business need for them. This can be configured at the email gateway and web proxy.\n- **Application Control:** Use application control solutions like AppLocker to restrict the execution of PowerShell scripts. Constrained Language Mode can limit the ability of PowerShell to execute malicious commands ([`D3-EAL: Executable Allowlisting`](https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting)).\n- **User Training:** Train users to be suspicious of unexpected file downloads, especially archives disguised as documents.",
  "twitter_post": "⚠️ Russia-aligned APT Water Gamayun exploits novel 'MSC EvilTwin' Windows flaw (CVE-2025-26633). The attack uses malicious .msc files to proxy PowerShell execution via mmc.exe, bypassing defenses. #APT #Vulnerability #CyberAttack #WaterGamayun",
  "meta_description": "The Russia-aligned APT group Water Gamayun is exploiting a new Windows Microsoft Management Console vulnerability, CVE-2025-26633, to deliver stealthy PowerShell payloads.",
  "category": [
    "Threat Actor",
    "Vulnerability",
    "Malware"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Water Gamayun",
      "type": "threat_actor"
    },
    {
      "name": "Zscaler",
      "type": "vendor",
      "url": "https://www.zscaler.com/"
    },
    {
      "name": "Microsoft",
      "type": "vendor",
      "url": "https://www.microsoft.com/"
    },
    {
      "name": "SilentPrism",
      "type": "malware"
    },
    {
      "name": "DarkWisp",
      "type": "malware"
    },
    {
      "name": "EncryptHub",
      "type": "malware"
    },
    {
      "name": "Rhadamanthys",
      "type": "malware",
      "url": "https://malpedia.caad.fkie.fraunhofer.de/details/win.rhadamanthys"
    }
  ],
  "cves": [
    {
      "id": "CVE-2025-26633",
      "kev": false
    }
  ],
  "sources": [
    {
      "url": "https://securityboulevard.com/2025/11/zscaler-threat-hunting-discovers-and-reconstructs-a-sophisticated-water-gamayun-apt-group-attack/",
      "title": "Zscaler Threat Hunting Discovers and Reconstructs a Sophisticated Water Gamayun APT Group Attack",
      "date": "2025-11-25",
      "friendly_name": "Security Boulevard",
      "website": "securityboulevard.com"
    },
    {
      "url": "https://www.securityweek.com/gamayun-apt-exploits-new-msc-eviltwin-vulnerability-to-deliver-malicious-payloads/",
      "title": "Gamayun APT Exploits New MSC EvilTwin Vulnerability to Deliver Malicious Payloads",
      "date": "2025-11-26",
      "friendly_name": "SecurityWeek",
      "website": "securityweek.com"
    },
    {
      "url": "https://cyberpress.com/gamayun-apt-exploits-msc-eviltwin-flaw-to-deploy-malicious-code/",
      "title": "Gamayun APT Exploits MSC EvilTwin Flaw to Deploy Malicious Code",
      "date": "2025-11-25",
      "friendly_name": "Cyber Press",
      "website": "cyberpress.com"
    },
    {
      "url": "https://www.broadcom.com/support/security-center/attacksignatures/detail?id=37750",
      "title": "EncryptHub attackers exploit MMC CVE-2025-26633 vulnerability for payload delivery",
      "date": "2025-08-20",
      "friendly_name": "Broadcom Inc.",
      "website": "broadcom.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1218.014",
      "name": "Signed Script Proxy Execution",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1059.001",
      "name": "PowerShell",
      "tactic": "Execution"
    },
    {
      "id": "T1204.002",
      "name": "Malicious File",
      "tactic": "Execution"
    },
    {
      "id": "T1189",
      "name": "Drive-by Compromise",
      "tactic": "Initial Access"
    },
    {
      "id": "T1027",
      "name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "Apply the patch for CVE-2025-26633 from Microsoft to eliminate the vulnerability.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "d3fend_techniques": [
        {
          "id": "D3-EAL",
          "name": "Executable Allowlisting",
          "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting"
        }
      ],
      "description": "Use application control to prevent mmc.exe from launching PowerShell or to restrict PowerShell itself.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "description": "Enable detailed process creation and PowerShell logging to detect the anomalous behavior associated with this attack.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-PA",
      "technique_name": "Process Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:ProcessAnalysis",
      "recommendation": "The core of the 'MSC EvilTwin' attack is the abuse of a legitimate process (`mmc.exe`) to launch a malicious one (`powershell.exe`). This makes Process Analysis, specifically monitoring parent-child process relationships, the most effective detection technique. Security teams must configure their EDR or SIEM to generate a high-severity alert whenever the parent process `mmc.exe` is observed spawning a child process of `powershell.exe` or `cmd.exe`. This is extremely anomalous behavior; the Microsoft Management Console has no legitimate reason to launch a command shell. By creating this specific detection rule, defenders can create a high-fidelity tripwire for this exact TTP. This moves beyond simple signature-based detection and focuses on the behavioral artifact of the attack, making it resilient to changes in the malware's file hash or the content of the PowerShell script.",
      "mitre_mitigation_id": "M1049"
    },
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "The most definitive mitigation for the Water Gamayun campaign is to apply the security patch from Microsoft that remediates CVE-2025-26633. A robust and timely patch management program is fundamental to cybersecurity. Organizations should use automated tools to scan their environment for all Windows systems vulnerable to this flaw. Prioritization should be given to workstations of users with privileged access and those in sensitive departments (e.g., finance, legal, R&D), as they are common APT targets. The patch should be deployed as soon as possible after appropriate testing. Verifying successful installation across the enterprise is a critical final step. Until the patch is deployed, the detection and hardening measures serve as crucial compensating controls, but patching is the only way to fully eliminate the underlying vulnerability.",
      "mitre_mitigation_id": "M1051"
    },
    {
      "technique_id": "D3-ITF",
      "technique_name": "Inbound Traffic Filtering",
      "url": "https://d3fend.mitre.org/technique/d3f:InboundTrafficFiltering",
      "recommendation": "To disrupt the initial access stage of this attack, organizations should implement strict inbound traffic filtering at their email gateways and web proxies. Since the attack begins with a user downloading a malicious RAR archive containing a `.msc` file, security policies should be configured to block these file types from being downloaded or received as attachments. There are very few legitimate business reasons for users to receive `.msc` (Microsoft Saved Console) files from external sources. By blocking this file extension, along with other script-based files (`.js`, `.vbs`, etc.) and archives containing them, organizations can significantly reduce their attack surface and prevent the 'MSC EvilTwin' payload from ever reaching the endpoint. This is a proactive hardening measure that stops the attack chain at the very first step.",
      "mitre_mitigation_id": "M1037"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "process_name",
      "value": "mmc.exe",
      "description": "The core of the attack involves abusing the Microsoft Management Console. Monitor for it spawning suspicious child processes.",
      "context": "EDR logs, Windows Event ID 4688. Look for parent process 'mmc.exe' and child process 'powershell.exe'.",
      "confidence": "high"
    },
    {
      "type": "file_name",
      "value": "*.msc",
      "description": "The initial attack vector is a malicious .msc file. Files of this type from the internet are highly suspicious.",
      "context": "Email gateway logs, web proxy logs, EDR file creation events.",
      "confidence": "medium"
    },
    {
      "type": "log_source",
      "value": "PowerShell Script Block Logging (Event ID 4104)",
      "description": "This logging provides the full content of PowerShell scripts as they are executed, defeating most obfuscation.",
      "context": "Windows Event Logs. This must be enabled via Group Policy.",
      "confidence": "high"
    }
  ],
  "tags": [
    "Water Gamayun",
    "APT",
    "CVE-2025-26633",
    "MSC EvilTwin",
    "Microsoft Management Console",
    "PowerShell",
    "Defense Evasion",
    "Zscaler"
  ],
  "extract_datetime": "2025-11-26T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Government",
      "Technology"
    ],
    "other_affected": [
      "Enterprise networks"
    ]
  },
  "keywords": [
    "Water Gamayun",
    "CVE-2025-26633",
    "MSC EvilTwin",
    "mmc.exe exploit",
    "signed binary proxy execution",
    "PowerShell attack",
    "Zscaler threat hunting",
    "Russia APT"
  ],
  "pub_date": "2025-11-26",
  "reading_time_minutes": 6,
  "createdAt": "2025-11-26T15:00:00.000Z",
  "updatedAt": "2025-11-26T15:00:00.000Z"
}