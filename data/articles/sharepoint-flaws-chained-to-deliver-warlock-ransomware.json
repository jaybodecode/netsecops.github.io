{
  "id": "8d900499-58e3-4940-b94c-f06074f2bb17",
  "slug": "sharepoint-flaws-chained-to-deliver-warlock-ransomware",
  "headline": "SharePoint Flaw Chain Exploited to Deploy Warlock Ransomware",
  "title": "Storm-2603 Threat Actor Abuses SharePoint Vulnerabilities and Velociraptor Tool to Deploy Warlock Ransomware",
  "summary": "A new attack campaign attributed to the threat actor Storm-2603 is exploiting a chain of Microsoft SharePoint vulnerabilities (CVE-2025-49706, CVE-2025-49704) for initial access. Post-exploitation, the attackers deploy Velociraptor, a legitimate digital forensics and incident response (DFIR) tool, for reconnaissance and persistence. By abusing a trusted tool, the attackers blend in with normal administrative activity, evading detection. In several confirmed incidents, this attack chain culminates in the deployment of the Warlock ransomware. This 'living-off-the-land' technique highlights a sophisticated approach to facilitating ransomware attacks.",
  "full_report": "## Executive Summary\nThe threat actor **Storm-2603** is conducting a sophisticated ransomware campaign that begins with the exploitation of a vulnerability chain in **[Microsoft SharePoint](https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration)**. The flaws, tracked as **CVE-2025-49706** and **CVE-2025-49704** (collectively 'ToolShell'), are used to gain initial access to enterprise networks. In a clever 'living-off-the-land' (LotL) tactic, the attackers then deploy **[Velociraptor](https://www.velocidex.com/)**, a legitimate and powerful open-source digital forensics tool. By abusing this trusted tool, **Storm-2603** can perform reconnaissance, move laterally, and maintain persistence while evading detection. The ultimate goal of the campaign is to deploy the **Warlock** ransomware as the final payload, encrypting victim data for extortion. This campaign showcases the growing trend of threat actors co-opting legitimate security tools for malicious purposes.\n\n---\n\n## Threat Overview\n*   **Threat Actor**: **Storm-2603**.\n*   **Initial Access Vector**: Exploitation of a vulnerability chain in Microsoft SharePoint (**CVE-2025-49706** and **CVE-2025-49704**).\n*   **Key Tool**: **Velociraptor**, a legitimate DFIR tool, is abused for post-exploitation activities.\n*   **Final Payload**: **Warlock** ransomware.\n*   **Primary Tactic**: Living-off-the-Land (LotL), specifically 'living-off-the-trusted-security-tool', to blend in and avoid detection.\n\n## Technical Analysis\nThe attack proceeds in several distinct phases:\n\n1.  **Initial Access**: **Storm-2603** scans for and exploits internet-facing Microsoft SharePoint servers vulnerable to the 'ToolShell' chain (**CVE-2025-49706**, **CVE-2025-49704**). Successful exploitation likely results in remote code execution on the SharePoint server ([`T1190 - Exploit Public-Facing Application`](https://attack.mitre.org/techniques/T1190/)).\n2.  **Persistence and C2**: The attackers deploy the **Velociraptor** agent on compromised systems. Velociraptor is designed to have a client-server architecture, which the attackers abuse to establish a persistent command-and-control channel. The agent on the compromised host connects back to an attacker-controlled Velociraptor server, allowing them to issue commands and run queries remotely ([`T1219 - Remote Access Software`](https://attack.mitre.org/techniques/T1219/)).\n3.  **Discovery and Lateral Movement**: Using Velociraptor's powerful query language (VQL), the attackers perform extensive reconnaissance. They can inventory systems, search for sensitive files, dump credentials, and identify high-value targets like domain controllers and backup servers. The tool's legitimate status means its activity is less likely to be flagged by EDR solutions compared to known hacking tools ([`T1047 - Windows Management Instrumentation`](https://attack.mitre.org/techniques/T1047/) and [`T1059.001 - PowerShell`](https://attack.mitre.org/techniques/T1059/001/) are often used by Velociraptor's underlying artifacts).\n4.  **Impact**: Once the attackers have mapped the network and escalated privileges, they use their access to deploy the **Warlock** ransomware across multiple systems, encrypting data and demanding a ransom ([`T1486 - Data Encrypted for Impact`](https://attack.mitre.org/techniques/T1486/)).\n\n## Impact Assessment\nThe use of a legitimate DFIR tool like Velociraptor makes this campaign particularly dangerous:\n*   **Detection Evasion**: The malware's activities can be easily mistaken for legitimate administrative or incident response work, delaying detection and allowing the attackers more dwell time to achieve their objectives.\n*   **Full Network Compromise**: Velociraptor provides deep system-level access, enabling the attackers to achieve a comprehensive compromise of the network before deploying ransomware.\n*   **Destructive Outcome**: The final payload is **Warlock** ransomware, which can cause catastrophic business disruption, data loss, and significant financial costs related to recovery and ransom payments.\n\n## Detection & Response\nDetecting the malicious use of a legitimate tool requires a focus on behavior and context:\n*   **Monitor for Unauthorized Deployments**: The presence of the `velociraptor.exe` binary or its associated configuration files on systems where it has not been intentionally deployed by the security team is a major red flag. Use EDR to hunt for this executable.\n*   **Network Traffic Analysis**: The Velociraptor agent will communicate with its C2 server. Monitor for outbound connections from endpoints to unknown or untrusted IP addresses on the ports used by Velociraptor (typically TCP/8000 for the frontend). This aligns with D3FEND's [`D3-NTA: Network Traffic Analysis`](https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis).\n*   **Behavioral Analysis**: Even if the tool is legitimate, its use by an attacker will generate anomalous activity. Look for Velociraptor being used to execute reconnaissance queries or deploy files outside of a known incident response engagement. Correlate its activity with other suspicious events.\n\n## Mitigation\n1.  **Patch SharePoint Servers**: The first line of defense is to immediately patch the SharePoint vulnerabilities (**CVE-2025-49706**, **CVE-2025-49704**). This removes the initial access vector.\n2.  **Application Allowlisting**: Implement application control policies to prevent the execution of unauthorized software. If your organization does not use Velociraptor, add its executable hash to a denylist. If you do use it, ensure your policy only allows your specific, signed version to run. This is a key application of D3FEND's [`D3-EAL: Executable Allowlisting`](https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting).\n3.  **Principle of Least Privilege**: Ensure that service accounts for applications like SharePoint have the minimum necessary privileges. This can limit an attacker's ability to move laterally after the initial compromise.\n4.  **Network Segmentation**: Segmenting the network can prevent attackers from moving from a compromised SharePoint server to more critical parts of the network, such as domain controllers.",
  "twitter_post": "Ransomware alert: Storm-2603 exploits SharePoint flaws (CVE-2025-49706) to deploy Warlock ransomware. Attackers abuse the legitimate DFIR tool 'Velociraptor' to evade detection. Patch SharePoint now! ⚠️ #Ransomware #SharePoint #LotL",
  "meta_description": "Threat actor Storm-2603 is exploiting SharePoint vulnerabilities (CVE-2025-49706, CVE-2025-49704) and abusing the Velociraptor DFIR tool to deploy Warlock ransomware.",
  "category": [
    "Ransomware",
    "Vulnerability",
    "Threat Actor"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Storm-2603",
      "type": "threat_actor"
    },
    {
      "name": "Warlock ransomware",
      "type": "malware"
    },
    {
      "name": "Velociraptor",
      "type": "product",
      "url": "https://docs.velociraptor.app/"
    },
    {
      "name": "Microsoft SharePoint",
      "type": "product",
      "url": "https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration"
    },
    {
      "name": "Microsoft",
      "type": "vendor",
      "url": "https://www.microsoft.com"
    }
  ],
  "cves": [
    {
      "id": "CVE-2025-49706"
    },
    {
      "id": "CVE-2025-49704"
    }
  ],
  "sources": [
    {
      "url": "https://research.checkpoint.com/2025/8th-december-threat-intelligence-report/",
      "title": "8th December – Threat Intelligence Report",
      "date": "2025-12-08",
      "friendly_name": "Check Point Research",
      "website": "research.checkpoint.com"
    },
    {
      "url": "https://www.mandiant.com/resources/blog/storm-2603-velociraptor-warlock-ransomware",
      "title": "Storm-2603 Leverages SharePoint Flaws and Velociraptor to Deploy Warlock Ransomware",
      "date": "2025-12-07",
      "friendly_name": "Mandiant",
      "website": "mandiant.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1219",
      "name": "Remote Access Software",
      "tactic": "Command and Control"
    },
    {
      "id": "T1562.001",
      "name": "Disable or Modify Tools",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1059.001",
      "name": "PowerShell",
      "tactic": "Execution"
    },
    {
      "id": "T1486",
      "name": "Data Encrypted for Impact",
      "tactic": "Impact"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "Patching the underlying SharePoint vulnerabilities (CVE-2025-49706, CVE-2025-49704) is the most critical step to prevent initial access.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "d3fend_techniques": [
        {
          "id": "D3-EAL",
          "name": "Executable Allowlisting",
          "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting"
        }
      ],
      "description": "Using application allowlisting to prevent the execution of unauthorized tools like Velociraptor can break the post-exploitation chain.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [
        {
          "id": "D3-SFA",
          "name": "System File Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis"
        }
      ],
      "description": "Auditing for the presence of unexpected tools and monitoring their network communications can help detect this 'living-off-the-trusted-tool' technique.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "The entry point for this entire attack chain is the exploitation of known vulnerabilities in Microsoft SharePoint. The most effective and fundamental countermeasure is to maintain a rigorous patch management program for all internet-facing applications. Prioritize patching for CVE-2025-49706 and CVE-2025-49704 on all SharePoint servers immediately. Organizations must reduce their 'time-to-patch' for critical vulnerabilities on perimeter systems to an absolute minimum. Failure to do so provides threat actors like Storm-2603 with a reliable and easy entry point into the network, rendering other defenses moot.",
      "mitre_mitigation_id": "M1051"
    },
    {
      "technique_id": "D3-EAL",
      "technique_name": "Executable Allowlisting",
      "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting",
      "recommendation": "This attack's stealth comes from abusing a legitimate tool, Velociraptor. To counter this, organizations should implement application allowlisting. If your security team does not use Velociraptor for incident response, its executable (`velociraptor.exe`) and associated hashes should be added to a denylist to prevent it from running anywhere in your environment. If your team *does* use Velociraptor, your allowlisting policy should be configured to only permit your organization's specific, digitally signed version of the tool. Any other version or unsigned copy should be blocked. This prevents attackers from bringing their own copy of the tool and having it execute with impunity. This 'zero trust' approach to executables is a powerful defense against LotL techniques.",
      "mitre_mitigation_id": "M1038"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "file_name",
      "value": "velociraptor.exe",
      "description": "The presence of the Velociraptor executable on a system where it was not intentionally deployed by the security team.",
      "context": "EDR, File Integrity Monitoring",
      "confidence": "high"
    },
    {
      "type": "network_traffic_pattern",
      "value": "Outbound traffic on TCP/8000",
      "description": "Velociraptor's default frontend port is 8000. Outbound connections on this port from servers to an unknown external IP could indicate a malicious C2.",
      "context": "Firewall logs, Netflow analysis",
      "confidence": "medium"
    },
    {
      "type": "process_name",
      "value": "w3wp.exe",
      "description": "The SharePoint worker process. Monitor this process for spawning suspicious child processes like powershell.exe or cmd.exe, which could indicate initial exploitation.",
      "context": "EDR logs, Sysmon Event ID 1",
      "confidence": "high"
    }
  ],
  "tags": [
    "Warlock",
    "Ransomware",
    "Storm-2603",
    "SharePoint",
    "Velociraptor",
    "Living-off-the-Land",
    "Vulnerability"
  ],
  "extract_datetime": "2025-12-08T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology"
    ]
  },
  "pub_date": "2025-12-08",
  "reading_time_minutes": 5,
  "createdAt": "2025-12-08T15:00:00.000Z",
  "updatedAt": "2025-12-08T15:00:00.000Z"
}