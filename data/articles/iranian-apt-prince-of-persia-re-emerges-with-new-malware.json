{
  "id": "673c34e9-3a99-476d-8e05-7254f315de9b",
  "slug": "iranian-apt-prince-of-persia-re-emerges-with-new-malware",
  "headline": "Iran's \"Prince of Persia\" APT Returns with Upgraded Malware, Uses Telegram for C2",
  "title": "Iranian APT \"Prince of Persia\" Re-emerges with New Variants of Tonnerre Backdoor Targeting Critical Infrastructure",
  "summary": "The Iranian state-sponsored threat group \"Prince of Persia\" has resurfaced with multiple active malware campaigns, according to a new report from SafeBreach. The APT group is deploying new variants of its signature \"Tonnerre\" and \"Foudre\" backdoors. In a significant tactical evolution, one new variant, Tonnerre v50, now uses Telegram for command and control (C2) communications, replacing older protocols. The campaigns, which feature multiple Domain Generation Algorithms (DGAs), appear to be targeting critical infrastructure, indicating a patient and re-tooled adversary.",
  "full_report": "## Executive Summary\nA December 2025 report from **[SafeBreach](https://www.safebreach.com/)** has detailed the resurgence of the Iranian state-sponsored advanced persistent threat (APT) group known as **\"Prince of Persia.\"** After a period of apparent dormancy, the group is now conducting multiple campaigns using new and updated versions of its signature malware families, **Foudre** and **Tonnerre**. The research reveals a significant evolution in the group's tactics, techniques, and procedures (TTPs), most notably the use of the **[Telegram](https://telegram.org/)** messaging platform for command and control (C2) communications. This, combined with the use of multiple Domain Generation Algorithms (DGAs), indicates a sophisticated and patient adversary that has re-tooled for a new wave of attacks, likely targeting critical infrastructure.\n\n---\n\n## Threat Overview\n- **Threat Actor:** **Prince of Persia** (also known as APT33, Elfin).\n- **Malware:** New variants of the **Tonnerre** and **Foudre** backdoors.\n- **Key TTPs:**\n  - Use of **Telegram** for C2, a shift from older FTP-based C2 channels.\n  - Parallel use of multiple Domain Generation Algorithms (DGAs) for C2 resiliency.\n  - Long-term re-tooling and maintaining access to victim networks.\n- **Targets:** Believed to be focused on critical infrastructure organizations globally.\n\n## Technical Analysis\nThe re-emergence of Prince of Persia showcases a clear evolution in their toolset, designed to improve stealth and operational security.\n\n### Malware Variants\nSafeBreach identified at least three active variants of the Tonnerre malware:\n- **Tonnerre v50:** This variant is the most advanced, using an as-yet-unknown DGA. Critically, its C2 server was observed redirecting the malware to a Telegram group for C2.\n- **Tonnerre v17:** Uses a multi-stage DGA process for added complexity.\n- **Tonnerre v12-16:** Continues to use the group's original CRC32-based DGA.\n\n### C2 Evolution: Telegram Abuse\nThe use of Telegram for C2 ([`T1102.001 - Dead Drop Resolver`](https://attack.mitre.org/techniques/T1102/001/)) is a significant tactical shift. By leveraging a legitimate, popular, and encrypted service, the attackers make their C2 traffic much harder to detect and block. The traffic blends in with normal user activity, and security teams cannot simply block Telegram's domains or IPs without causing collateral damage. The malware likely uses a Telegram bot and the Telegram API to receive commands and exfiltrate stolen data, a far stealthier method than the previously used FTP protocol.\n\n### DGA for Resiliency\nThe use of multiple, parallel DGAs ([`T1568.002 - DGA`](https://attack.mitre.org/techniques/T1568/002/)) demonstrates the group's focus on maintaining persistent access. If one C2 channel or DGA pattern is discovered and blocked, the malware can fall back to another, ensuring the attackers do not lose control of their compromised assets.\n\n## Impact Assessment\nThe impact of a successful compromise by Prince of Persia is **high**. As a state-sponsored APT, their goals are typically espionage, intellectual property theft, and potentially positioning for future disruptive or destructive attacks against critical infrastructure. The re-tooling and patient approach suggest a long-term strategic objective. Organizations in the energy, government, and telecommunications sectors should consider themselves at high risk.\n\n## Detection & Response\n**Detection Strategies:**\n1.  **Network Traffic Analysis (D3-NTA):** Monitor for and alert on any direct network connections to the Telegram API (`api.telegram.org`) from servers or workstations that have no business reason to use it. This is a high-fidelity indicator of this type of C2.\n2.  **DNS Query Analysis:** Analyze DNS logs for patterns indicative of DGA activity. This includes a high volume of queries to non-existent domains (NXDOMAIN responses) from a single host, or queries to domains with high entropy (random-looking characters).\n3.  **Endpoint Analysis:** Use EDR tools to hunt for the presence of the Tonnerre or Foudre malware binaries and their associated persistence mechanisms on endpoints.\n\n**Response:**\n- If Telegram C2 is detected from a server, isolate the host immediately.\n- Block the identified C2 domains and Telegram API endpoints at the firewall/proxy.\n- Begin a full investigation to determine the initial access vector and scope of the compromise.\n\n## Mitigation\n**Strategic Recommendations:**\n1.  **Restrict Web-Based Content (M1021):** For corporate environments, especially on servers, create policies to block access to non-essential web services like Telegram, Discord, and others that are commonly abused for C2. This can be done at the web proxy or firewall layer.\n2.  **Network Intrusion Prevention (M1031):** Deploy security tools that are capable of detecting and blocking DGA traffic based on algorithmic patterns, rather than just static domain lists.\n3.  **Application Control (M1042):** Use application control solutions to prevent unauthorized software, such as the Tonnerre backdoor, from executing on endpoints. This can prevent the malware from running even if it lands on a system.\n4.  **Threat Intelligence Integration:** Actively consume and integrate threat intelligence feeds containing IOCs related to Prince of Persia and other relevant APTs into your security tools (SIEM, firewall, EDR).",
  "twitter_post": "ðŸ‡®ðŸ‡· Iranian APT \"Prince of Persia\" is back. New report reveals updated 'Tonnerre' malware variants targeting critical infrastructure. In a major tactical shift, the group now uses Telegram for command and control. #APT #Iran #CyberSecurity #ThreatIntel",
  "meta_description": "The Iranian state-sponsored APT group \"Prince of Persia\" has re-emerged with new malware variants that use Telegram for command and control and multiple DGAs to target critical infrastructure.",
  "category": [
    "Threat Actor",
    "Malware",
    "Industrial Control Systems"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Prince of Persia",
      "type": "threat_actor"
    },
    {
      "name": "Foudre",
      "type": "malware"
    },
    {
      "name": "Tonnerre",
      "type": "malware"
    },
    {
      "name": "SafeBreach",
      "type": "company",
      "url": "https://www.safebreach.com/"
    },
    {
      "name": "Telegram",
      "type": "product",
      "url": "https://telegram.org/"
    },
    {
      "name": "Iran",
      "type": "other"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.scmagazine.com/news/iranian-apt-prince-of-persia-is-back-with-three-new-malware-strains",
      "title": "Iranian APT 'Prince of Persia' is back with three new malware strains",
      "date": "2025-12-28",
      "friendly_name": "SC Magazine",
      "website": "scmagazine.com"
    },
    {
      "url": "https://www.safebreach.com/resources/prince-of-persia-returns-2025-report/",
      "title": "Prince of Persia Returns: New Malware and C2 Infrastructure Uncovered",
      "date": "2025-12-28",
      "friendly_name": "SafeBreach",
      "website": "safebreach.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1102",
      "name": "Web Service",
      "tactic": "Command and Control"
    },
    {
      "id": "T1568.002",
      "name": "Domain Generation Algorithms",
      "tactic": "Command and Control"
    },
    {
      "id": "T1071.001",
      "name": "Web Protocols",
      "tactic": "Command and Control"
    },
    {
      "id": "T1571",
      "name": "Non-Standard Port",
      "tactic": "Command and Control"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1021",
      "name": "Restrict Web-Based Content",
      "d3fend_techniques": [
        {
          "id": "D3-OTF",
          "name": "Outbound Traffic Filtering",
          "url": "https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering"
        }
      ],
      "description": "Block access to services like Telegram from servers and other critical assets that have no legitimate need to connect to them.",
      "domain": "enterprise"
    },
    {
      "id": "M1037",
      "name": "Filter Network Traffic",
      "d3fend_techniques": [
        {
          "id": "D3-NI",
          "name": "Network Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:NetworkIsolation"
        }
      ],
      "description": "Implement DNS filtering and network intrusion prevention systems to detect and block traffic associated with DGAs.",
      "domain": "enterprise"
    },
    {
      "id": "M1042",
      "name": "Disable or Remove Feature or Program",
      "d3fend_techniques": [
        {
          "id": "D3-ACH",
          "name": "Application Configuration Hardening",
          "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening"
        }
      ],
      "description": "Use application control to prevent unauthorized executables like the Tonnerre backdoor from running on endpoints.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-OTF",
      "technique_name": "Outbound Traffic Filtering",
      "url": "https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering",
      "recommendation": "To counter Prince of Persia's use of Telegram for C2, organizations must implement strict outbound traffic filtering. A default-deny egress policy should be applied to all servers, especially those in critical infrastructure environments. Any required outbound communication should be explicitly allowed to known, legitimate destinations. For workstations, a web proxy should be configured to block the 'Chat' and 'Social Networking' categories, which would include Telegram. Since Telegram traffic is encrypted, blocking it at the network layer is more effective than trying to inspect its content. This prevents the Tonnerre malware from establishing its C2 channel.",
      "mitre_mitigation_id": "M1021"
    },
    {
      "technique_id": "D3-DNSDL",
      "technique_name": "DNS Denylisting",
      "url": "https://d3fend.mitre.org/technique/d3f:DNSDenylisting",
      "recommendation": "To combat the group's use of DGAs, a proactive DNS defense is required. Organizations should subscribe to high-quality threat intelligence feeds that provide lists of known DGA domains associated with Prince of Persia and other threat actors. These feeds should be integrated into a DNS firewall or sinkhole solution. This will block any endpoint from resolving the malicious C2 domains generated by the Tonnerre malware. Additionally, using DNS analytics to detect algorithmically generated domain patterns can help identify and block zero-day DGA domains before they are added to intelligence feeds.",
      "mitre_mitigation_id": "M1021"
    },
    {
      "technique_id": "D3-EAL",
      "technique_name": "Executable Allowlisting",
      "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting",
      "recommendation": "In high-security environments like critical infrastructure, application allowlisting is a powerful defense. Instead of trying to block a near-infinite list of malicious files, allowlisting only permits known, authorized executables to run. This would prevent the Tonnerre and Foudre backdoors from executing, even if an attacker manages to drop them onto a system. Implementing allowlisting on critical servers and operator workstations creates a hardened environment that is highly resilient to novel malware.",
      "mitre_mitigation_id": "M1038"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "domain",
      "value": "api.telegram.org",
      "description": "Connections from servers or corporate assets to the Telegram API endpoint are highly suspicious and a key indicator of Telegram-based C2.",
      "context": "Firewall logs, Proxy logs, NIDS",
      "confidence": "high"
    },
    {
      "type": "network_traffic_pattern",
      "value": "High NXDOMAIN Rate",
      "description": "A high rate of DNS queries resulting in NXDOMAIN (non-existent domain) responses from a single host is a classic indicator of DGA activity.",
      "context": "DNS server logs, SIEM",
      "confidence": "high"
    },
    {
      "type": "string_pattern",
      "value": "CRC32",
      "description": "The presence of CRC32 calculation logic within a binary could be an indicator of the older Tonnerre variants' DGA.",
      "context": "Static binary analysis, YARA rules",
      "confidence": "medium"
    }
  ],
  "tags": [
    "Prince of Persia",
    "APT",
    "Iran",
    "Threat Actor",
    "Malware",
    "Tonnerre",
    "Telegram",
    "DGA"
  ],
  "extract_datetime": "2025-12-28T15:00:00.000Z",
  "article_type": "Analysis",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Critical Infrastructure",
      "Energy",
      "Government",
      "Telecommunications"
    ]
  },
  "keywords": [
    "Prince of Persia APT",
    "Iranian hackers",
    "Tonnerre malware",
    "Telegram C2",
    "Domain Generation Algorithm",
    "critical infrastructure",
    "SafeBreach report",
    "APT33"
  ],
  "pub_date": "2025-12-28",
  "reading_time_minutes": 6,
  "createdAt": "2025-12-28T15:00:00.000Z",
  "updatedAt": "2025-12-28T15:00:00.000Z"
}