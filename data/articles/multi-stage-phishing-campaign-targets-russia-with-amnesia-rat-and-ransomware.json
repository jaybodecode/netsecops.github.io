{
  "id": "88c2ab18-8042-4af7-a4ab-c8b86792da9c",
  "slug": "multi-stage-phishing-campaign-targets-russia-with-amnesia-rat-and-ransomware",
  "headline": "Phishing Campaign Hits Russia with Amnesia RAT, Uses GitHub and Dropbox for Payload Delivery",
  "title": "Multi-Stage Phishing Attack on Russian Users Deploys Amnesia RAT and Ransomware, Disables Microsoft Defender",
  "summary": "A sophisticated, multi-stage phishing campaign is targeting users in Russia, delivering a combination of the Amnesia remote access trojan (RAT) and ransomware. The attack, analyzed by Fortinet FortiGuard Labs, is notable for its use of public cloud services like GitHub and Dropbox to host payloads and its use of a tool called 'defendnot' to disable Microsoft Defender antivirus. The campaign relies on social engineering and abuse of native Windows features rather than software exploits to achieve system compromise.",
  "full_report": "## Executive Summary\nSecurity researchers at **[Fortinet](https://www.fortinet.com/)** FortiGuard Labs have detailed a multi-stage phishing campaign targeting individuals in Russia. The attack uses business-themed lures to trick victims into executing malicious scripts. The campaign is characterized by its sophisticated delivery mechanism, which leverages public cloud services like **[GitHub](https://github.com/)** and **[Dropbox](https://www.dropbox.com/)** to host different stages of the attack. A key component of the attack is the use of a defense evasion tool named 'defendnot' to disable **[Microsoft Defender](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-endpoint)**. The final payloads include the **Amnesia** remote access trojan (RAT) and an unspecified strain of ransomware, enabling both espionage and financial extortion.\n\n---\n\n## Threat Overview\nThis campaign demonstrates a 'living-off-the-trusted-land' approach, where attackers abuse legitimate services to increase the likelihood of success and complicate detection and takedown efforts. By hosting payloads on reputable services like GitHub and Dropbox, the malicious traffic is more likely to bypass network security controls that might block connections to unknown or suspicious domains. The attack does not rely on zero-day exploits, but rather on deceiving the user and manipulating built-in system tools, making user awareness and endpoint hardening critical for defense.\n\n### Malware & Tools\n- **Amnesia RAT:** A remote access trojan that gives the attacker full control over the compromised system. It can be used for keylogging, file exfiltration, deploying further malware, and espionage.\n- **Ransomware (Unspecified):** Deployed as a final payload to encrypt the victim's files for financial extortion.\n- **defendnot:** A defense evasion tool specifically designed to disable Microsoft Defender by tricking the Windows Security Center into believing another AV product is installed and active.\n\n## Technical Analysis\nThe attack proceeds through a carefully orchestrated chain of events:\n\n1.  **Initial Access:** The victim receives a phishing email containing a seemingly benign business document. Opening the document triggers a malicious script. [`T1566.001 - Phishing: Spearphishing Attachment`](https://attack.mitre.org/techniques/T1566/001/)\n2.  **Staging:** The initial script connects to GitHub to download the next stage of the attack, a more complex script.\n3.  **Defense Evasion:** The script executes the 'defendnot' tool to disable Microsoft Defender. This is a critical step to ensure the final payloads are not detected or blocked. [`T1562.001 - Impair Defenses: Disable or Modify Tools`](https://attack.mitre.org/techniques/T1562/001/)\n4.  **Payload Delivery:** With defenses down, the script connects to Dropbox to download the binary payloads: the Amnesia RAT and the ransomware executable.\n5.  **Execution & Persistence:** The Amnesia RAT is executed, establishing a persistent connection to the attacker's C2 server. The ransomware may be deployed immediately or later, at the attacker's discretion. [`T1059.001 - Command and Scripting Interpreter: PowerShell`](https://attack.mitre.org/techniques/T1059/001/)\n\n## Impact Assessment\nThe dual payload of a RAT and ransomware creates a multi-faceted threat:\n*   **Data Theft:** The Amnesia RAT allows attackers to steal sensitive personal and corporate data before encrypting the system.\n*   **Espionage:** The RAT can be used for long-term surveillance, monitoring communications, and stealing intellectual property.\n*   **Financial Loss:** The ransomware encrypts files, leading to operational disruption and potential financial loss from ransom payments or recovery costs.\n*   **System Compromise:** The attacker gains full control over the victim's machine, which can be used as a pivot point for further attacks within a network.\n\n## Cyber Observables for Detection\n\n| Type | Value | Description |\n|---|---|---|\n| url_pattern | `raw.githubusercontent.com` | Monitor for PowerShell or other scripting engines making connections to download content from GitHub. |\n| url_pattern | `dropbox.com/s/` | Monitor for direct downloads of executables (`.exe`, `.dll`) from Dropbox shared links via command line tools. |\n| process_name | `msseces.exe` | The 'defendnot' tool reportedly manipulates this process (Microsoft Security Client) to disable Defender. Anomalous behavior from this process is suspicious. |\n| registry_key | `HKLM\\SOFTWARE\\Microsoft\\Security Center\\Provider\\Av` | Monitor for unauthorized changes to this registry key, which tracks the status of antivirus products. |\n\n## Detection & Response\n*   **Detection:** Monitor for PowerShell or `cscript.exe`/`wscript.exe` processes making outbound connections to GitHub and Dropbox. EDR solutions should be configured to alert on any attempts to tamper with Microsoft Defender services or registry keys. Microsoft's Tamper Protection feature, if enabled, is designed to block the actions of tools like 'defendnot'. Use **D3FEND** technique [`D3-SCA: System Call Analysis`](https://d3fend.mitre.org/technique/d3f:SystemCallAnalysis) to detect unusual API calls related to the Windows Security Center.\n*   **Response:** If a machine is suspected of being compromised, it should be immediately isolated from the network to prevent lateral movement or ransomware spread. A full forensic analysis should be performed to identify the scope of the compromise and what data may have been exfiltrated by the Amnesia RAT before any ransomware was deployed.\n\n## Mitigation\n1.  **Enable Tamper Protection:** For organizations using Microsoft Defender, enabling Tamper Protection is a critical mitigation that directly counters the 'defendnot' tool. This should be enabled and enforced via Intune or Group Policy.\n2.  **Application Control:** Use application control solutions like AppLocker or Windows Defender Application Control to restrict the execution of unauthorized scripts and binaries.\n3.  **User Training:** Since the attack relies on social engineering, continuous user training on identifying and reporting phishing emails is essential.\n4.  **Network Egress Filtering:** Block or alert on direct downloads of executable files from personal cloud storage services like Dropbox on corporate endpoints.",
  "twitter_post": "A multi-stage phishing campaign in Russia deploys Amnesia RAT & ransomware. ðŸ‡·ðŸ‡º Attackers use GitHub/Dropbox for payloads and a 'defendnot' tool to disable Microsoft Defender. Enable Tamper Protection! #Phishing #Malware #AmnesiaRAT #CyberSecurity",
  "meta_description": "A sophisticated phishing campaign targets Russian users with Amnesia RAT and ransomware, using GitHub and Dropbox for payload delivery and a tool to disable Microsoft Defender. Learn how the attack works and how to defend against it.",
  "category": [
    "Phishing",
    "Malware",
    "Ransomware"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Amnesia RAT",
      "type": "malware"
    },
    {
      "name": "defendnot",
      "type": "malware"
    },
    {
      "name": "GitHub",
      "type": "product",
      "url": "https://github.com/"
    },
    {
      "name": "Dropbox",
      "type": "company",
      "url": "https://www.dropbox.com/"
    },
    {
      "name": "Microsoft Defender",
      "type": "product",
      "url": "https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-endpoint"
    },
    {
      "name": "Fortinet",
      "type": "vendor",
      "url": "https://www.fortinet.com/"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://thehackernews.com/2026/01/multi-stage-phishing-campaign-targets.html",
      "title": "Multi-Stage Phishing Campaign Targets Russia with Amnesia RAT and Ransomware",
      "date": "2026-01-24",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    },
    {
      "url": "https://thehackernews.com/",
      "title": "The Hacker News | #1 Trusted Source for Cybersecurity News",
      "date": "2026-01-24",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1566.001",
      "name": "Phishing: Spearphishing Attachment"
    },
    {
      "id": "T1562.001",
      "name": "Impair Defenses: Disable or Modify Tools"
    },
    {
      "id": "T1059.001",
      "name": "Command and Scripting Interpreter: PowerShell"
    },
    {
      "id": "T1105",
      "name": "Ingress Tool Transfer"
    },
    {
      "id": "T1486",
      "name": "Data Encrypted for Impact"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1028",
      "name": "Operating System Configuration",
      "description": "Enable security features like Microsoft Defender's Tamper Protection to prevent unauthorized disabling of security tools.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "description": "Use application control to prevent the execution of untrusted scripts downloaded from the internet.",
      "domain": "enterprise"
    },
    {
      "id": "M1017",
      "name": "User Training",
      "description": "Train users to be suspicious of unsolicited business documents and to report phishing attempts.",
      "domain": "enterprise"
    },
    {
      "id": "M1037",
      "name": "Filter Network Traffic",
      "description": "Block or inspect downloads of executables from non-corporate cloud storage services.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-PH",
      "technique_name": "Platform Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:PlatformHardening",
      "recommendation": "The most direct countermeasure to the 'defendnot' tool is to enable Microsoft Defender's built-in Tamper Protection feature via Group Policy or Intune. This specific hardening configuration is designed to prevent unauthorized changes to security settings, including attempts to disable real-time protection or modify security intelligence updates. By enabling this, the attack chain is broken at the defense evasion stage, as the 'defendnot' tool's API calls to disable Defender would be blocked. This ensures the endpoint security solution remains active to detect and block the subsequent download and execution of the Amnesia RAT and ransomware payloads from Dropbox.",
      "mitre_mitigation_id": "M1028"
    },
    {
      "technique_id": "D3-EAL",
      "technique_name": "Executable Allowlisting",
      "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting",
      "recommendation": "Implement application allowlisting using a tool like Windows Defender Application Control (WDAC). This would prevent the execution of the unsigned and untrusted scripts and binaries downloaded from GitHub and Dropbox. In a properly configured allowlisting environment, even if a user is tricked into running the initial file, the subsequent PowerShell script fetched from GitHub would be blocked from executing because its hash or signer is not on the allowlist. This control moves the security posture from a reactive 'detect badness' model to a proactive 'only allow goodness' model, which is highly effective against multi-stage attacks that drop new executables onto a system.",
      "mitre_mitigation_id": "M1038"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "command_line_pattern",
      "value": "powershell.exe -ExecutionPolicy Bypass -File",
      "description": "Common pattern for executing downloaded PowerShell scripts while bypassing local execution policies.",
      "context": "Windows Event ID 4688, EDR logs",
      "confidence": "medium"
    },
    {
      "type": "url_pattern",
      "value": "raw.githubusercontent.com/*/*.ps1",
      "description": "Direct download of a PowerShell script from a GitHub repository, often used in initial staging.",
      "context": "Proxy logs, DNS logs, EDR network events",
      "confidence": "high"
    },
    {
      "type": "registry_key",
      "value": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender",
      "description": "Monitor for changes to the 'DisableAntiSpyware' value in this key, which can be used to disable Defender.",
      "context": "Registry monitoring tools, EDR",
      "confidence": "high"
    }
  ],
  "tags": [
    "phishing",
    "Amnesia RAT",
    "ransomware",
    "Microsoft Defender",
    "GitHub",
    "Dropbox",
    "defense evasion"
  ],
  "extract_datetime": "2026-01-25T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "national",
    "countries_affected": [
      "Russia"
    ],
    "industries_affected": [
      "Other"
    ]
  },
  "pub_date": "2026-01-25",
  "reading_time_minutes": 5,
  "createdAt": "2026-01-25T15:00:00.000Z",
  "updatedAt": "2026-01-25T15:00:00.000Z"
}