{
  "id": "ad7c7470-8e70-4480-bd86-fc6a9126cd3c",
  "slug": "public-gitlab-repos-expose-over-17000-live-secrets",
  "headline": "Massive Scan of Public GitLab Repositories Uncovers Over 17,000 Live Secrets",
  "title": "Security Researcher Finds 17,430 Verified Secrets, Including GCP Keys and GitLab Tokens, in 5.6 Million Public GitLab Repositories",
  "summary": "A security engineer, Luke Marshall, conducted a large-scale scan of all 5.6 million public repositories on GitLab Cloud, uncovering 17,430 verified, live secrets. The exposed credentials include thousands of API keys and access tokens for over 2,800 unique domains, with Google Cloud Platform (GCP) keys being the most common. The scan, performed using the open-source tool TruffleHog, highlights the pervasive issue of developers hardcoding secrets in public code. Alarmingly, 406 valid GitLab access tokens were found within GitLab's own repositories. The research also uncovered 'zombie secrets' that have remained valid for over a decade, posing a long-term risk. Marshall's responsible disclosure efforts led to multiple bug bounty payouts.",
  "full_report": "## Executive Summary\nA massive security audit of **[GitLab](https://about.gitlab.com/)** Cloud has revealed a critical and widespread developer security failure. Security engineer Luke Marshall scanned all 5.6 million public repositories on the platform, discovering **17,430 verified live secrets**. These hardcoded credentials include API keys, passwords, and access tokens for over 2,800 organizations. The scan, which cost only $770 to run on **[AWS](https://aws.amazon.com/)**, used the open-source tool **TruffleHog** to ensure high accuracy. The findings show a 35% higher density of secrets compared to a similar scan on Bitbucket, with **[Google Cloud Platform (GCP)](https://cloud.google.com/)** credentials being the most commonly leaked type. The discovery of long-lived 'zombie secrets' and credentials for GitLab itself within its own platform underscores the systemic nature of this supply chain risk.\n\n---\n\n## Threat Overview\nThe threat is simple yet severe: developers are committing sensitive credentials directly into public source code repositories. This practice provides attackers with a direct path to compromise cloud infrastructure, databases, and third-party services. Luke Marshall's research quantifies the scale of this problem on GitLab Cloud. By building an automated pipeline with `AWS Lambda` and `SQS`, he was able to scan every public repository in just over 24 hours.\n\nThe scan specifically looked for verified secrets, meaning the tool confirmed their validity, eliminating false positives. The top leaked secret types were:\n- **Google Cloud Platform (GCP):** Over 5,200 keys.\n- **MongoDB:** Numerous database connection strings.\n- **Telegram:** Bot tokens.\n- **OpenAI:** API keys.\n- **GitLab:** 406 valid GitLab access tokens.\n\nThe leakage of GitLab's own tokens demonstrates 'platform locality,' where developers accidentally expose keys for the very service they are using. Some secrets were ancient, with one valid credential dating back to 2009, highlighting the persistent danger of 'zombie secrets' in imported repository histories.\n\n---\n\n## Technical Analysis\nThis issue is a failure of secure coding and development practices, directly enabling several MITRE ATT&CK techniques for attackers who find these secrets.\n\n- **[`T1552.005 - Cloud Instance Metadata API`](https://attack.mitre.org/techniques/T1552/005/):** Leaked cloud credentials (like the 5,200 GCP keys) allow attackers to directly access cloud resources and APIs, bypassing traditional network defenses.\n- **[`T1528 - Steal Application Access Token`](https://attack.mitre.org/techniques/T1528/):** This is the essence of the problem. Attackers are not stealing the tokens via active attack, but rather harvesting them from public sources.\n- **[`T1078 - Valid Accounts`](https://attack.mitre.org/techniques/T1078/):** The leaked secrets are valid credentials for various cloud services, databases, and APIs, giving attackers legitimate access.\n- **[`T1610 - Deploy Container`](https://attack.mitre.org/techniques/T1610/):** With leaked cloud credentials, an attacker could deploy malicious containers for cryptomining or to establish a further foothold in the victim's environment.\n\n> This is a form of passive, reconnaissance-based initial access. Attackers can automate the scanning of public repositories to build a treasure trove of credentials, which they can then use to launch targeted attacks.\n\n---\n\n## Impact Assessment\nThe impact of a leaked secret can range from minor to catastrophic. A leaked API key for a development environment might have limited impact, but a production GCP service account key could lead to a full infrastructure takeover, massive data breach, and significant financial loss. The 17,430 verified secrets represent thousands of potential breaches waiting to happen.\n\nFor the 2,800+ affected organizations, the immediate impact is the cost of revoking and reissuing all exposed credentials, auditing systems for signs of compromise, and the potential for regulatory fines if a breach occurred. The long-term impact is the ongoing risk from secrets that were not successfully revoked or that may have been copied by malicious actors before they were discovered.\n\n---\n\n## Cyber Observables for Detection\nDetection of this threat is proactive (preventing secrets from being committed) and reactive (finding secrets that have been exposed).\n\n| Type | Value | Description |\n|---|---|---|\n| other | Git pre-commit hooks | Use local developer tools to scan for secret patterns before code is committed. |\n| other | CI/CD pipeline scanner | Integrate tools like TruffleHog or GitGuardian into the CI/CD pipeline to block commits containing secrets. |\n| url_pattern | `github.com`, `gitlab.com` | Monitor network logs for developers accessing public code repositories, which could be a source of accidental information leakage. |\n| log_source | CloudTrail, Azure Activity Log | Monitor for API key usage from unusual IP addresses or locations, which could indicate a compromised key is being used. |\n\n---\n\n## Detection & Response\n1.  **Automated Secret Scanning:** Organizations must implement automated secret scanning across their entire software development lifecycle. This is a form of **D3FEND's** [`File Analysis`](https://d3fend.mitre.org/technique/d3f:FileAnalysis).\n    - **Pre-commit:** Use hooks to scan code on developer machines before it's pushed.\n    - **CI/CD Pipeline:** Integrate scanning into pull/merge request checks to prevent secrets from entering the main branch.\n    - **Repository Scanning:** Continuously scan all repositories, including historical commits, for any missed secrets.\n2.  **Cloud Security Posture Management (CSPM):** Use CSPM tools to monitor for anomalous API activity. If a GCP key found on GitLab is suddenly used from an IP in a different country, it should trigger a high-priority alert. This aligns with **D3FEND's** [`User Geolocation Logon Pattern Analysis`](https://d3fend.mitre.org/technique/d3f:UserGeolocationLogonPatternAnalysis).\n\n**Response:**\n- When a secret is found, the first step is **immediate revocation**. \n- The second step is to replace the secret with a new one.\n- The third step is to audit all logs associated with the leaked secret to determine if it was used maliciously.\n\n---\n\n## Mitigation\nMitigation is focused on preventing secrets from being hardcoded in the first place.\n\n1.  **Use Secret Management Systems:** Developers should never hardcode secrets. Use tools like HashiCorp Vault, AWS Secrets Manager, or GCP Secret Manager to store and dynamically inject secrets at runtime. This aligns with **D3FEND's** [`Application Configuration Hardening`](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening).\n2.  **Developer Training:** Educate developers on the risks of hardcoding secrets and train them on how to use secret management tools properly. This is a critical part of **MITRE Mitigation** [`M1017 - User Training`](https://attack.mitre.org/mitigations/M1017/).\n3.  **Principle of Least Privilege for Tokens:** When creating API keys or access tokens, scope them with the minimum permissions necessary and set short expiration times. This reduces the impact if a token is leaked.\n4.  **Git Ignore:** Use `.gitignore` files to prevent sensitive files (like `.env` or key files) from ever being committed to the repository.",
  "twitter_post": "ðŸ¤¯ A scan of 5.6 million public GitLab repos found over 17,000 VERIFIED live secrets. GCP keys, DB credentials, and even GitLab's own tokens were exposed. A massive supply chain risk. #DevSecOps #GitLab #CyberSecurity #SecretsManagement",
  "meta_description": "A massive scan of 5.6 million public GitLab repositories has uncovered over 17,430 verified, live secrets, including API keys and cloud credentials, highlighting a major developer security issue.",
  "category": [
    "Cloud Security",
    "Security Operations",
    "Supply Chain Attack"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "GitLab",
      "type": "product",
      "url": "https://about.gitlab.com/"
    },
    {
      "name": "TruffleHog",
      "type": "product"
    },
    {
      "name": "Amazon Web Services",
      "type": "vendor",
      "url": "https://aws.amazon.com/"
    },
    {
      "name": "Google Cloud Platform",
      "type": "product",
      "url": "https://cloud.google.com/"
    },
    {
      "name": "MongoDB",
      "type": "product"
    },
    {
      "name": "Telegram",
      "type": "product"
    },
    {
      "name": "OpenAI",
      "type": "company"
    },
    {
      "name": "Luke Marshall",
      "type": "person"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.bleepingcomputer.com/news/security/public-gitlab-repositories-exposed-more-than-17-000-secrets/",
      "title": "Public GitLab repositories exposed more than 17,000 secrets",
      "date": "2025-11-28",
      "friendly_name": "BleepingComputer",
      "website": "bleepingcomputer.com"
    },
    {
      "url": "https://www.cyberinsider.org/massive-gitlab-scan-finds-17000-valid-secrets-in-public-repositories/",
      "title": "Massive GitLab scan finds 17,000+ valid secrets in public repositories",
      "date": "2025-11-27",
      "friendly_name": "Cyber Insider",
      "website": "cyberinsider.org"
    },
    {
      "url": "https://www.techradar.com/pro/security/security-researcher-uncovers-17000-secrets-in-public-gitlab-repositories",
      "title": "Security researcher uncovers 17,000 secrets in public GitLab repositories",
      "date": "2025-12-01",
      "friendly_name": "TechRadar Pro",
      "website": "techradar.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1528",
      "name": "Steal Application Access Token",
      "tactic": "Credential Access"
    },
    {
      "id": "T1078",
      "name": "Valid Accounts",
      "tactic": "Initial Access"
    },
    {
      "id": "T1552.005",
      "name": "Cloud Instance Metadata API",
      "tactic": "Credential Access"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1054",
      "name": "Software Configuration",
      "d3fend_techniques": [
        {
          "id": "D3-ACH",
          "name": "Application Configuration Hardening",
          "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening"
        }
      ],
      "description": "Preventing secrets from being hardcoded by using dedicated secret management solutions is a fundamental configuration best practice.",
      "domain": "enterprise"
    },
    {
      "id": "M1017",
      "name": "User Training",
      "description": "Training developers on secure coding practices and the dangers of hardcoding credentials is essential to changing behavior and reducing risk.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [
        {
          "id": "D3-SFA",
          "name": "System File Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis"
        }
      ],
      "description": "Continuously auditing and scanning code repositories for secrets is a critical detective control to catch what preventative measures miss.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-ACH",
      "technique_name": "Application Configuration Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening",
      "recommendation": "The root cause of the 17,000+ leaked secrets is a failure in application configuration. Organizations must enforce a strict policy against hardcoding credentials in source code. Instead, adopt a centralized secrets management solution like HashiCorp Vault, AWS Secrets Manager, or Azure Key Vault. Applications should be configured to fetch secrets dynamically at runtime or deployment time using secure APIs and IAM roles. This practice decouples secrets from the codebase, ensuring that even if the code is public, the credentials remain secure. This is the most critical strategic mitigation to prevent secret leakage at scale.",
      "mitre_mitigation_id": "M1054"
    },
    {
      "technique_id": "D3-FA",
      "technique_name": "File Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:FileAnalysis",
      "recommendation": "Implement automated secret scanning at multiple stages of the development lifecycle. First, use pre-commit hooks on developer workstations with tools like `gitleaks` or `TruffleHog` to catch secrets before they are ever committed. Second, integrate these scanners into the CI/CD pipeline as a required check for all merge requests to prevent secrets from reaching the main branch. Finally, run periodic, automated scans across all historical data in GitLab repositories to find secrets that were missed. This multi-layered analysis approach provides defense-in-depth against accidental credential exposure.",
      "mitre_mitigation_id": "M1021"
    },
    {
      "technique_id": "D3-LAM",
      "technique_name": "Local Account Monitoring",
      "url": "https://d3fend.mitre.org/technique/d3f:LocalAccountMonitoring",
      "recommendation": "For the cloud credentials discovered, organizations must implement robust monitoring on the cloud provider side. Use services like AWS CloudTrail, GCP Audit Logs, and Azure Activity Logs to monitor all API calls made with static credentials. Configure alerts in a SIEM or CSPM tool to trigger on anomalous usage patterns. For example, a GCP key that has only ever been used from a corporate IP range suddenly being used from a residential ISP or a Tor exit node is a high-confidence indicator of compromise. This detective control is crucial for identifying when a leaked secret is actively being abused by an attacker.",
      "mitre_mitigation_id": "M1026"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "command_line_pattern",
      "value": "trufflehog git file:///path/to/repo",
      "description": "Command to run the TruffleHog scanner against a local Git repository to find hardcoded secrets.",
      "context": "Developer workstations, CI/CD pipeline scripts",
      "confidence": "high"
    },
    {
      "type": "file_name",
      "value": ".env",
      "description": "Environment files often contain secrets and should never be committed to public repositories. Their presence in a public repo is a strong indicator of potential secret leakage.",
      "context": "Git repository scanning",
      "confidence": "high"
    },
    {
      "type": "log_source",
      "value": "CloudTrail/Azure Activity Logs/GCP Audit Logs",
      "description": "Monitoring cloud audit logs for API authentication events from unexpected IP ranges or user agents can indicate the use of a leaked credential.",
      "context": "Cloud Security Posture Management (CSPM), SIEM",
      "confidence": "high"
    },
    {
      "type": "string_pattern",
      "value": "AKIA[0-9A-Z]{16}",
      "description": "Regular expression for an AWS Access Key ID. Scanning code for this pattern can help identify potentially leaked AWS credentials.",
      "context": "Static Application Security Testing (SAST), secret scanning tools",
      "confidence": "high"
    }
  ],
  "tags": [
    "GitLab",
    "Secrets Management",
    "Hardcoded Secrets",
    "DevSecOps",
    "Cloud Security",
    "TruffleHog",
    "API Keys"
  ],
  "extract_datetime": "2025-11-28T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Finance",
      "Healthcare"
    ],
    "other_affected": [
      "Over 2,800 unique domains and organizations"
    ]
  },
  "pub_date": "2025-11-28",
  "reading_time_minutes": 6,
  "createdAt": "2025-11-28T15:00:00.000Z",
  "updatedAt": "2025-11-28T15:00:00.000Z"
}