{
  "id": "882bffe3-8d79-4a63-8838-7b000e984503",
  "slug": "critical-unauthenticated-rce-flaw-cvss-10-in-n8n-automation-tool",
  "headline": "Ni8mare: Critical Unauthenticated RCE Flaw (CVSS 10.0) Hits n8n Automation Platform",
  "title": "Critical RCE Vulnerability 'Ni8mare' (CVE-2026-21858) in n8n Allows Full Server Takeover Without Authentication",
  "summary": "A critical, unauthenticated remote code execution (RCE) vulnerability, codenamed 'Ni8mare' and tracked as CVE-2026-21858, has been disclosed in the popular n8n workflow automation platform. The flaw, which carries the maximum possible CVSS score of 10.0, allows a remote attacker to gain complete control over a vulnerable, self-hosted n8n instance without any credentials. Discovered by Cyera Research Labs, the vulnerability stems from a Content-Type confusion issue where a file-handling function can be improperly invoked. A successful exploit could lead to the theft of sensitive credentials stored in workflows, full server compromise, and lateral movement into connected corporate systems. All self-hosted n8n versions prior to 1.121.0 are affected, and administrators are urged to patch immediately as proof-of-concept details are now public.",
  "full_report": "## Executive Summary\nA critical unauthenticated remote code execution (RCE) vulnerability, assigned **[CVE-2026-21858](https://www.cve.org/CVERecord?id=CVE-2026-21858)** and codenamed \"Ni8mare,\" affects self-hosted instances of the **[n8n](https://n8n.io/)** workflow automation platform. The vulnerability has been rated with a CVSS score of 10.0, signifying maximum severity. It allows an attacker to execute arbitrary code on the server without any authentication, leading to a complete system compromise. The flaw, discovered by **Cyera Research Labs**, is a Content-Type confusion bug that enables an attacker to manipulate file access on the underlying server. Given that many **n8n** instances are internet-facing and used to orchestrate sensitive business processes and handle credentials, this vulnerability poses an extreme risk. The issue was patched in version 1.121.0, and administrators of all prior versions must upgrade immediately to prevent exploitation.\n\n## Vulnerability Details\nThe vulnerability exists in the way **n8n** processes certain incoming web requests, specifically those related to form submissions. According to the researchers at Cyera, a function responsible for handling form data incorrectly invokes a file-handling function without first verifying that the request's `Content-Type` header is `multipart/form-data`. This oversight creates a logical flaw where an attacker can send a specially crafted request with a different content type (e.g., `application/json`) to manipulate an object that is subsequently used in file path operations. By controlling this object, the attacker can traverse the filesystem and execute code on the server hosting the **n8n** instance. The attack vector is via the network, requires no user interaction, and has low complexity, justifying the 10.0 CVSS score.\n\n## Affected Systems\n*   **Product**: **n8n** (self-hosted instances)\n*   **Affected Versions**: All versions prior to `1.121.0`\n*   **Unaffected Versions**: `1.121.0` and later\n\n## Exploitation Status\nThe vulnerability was responsibly disclosed to the **n8n** team on November 9, 2025, and a patch was released on November 18, 2025. However, the public disclosure, including technical details and proof-of-concept (PoC) information, occurred on January 7, 2026. The availability of a PoC significantly increases the likelihood of widespread exploitation attempts against unpatched, internet-facing **n8n** instances.\n\n## Impact Assessment\nA successful exploit of **CVE-2026-21858** would be catastrophic for an affected organization. The attacker would gain full control of the **n8n** server, equivalent to `root` or `administrator` privileges for the service. This access allows them to:\n*   **Steal Sensitive Data**: Access and exfiltrate all credentials, API keys, and other secrets stored within **n8n** workflows and execution logs.\n*   **Disrupt Business Operations**: Modify, delete, or disrupt critical business and IT automation workflows.\n*   **Lateral Movement**: Use the compromised **n8n** server as a pivot point to attack other internal systems that **n8n** is connected to, such as databases, APIs, and cloud services.\n*   **Deploy Malware**: Install ransomware, cryptominers, or other malicious software on the server.\n\n## Cyber Observables for Detection\n*   **Unusual Web Requests**: Monitor web server logs for requests to **n8n** webhook endpoints that have an unexpected `Content-Type` (e.g., `application/json` instead of `multipart/form-data`) but are processed by form-handling logic.\n*   **Anomalous Process Execution**: On the **n8n** host, monitor for child processes spawned by the **n8n** service that are unusual or suspicious (e.g., `sh`, `bash`, `powershell.exe`, `curl`, `wget`).\n*   **File System Monitoring**: Look for unexpected file creation or modification in sensitive directories by the **n8n** user account.\n\n## Detection Methods\n*   **Vulnerability Scanning**: Use vulnerability scanners with updated plugins to identify unpatched **n8n** instances in your environment.\n*   **Log Analysis**: In your web application firewall (WAF) or reverse proxy logs, create rules to alert on requests to **n8n** endpoints where the `Content-Type` does not match the expected type for that endpoint's function.\n*   **D3FEND Techniques**: Employ [`D3-NTA: Network Traffic Analysis`](https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis) to look for anomalous outbound connections from the **n8n** server, which could indicate a post-exploit C2 channel or data exfiltration.\n\n## Remediation Steps\n1.  **Upgrade Immediately**: The primary and most urgent action is to upgrade all self-hosted **n8n** instances to version `1.121.0` or newer. This is a direct application of [`M1051 - Update Software`](https://attack.mitre.org/mitigations/M1051/).\n2.  **Restrict Access**: If immediate patching is not possible, restrict network access to the **n8n** instance to only trusted IP addresses. This is a temporary compensating control and not a substitute for patching.\n3.  **Web Application Firewall (WAF)**: Deploy a WAF in front of the **n8n** instance with rules designed to block malformed requests or those with mismatched content types. This maps to [`M1037 - Filter Network Traffic`](https://attack.mitre.org/mitigations/M1037/).\n4.  **Post-Patch Incident Review**: After patching, review logs for any signs of compromise prior to the update. If suspicious activity is found, assume a full breach and activate your incident response plan. Rotate all credentials and secrets stored in **n8n**.",
  "twitter_post": "ðŸš¨ CRITICAL VULNERABILITY ðŸš¨ 'Ni8mare' (CVE-2026-21858), a CVSS 10.0 unauthenticated RCE, affects n8n automation platform. Attackers can gain full server control. Patch to version 1.121.0+ immediately! #RCE #CyberSecurity #n8n #PatchNow",
  "meta_description": "A critical CVSS 10.0 unauthenticated RCE vulnerability (CVE-2026-21858) named 'Ni8mare' affects the n8n workflow automation tool, allowing full server takeover. Users must upgrade immediately.",
  "category": [
    "Vulnerability",
    "Cyberattack"
  ],
  "severity": "critical",
  "entities": [
    {
      "name": "n8n",
      "type": "product",
      "url": "https://n8n.io/"
    },
    {
      "name": "Cyera Research Labs",
      "type": "security_organization"
    }
  ],
  "cves": [
    {
      "id": "CVE-2026-21858",
      "cvss_score": 10,
      "cvss_version": "3.1",
      "kev": false,
      "severity": "critical"
    }
  ],
  "sources": [
    {
      "url": "https://www.orca.security/resources/blog/critical-unauthenticated-rce-in-n8n-cve-2026-21858-cvss-10-0-allows-full-instance-takeover/",
      "title": "Critical unauthenticated RCE in n8n (CVE-2026-21858, CVSS 10.0) allows full instance takeover",
      "date": "2026-01-07",
      "friendly_name": "Orca Security",
      "website": "orca.security"
    },
    {
      "url": "https://thehackernews.com/2026/01/critical-n8n-vulnerability-cvss-100.html",
      "title": "Critical n8n Vulnerability (CVSS 10.0) Allows Unauthenticated Attackers to Take Full Control",
      "date": "2026-01-07",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    }
  ],
  "events": [
    {
      "datetime": "2025-11-09T00:00:00Z",
      "summary": "The 'Ni8mare' vulnerability (CVE-2026-21858) was responsibly disclosed to n8n by researcher Dor Attias."
    },
    {
      "datetime": "2025-11-18T00:00:00Z",
      "summary": "n8n releases version 1.121.0, patching CVE-2026-21858."
    },
    {
      "datetime": "2026-01-07T00:00:00Z",
      "summary": "The vulnerability is publicly disclosed, along with technical details and a PoC."
    }
  ],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1068",
      "name": "Exploitation for Privilege Escalation",
      "tactic": "Privilege Escalation"
    },
    {
      "id": "T1059.004",
      "name": "Unix Shell",
      "tactic": "Execution"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "The primary mitigation is to apply the security patch provided by the vendor by upgrading to a non-vulnerable version.",
      "domain": "enterprise"
    },
    {
      "id": "M1037",
      "name": "Filter Network Traffic",
      "d3fend_techniques": [
        {
          "id": "D3-NI",
          "name": "Network Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:NetworkIsolation"
        }
      ],
      "description": "As a compensating control, restrict network access to the vulnerable application to only trusted sources, reducing the attack surface.",
      "domain": "enterprise"
    },
    {
      "id": "M1048",
      "name": "Application Isolation and Sandboxing",
      "d3fend_techniques": [
        {
          "id": "D3-SCF",
          "name": "System Call Filtering",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemCallFiltering"
        }
      ],
      "description": "Running the n8n application in a container or a sandboxed environment can limit the impact of a successful RCE, preventing the attacker from easily accessing the underlying host system.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "Given the critical CVSS 10.0 score and the unauthenticated nature of CVE-2026-21858, immediate patching is the only acceptable remediation. All administrators of self-hosted n8n instances must prioritize upgrading to version 1.121.0 or newer. This action directly removes the vulnerability from the environment. A robust patch management program should be in place to identify all n8n instances, confirm their versions, and deploy the update. Verification should be performed post-patch to ensure the upgrade was successful and the service is running a non-vulnerable version. Due to the public availability of PoC code, any delay in patching exposes the organization to a high probability of compromise.",
      "mitre_mitigation_id": "M1051"
    },
    {
      "technique_id": "D3-ITF",
      "technique_name": "Inbound Traffic Filtering",
      "url": "https://d3fend.mitre.org/technique/d3f:InboundTrafficFiltering",
      "recommendation": "For defense-in-depth and as a temporary measure if patching is delayed, deploy a Web Application Firewall (WAF) in front of all n8n instances. Configure the WAF with a specific rule to inspect inbound traffic to n8n webhook endpoints. The rule should block any request to a form-handling endpoint that does not have the expected `Content-Type` of `multipart/form-data`. This virtual patch would disrupt the specific exploit mechanism described by researchers. Additionally, restrict all access to the n8n management interface and API to a small set of trusted internal IP addresses at the network firewall level. This drastically reduces the attack surface available to external, unauthenticated attackers.",
      "mitre_mitigation_id": "M1037"
    },
    {
      "technique_id": "D3-PMA",
      "technique_name": "Process Spawn Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:ProcessSpawnAnalysis",
      "recommendation": "To detect potential exploitation of CVE-2026-21858, security teams should configure their EDR or host-based monitoring tools to scrutinize processes spawned by the n8n service (typically a `node` process). A baseline of normal child process activity should be established. Create high-severity alerts for any instance where the n8n process spawns a shell (`/bin/sh`, `bash`, `cmd.exe`, `powershell.exe`) or network utilities like `curl` or `wget`. In a normal operating state, the application should not be executing these commands. Such an event is a very strong indicator of a successful RCE exploit. The alert should trigger an automated response to isolate the host and initiate an incident response investigation.",
      "mitre_mitigation_id": "M1049"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "url_pattern",
      "value": "/webhook/",
      "description": "The vulnerability is related to how n8n handles webhooks. Monitor for unusual requests to any configured webhook URL.",
      "context": "Web server logs, WAF logs",
      "confidence": "medium"
    },
    {
      "type": "other",
      "value": "Content-Type: application/json",
      "description": "The flaw involves sending a request with a mismatched Content-Type to an endpoint expecting multipart/form-data. Alerting on this condition for specific n8n endpoints could detect exploit attempts.",
      "context": "WAF logs, Application logs",
      "confidence": "high"
    },
    {
      "type": "process_name",
      "value": "node",
      "description": "The n8n service runs as a Node.js process. Monitor for this process spawning unexpected child processes like shells (`sh`, `bash`) or network tools (`curl`, `wget`).",
      "context": "EDR, Host-based IDS, Windows Event ID 4688",
      "confidence": "high"
    },
    {
      "type": "file_path",
      "value": "/root/.n8n/n8n-storage.db",
      "description": "Default path for the n8n SQLite database containing workflows and credentials. Monitor for unauthorized access by the n8n process.",
      "context": "File Integrity Monitoring (FIM)",
      "confidence": "medium"
    }
  ],
  "tags": [
    "n8n",
    "CVE-2026-21858",
    "RCE",
    "Vulnerability",
    "CVSS 10",
    "Unauthenticated",
    "Patch Management",
    "Workflow Automation"
  ],
  "extract_datetime": "2026-01-07T15:00:00.000Z",
  "article_type": "Advisory",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Finance",
      "Healthcare",
      "Manufacturing",
      "Other"
    ],
    "other_affected": [
      "Users of the n8n workflow automation platform"
    ]
  },
  "keywords": [
    "n8n vulnerability",
    "CVE-2026-21858",
    "Ni8mare vulnerability",
    "unauthenticated RCE",
    "CVSS 10.0",
    "n8n patch",
    "Cyera Research Labs",
    "workflow automation security",
    "exploit public-facing application",
    "server takeover"
  ],
  "pub_date": "2026-01-07",
  "reading_time_minutes": 4,
  "createdAt": "2026-01-07T15:00:00.000Z",
  "updatedAt": "2026-01-07T15:00:00.000Z"
}