{
  "id": "0f1fcd73-a4f3-4a83-bd5b-4b4ea436de51",
  "slug": "massive-npm-supply-chain-attack-spreads-shai-hulud-worm",
  "headline": "Massive NPM Supply Chain Attack Spreads Self-Replicating \"Shai-Hulud\" Worm",
  "title": "Hundreds of NPM Packages Compromised by \"Shai-Hulud\" Worm in Major Supply Chain Attack, Crypto Libraries Targeted",
  "summary": "A significant, ongoing supply chain attack is targeting the NPM JavaScript ecosystem, where a self-replicating worm dubbed \"Shai-Hulud\" has infected over 400 software packages. The attack has a substantial impact on the cryptocurrency sector, compromising at least 10 widely used libraries crucial for the Ethereum Name Service (ENS), including 'content-hash' and 'address-encoder'. The malware functions as a general-purpose credential stealer, exfiltrating secrets like wallet keys from infected developer environments. The scale is vast, with researchers at Wiz observing over 25,000 affected repositories, highlighting a critical threat to developer infrastructure worldwide.",
  "full_report": "## Executive Summary\n\nA large-scale, automated supply chain attack is actively compromising the **[NPM](https://www.npmjs.com/)** JavaScript package repository. A self-replicating worm, named **[Shai-Hulud](https://malpedia.caad.fkie.fraunhofer.de/details/elf.shai_hulud)**, has infected over 400 packages, many of which are dependencies for critical cryptocurrency projects. The malware is designed to steal credentials and other secrets from compromised developer environments, posing a significant risk of financial theft and broader system compromise. The attack's rapid spread, infecting thousands of repositories, necessitates immediate investigation and remediation for any organization utilizing the NPM ecosystem.\n\n---\n\n## Threat Overview\nThe attack involves a worm that propagates by compromising NPM packages. When a developer installs an infected package, the worm activates within their environment. Its primary function is to search for and exfiltrate sensitive information, such as API keys, private keys for cryptocurrency wallets, and other developer secrets. The worm then seeks out other NPM packages maintained by the compromised developer and injects itself into them, continuing the cycle of infection. This self-replicating nature has allowed the attack to reach a massive scale. The primary targets appear to be developers and projects within the cryptocurrency space, with several key libraries for the **[Ethereum Name Service (ENS)](https://ens.domains/)** being compromised. This includes high-usage packages like `content-hash` and `address-encoder`, which are dependencies for nearly a hundred other projects, creating a cascading impact across the ecosystem.\n\n---\n\n## Technical Analysis\nThe attack leverages the trust inherent in package manager ecosystems. The initial infection vector is not detailed but likely involves developer account compromise or typosquatting.\n\n**Attack Chain:**\n1.  **Initial Compromise:** A developer downloads and uses a malicious NPM package containing the Shai-Hulud worm.\n2.  **Execution:** The malware executes on the developer's machine, likely via a `postinstall` script.\n3.  **Credential Theft:** The worm scans the local environment for credentials, API keys, and cryptocurrency wallet keys. This aligns with techniques like [`T1555 - Credentials from Password Stores`](https://attack.mitre.org/techniques/T1555/) and [`T1552.001 - Credentials In Files`](https://attack.mitre.org/techniques/T1552/001/).\n4.  **Propagation:** The worm uses the compromised developer's credentials to publish new versions of other packages they maintain, injecting its own malicious code. This constitutes a supply chain compromise via [`T1195.002 - Compromise Software Supply Chain`](https://attack.mitre.org/techniques/T1195/002/).\n5.  **Data Exfiltration:** Stolen credentials and secrets are exfiltrated to an attacker-controlled server.\n\nThe scale is significant, with Aikido Security identifying over 400 infected packages and Wiz reporting over 25,000 affected repositories. The rapid growth rate (1,000 new repos every 30 minutes) indicates a highly effective automated propagation mechanism.\n\n---\n\n## Impact Assessment\nThe business impact is severe, particularly for the cryptocurrency and Web3 sectors. The compromise of foundational ENS libraries could lead to widespread financial loss if stolen wallet keys are exploited. Beyond direct financial theft, the exfiltration of developer credentials and API keys could allow attackers to gain deeper access into corporate networks, cloud environments, and source code repositories, leading to further data breaches, intellectual property theft, and service disruption. The erosion of trust in the NPM ecosystem is another significant consequence, forcing development teams to allocate resources to costly security audits and dependency verification processes.\n\n---\n\n## Cyber Observables for Detection\n| Type | Value | Description | Context | Confidence |\n|---|---|---|---|---|\n| file_path | `node_modules/` | Suspicious or obfuscated scripts found within package directories. | File Integrity Monitoring | high |\n| command_line_pattern | `npm install` or `npm ci` | Monitor for child processes spawning from package manager commands that initiate unexpected network connections. | EDR / Process Monitoring | medium |\n| network_traffic_pattern | Outbound connections to unknown IPs/domains from build servers or developer workstations during package installation. | SIEM / Network Flow Logs | medium |\n| file_name | `package.json`, `package-lock.json` | Unexpected modifications or additions to dependency lists and scripts. | Code Repository Scanning | high |\n\n---\n\n## Detection & Response\n**Detection:**\n1.  **Dependency Scanning:** Run `npm audit` to identify known vulnerabilities in dependencies. Use third-party tools like Snyk or Dependabot to scan for malicious packages and suspicious code patterns.\n2.  **Network Monitoring:** Monitor outbound traffic from build environments and developer machines, especially during `npm install` operations. Alert on connections to new or untrusted domains.\n3.  **Behavioral Analysis:** Use an EDR solution to monitor for suspicious behavior originating from Node.js or npm processes, such as file system scanning, accessing credential stores, or unexpected network activity. Reference D3FEND technique [`D3-PA - Process Analysis`](https://d3fend.mitre.org/technique/d3f:ProcessAnalysis).\n\n**Response:**\n1.  **Isolate:** Immediately isolate affected build servers and developer machines from the network.\n2.  **Credential Rotation:** Rotate all developer credentials, API keys, and secrets found on compromised systems.\n3.  **Audit Packages:** Identify and remove all infected packages from your projects. Revert to known-good versions.\n4.  **Revoke Tokens:** Revoke any NPM access tokens associated with compromised developer accounts.\n\n---\n\n## Mitigation\n**Strategic:**\n1.  **Private Registry:** Host vetted, internal copies of third-party dependencies in a private package registry to control which packages can be used.\n2.  **Strict Governance:** Implement a formal process for vetting and approving new third-party dependencies before they are introduced into projects.\n\n**Tactical:**\n1.  **Dependency Pinning:** Use `package-lock.json` or `yarn.lock` to pin dependencies to specific, known-good versions. This prevents the automatic installation of newly published, potentially malicious versions. This is a form of [`D3-ACH - Application Configuration Hardening`](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening).\n2.  **Scoped Permissions:** Use NPM tokens with the least privilege necessary. Use read-only tokens for CI/CD environments where package publishing is not required.\n3.  **MFA for Developers:** Enforce multi-factor authentication on all developer accounts, including NPM, GitHub, and other code repository platforms.",
  "twitter_post": "ðŸš¨ BREAKING: Massive NPM supply chain attack underway! A self-replicating worm named \"Shai-Hulud\" has infected 400+ packages, targeting crypto & ENS libraries to steal developer credentials and wallet keys. ì›œ #SupplyChainAttack #NPM #ShaiHulud",
  "meta_description": "A major supply chain attack on the NPM repository involves the 'Shai-Hulud' worm, which has compromised hundreds of packages, including critical crypto libraries for ENS, to steal developer credentials.",
  "category": [
    "Supply Chain Attack",
    "Malware",
    "Cloud Security"
  ],
  "severity": "critical",
  "entities": [
    {
      "name": "Shai-Hulud",
      "type": "malware",
      "url": "https://malpedia.caad.fkie.fraunhofer.de/details/elf.shai_hulud"
    },
    {
      "name": "NPM",
      "type": "technology",
      "url": "https://www.npmjs.com/"
    },
    {
      "name": "Aikido Security",
      "type": "security_organization"
    },
    {
      "name": "Wiz",
      "type": "vendor",
      "url": "https://www.wiz.io/"
    },
    {
      "name": "Ethereum Name Service",
      "type": "product",
      "url": "https://ens.domains/"
    },
    {
      "name": "content-hash",
      "type": "product"
    },
    {
      "name": "address-encoder",
      "type": "product"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.tradingview.com/news/cointelegraph:2025-11-24:0/",
      "title": "New NPM supply-chain attack compromises major ENS and crypto libraries",
      "date": "2025-11-24",
      "friendly_name": "TradingView",
      "website": "tradingview.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1195.002",
      "name": "Compromise Software Supply Chain"
    },
    {
      "id": "T1555",
      "name": "Credentials from Password Stores",
      "tactic": "Credential Access"
    },
    {
      "id": "T1552.001",
      "name": "Credentials In Files",
      "tactic": "Credential Access"
    },
    {
      "id": "T1071.001",
      "name": "Web Protocols",
      "tactic": "Command and Control"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "description": "Use application control policies to prevent the execution of unauthorized scripts during package installation.",
      "domain": "enterprise"
    },
    {
      "id": "M1045",
      "name": "Code Signing",
      "description": "Enforce policies that require dependencies to be signed by trusted authors, although this is not universally supported in NPM.",
      "domain": "enterprise"
    },
    {
      "id": "M1054",
      "name": "Software Configuration",
      "description": "Configure package managers to use a private, vetted registry and disable arbitrary script execution.",
      "domain": "enterprise"
    },
    {
      "id": "M1032",
      "name": "Multi-factor Authentication",
      "description": "Enforce MFA on developer accounts for package registries (NPM, GitHub) to prevent account takeover and malicious publishing.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-ACH",
      "technique_name": "Application Configuration Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening",
      "recommendation": "To defend against NPM supply chain attacks like the one involving Shai-Hulud, organizations must harden their development and CI/CD environments. This involves configuring NPM clients to use a private, internal package registry (e.g., Nexus, Artifactory) as the primary source for dependencies. This private registry should only contain versions of packages that have been vetted and approved by a security team. Additionally, configure NPM to disable or restrict the execution of arbitrary `preinstall` and `postinstall` scripts by using the `--ignore-scripts` flag during installation in automated environments. For local development, use tools that can analyze these scripts before execution. This hardening breaks the attack chain by preventing the initial execution of the malicious payload and controlling the provenance of all software dependencies, directly mitigating the risk of introducing a compromised package.",
      "mitre_mitigation_id": "M1054"
    },
    {
      "technique_id": "D3-PA",
      "technique_name": "Process Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:ProcessAnalysis",
      "recommendation": "Implement robust process analysis on developer workstations and build servers to detect anomalous behavior during package management operations. Use an Endpoint Detection and Response (EDR) tool to monitor process chains originating from `npm.exe` or `node.exe`. Create detection rules that alert when these processes attempt to access sensitive files (e.g., `~/.aws/credentials`, `~/.ssh/`, cryptocurrency wallet files), spawn shell commands to enumerate system information, or initiate network connections to untrusted external endpoints. By establishing a baseline of normal `npm install` behavior, security teams can quickly identify deviations indicative of a malicious package like Shai-Hulud attempting to perform reconnaissance or exfiltrate data. This provides a critical detection layer even if the malicious package itself is unknown.",
      "mitre_mitigation_id": "M1049"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "file_path",
      "value": "node_modules/",
      "description": "Directory where malicious scripts may be hidden within compromised packages.",
      "context": "File Integrity Monitoring on build servers and developer workstations.",
      "confidence": "high"
    },
    {
      "type": "command_line_pattern",
      "value": "npm install",
      "description": "The npm install command can trigger malicious 'postinstall' scripts. Monitor for suspicious child processes.",
      "context": "EDR logs (e.g., Windows Event ID 4688, Linux auditd).",
      "confidence": "medium"
    },
    {
      "type": "network_traffic_pattern",
      "value": "*",
      "description": "Anomalous outbound network connections from Node.js or npm processes, especially to non-standard ports or known malicious IPs.",
      "context": "Firewall logs, NetFlow, SIEM.",
      "confidence": "medium"
    }
  ],
  "tags": [
    "NPM",
    "JavaScript",
    "Supply Chain Attack",
    "Shai-Hulud",
    "Worm",
    "Credential Stealing",
    "Cryptocurrency",
    "ENS"
  ],
  "extract_datetime": "2025-11-24T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Finance"
    ],
    "other_affected": [
      "Cryptocurrency developers",
      "Open-source software users"
    ]
  },
  "pub_date": "2025-11-24",
  "reading_time_minutes": 5,
  "createdAt": "2025-11-24T15:00:00.000Z",
  "updatedAt": "2025-11-24T15:00:00.000Z"
}