{
  "id": "937a792a-f0f8-47ec-abd3-b21c1774187d",
  "slug": "critical-rce-flaw-cve-2025-68613-in-n8n-automation-platform-risks-103k-servers",
  "headline": "Critical RCE Flaw in n8n Puts 103,000+ Workflow Automation Servers at Risk",
  "title": "Critical RCE Vulnerability (CVE-2025-68613) in n8n Platform Allows Full Server Compromise",
  "summary": "A critical remote code execution (RCE) vulnerability, CVE-2025-68613, with a CVSS score of 9.9, has been disclosed in the n8n workflow automation platform. The flaw affects over 103,000 publicly exposed instances. It allows an authenticated attacker with low-level privileges (the ability to create or edit workflows) to execute arbitrary commands on the underlying server by exploiting an expression injection weakness. This can lead to a full server compromise, data exfiltration, and lateral movement into connected systems. Users are urged to upgrade to patched versions (1.120.4, 1.121.1, or 1.122.0) immediately.",
  "full_report": "## Executive Summary\nA critical vulnerability, **CVE-2025-68613**, has been discovered in the popular open-source workflow automation platform **[n8n](https://n8n.io/)**. Rated 9.9 on the CVSS scale, this flaw allows for remote code execution (RCE) and affects an estimated 103,000 publicly exposed instances. The vulnerability can be exploited by any authenticated user with permissions to create or edit workflows, a common privilege level. Successful exploitation allows an attacker to execute arbitrary operating system commands, leading to a complete compromise of the host server. Given that n8n is often used as a central hub for connecting sensitive APIs and services, this vulnerability poses a severe risk of data theft and lateral movement across an organization's infrastructure. Administrators are strongly advised to update to a patched version immediately.\n\n## Vulnerability Details\nThe vulnerability is an expression injection flaw within n8n's workflow definition processing logic. The platform's sandboxing mechanism, intended to isolate workflow executions, is insufficient. A low-privileged, authenticated attacker can craft a malicious expression within a workflow that escapes this sandbox. This allows the expression to access and execute commands on the underlying operating system with the same privileges as the n8n process itself. This constitutes a classic RCE scenario, where an attacker can turn limited application access into full server control.\n\nAn attack would involve the following steps:\n1.  The attacker gains authenticated access to an n8n instance, even with minimal permissions (e.g., a basic user account).\n2.  The attacker creates or modifies a workflow, embedding a specially crafted expression in one of its nodes.\n3.  When the workflow is executed, the malicious expression is evaluated, breaking out of the sandbox and executing OS commands on the server.\n\n## Affected Systems\nThe vulnerability impacts a wide range of n8n versions:\n-   All versions from `0.211.0` up to, but not including, the patched versions.\n\nPatched versions that resolve this vulnerability are:\n-   `1.120.4`\n-   `1.121.1`\n-   `1.122.0`\n\nAny self-hosted n8n instance within the vulnerable version range is at risk, particularly the more than 103,000 instances identified as being publicly accessible on the internet.\n\n## Exploitation Status\nAs of December 26, 2025, there were no public reports of this vulnerability being actively exploited in the wild. However, due to the critical severity, the large number of exposed instances, and the relative ease of exploitation for an authenticated attacker, the potential for widespread attacks is high. Security researchers anticipate that threat actors will quickly develop and deploy exploits targeting this flaw.\n\n## Impact Assessment\nA successful exploit of **CVE-2025-68613** can have devastating consequences. Since n8n workflows often store credentials, API keys, and access tokens for various services (databases, cloud platforms, SaaS applications), an attacker compromising the n8n server can exfiltrate this sensitive data. This enables **[Credential Access (TA0006)](https://attack.mitre.org/tactics/TA0006/)** on a massive scale. With this access, the attacker can:\n-   Steal, modify, or delete data from connected systems.\n-   Manipulate business processes by altering automation logic.\n-   Use the compromised n8n server as a beachhead to pivot and move laterally within the victim's network ([`T1219 - Remote Services`](https://attack.mitre.org/techniques/T1219/)).\n-   Deploy additional malware, such as ransomware or cryptominers, on the server.\n\n## Detection & Response\n1.  **Version Scanning**: The first step is to identify all n8n instances in your environment and check their version numbers against the list of affected versions.\n2.  **Audit Workflow Permissions**: Review all user accounts and roles within n8n. Identify all users who have permissions to create or edit workflows. This list represents potential internal or compromised-account threats.\n3.  **Log Monitoring**: Monitor n8n application logs and server logs for suspicious activity. Look for the execution of unexpected processes spawned by the n8n service (e.g., `sh`, `bash`, `powershell.exe`). This is a key indicator of a successful RCE exploit. This aligns with **[D3-PCA: Process Creation Analysis](https://d3fend.mitre.org/technique/d3f:ProcessCreationAnalysis)**.\n4.  **Network Analysis**: Monitor outbound network traffic from the n8n server for connections to unusual IP addresses or ports, which could indicate a reverse shell or data exfiltration channel. This is covered by **[D3-OTF: Outbound Traffic Filtering](https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering)**.\n\n## Mitigation\n1.  **Upgrade Immediately**: The primary and most effective mitigation is to upgrade all n8n instances to a patched version (`1.120.4`, `1.121.1`, `1.122.0` or later). This directly remediates the vulnerability. This is a direct application of **[D3-SU: Software Update](https://d3fend.mitre.org/technique/d3f:SoftwareUpdate)**.\n2.  **Restrict Permissions (Temporary Mitigation)**: If patching is not immediately possible, as a temporary measure, restrict permissions for creating and editing workflows to only highly trusted, senior administrators. This reduces the attack surface but does not fix the underlying flaw. This is a form of **[D3-UAP: User Account Permissions](https://d3fend.mitre.org/technique/d3f:UserAccountPermissions)**.\n3.  **Harden the Environment**: Run the n8n process as a non-root user with minimal privileges. Containerize the application (e.g., using Docker) and apply security contexts to limit its capabilities. This will not prevent exploitation but can limit the post-exploitation impact.\n4.  **Network Isolation**: Restrict network access to the n8n instance. If it does not need to be public, place it behind a VPN. Use firewall rules to limit outbound connectivity from the n8n server to only known, required endpoints.",
  "twitter_post": "üî• CRITICAL 9.9 CVSS RCE flaw (CVE-2025-68613) in n8n automation platform! Over 103K servers at risk of full compromise from low-privilege users. Upgrade to patched versions immediately! ‚öôÔ∏è #n8n #RCE #Vulnerability #CyberSecurity",
  "meta_description": "A critical 9.9 CVSS RCE vulnerability (CVE-2025-68613) in the n8n workflow automation platform affects over 103,000 servers. Learn about the risks and how to mitigate this flaw.",
  "category": [
    "Vulnerability",
    "Cloud Security",
    "Patch Management"
  ],
  "severity": "critical",
  "entities": [
    {
      "name": "n8n",
      "type": "product",
      "url": "https://n8n.io/"
    },
    {
      "name": "SonicWall",
      "type": "vendor",
      "url": "https://www.sonicwall.com"
    }
  ],
  "cves": [
    {
      "id": "CVE-2025-68613",
      "cvss_score": 9.9,
      "cvss_version": "3.1",
      "kev": false,
      "severity": "critical"
    }
  ],
  "sources": [
    {
      "url": "https://www.esecurityplanet.com/news/cybersecurity-insider-2025-12-26/",
      "title": "n8n RCE Hits 103K",
      "date": "2025-12-26",
      "friendly_name": "eSecurity Planet",
      "website": "esecurityplanet.com"
    },
    {
      "url": "https://www.hawkeyeforensics.com/post/weekly-threat-landscape-digest-week-52",
      "title": "Weekly Threat Landscape Digest - Week 52",
      "date": "2025-12-26",
      "friendly_name": "Hawkeye Forensics",
      "website": "hawkeyeforensics.com"
    },
    {
      "url": "https://www.teamwinglobal.com/2025/12/30/civn-2025-0390-remote-code-execution-vulnerability-in-n8n-npm/",
      "title": "[CIVN-2025-0390] Remote Code Execution vulnerability in n8n (npm)",
      "date": "2025-12-26",
      "friendly_name": "Team Cymru",
      "website": "teamwinglobal.com"
    },
    {
      "url": "https://www.sonicwall.com/threat/blog/n8n-ai-workflow-automation-remote-code-execution-vulnerability-cve-2025-68613/",
      "title": "N8n AI Workflow Automation Remote Code Execution Vulnerability (CVE-2025-68613)",
      "date": "2025-12-31",
      "friendly_name": "SonicWall",
      "website": "sonicwall.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1059.004",
      "name": "Command and Scripting Interpreter: Unix Shell",
      "tactic": "Execution"
    },
    {
      "id": "T1059.001",
      "name": "Command and Scripting Interpreter: PowerShell",
      "tactic": "Execution"
    },
    {
      "id": "T1003",
      "name": "OS Credential Dumping",
      "tactic": "Credential Access"
    },
    {
      "id": "T1552.005",
      "name": "Cloud Instance Metadata API",
      "tactic": "Credential Access"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "Upgrade to a patched version of n8n to eliminate the vulnerability.",
      "domain": "enterprise"
    },
    {
      "id": "M1048",
      "name": "Application Isolation and Sandboxing",
      "d3fend_techniques": [
        {
          "id": "D3-HBPI",
          "name": "Hardware-based Process Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:Hardware-basedProcessIsolation"
        }
      ],
      "description": "Run n8n in a containerized and hardened environment to limit the impact of a potential compromise.",
      "domain": "enterprise"
    },
    {
      "id": "M1026",
      "name": "Privileged Account Management",
      "d3fend_techniques": [
        {
          "id": "D3-UAP",
          "name": "User Account Permissions",
          "url": "https://d3fend.mitre.org/technique/d3f:UserAccountPermissions"
        }
      ],
      "description": "Restrict workflow creation and editing permissions to only trusted administrators as a temporary mitigation.",
      "domain": "enterprise"
    },
    {
      "id": "M1035",
      "name": "Limit Access to Resource Over Network",
      "d3fend_techniques": [
        {
          "id": "D3-NI",
          "name": "Network Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:NetworkIsolation"
        }
      ],
      "description": "Limit network access to the n8n instance and restrict its outbound connections to only necessary endpoints.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "The definitive countermeasure for CVE-2025-68613 is to immediately upgrade all n8n instances to a patched version (1.120.4, 1.121.1, 1.122.0, or newer). Given the 9.9 CVSS score and the low-privilege authenticated attack vector, this should be treated as an emergency change. Use asset inventory systems to identify all n8n deployments, including shadow IT instances. Prioritize patching for internet-facing servers and those connected to sensitive data sources or critical applications. After patching, verify the update was successful by checking the version in the n8n UI or via the command line. This action completely removes the expression injection vulnerability, providing the most effective protection.",
      "mitre_mitigation_id": "M1051"
    },
    {
      "technique_id": "D3-UAP",
      "technique_name": "User Account Permissions",
      "url": "https://d3fend.mitre.org/technique/d3f:UserAccountPermissions",
      "recommendation": "As a temporary compensating control if patching is delayed, conduct an immediate audit of all user permissions within the n8n platform. Revoke the ability to create or edit workflows from all non-essential users. This permission should be restricted to a very small group of highly trusted administrators. This action significantly reduces the attack surface by limiting the number of accounts that could be used to inject a malicious expression. While this does not fix the underlying RCE vulnerability, it makes exploitation much more difficult by raising the bar for the attacker from compromising any user account to compromising a privileged administrator account. This should be paired with enhanced monitoring of administrator activity.",
      "mitre_mitigation_id": "M1026"
    },
    {
      "technique_id": "D3-PA",
      "technique_name": "Process Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:ProcessAnalysis",
      "recommendation": "Configure EDR and server logging to monitor for anomalous child processes spawned by the main n8n process. The n8n application should not be executing system shells like `bash`, `sh`, `cmd.exe`, or `powershell.exe`. Create high-priority alerts in your SIEM or security monitoring platform to trigger an immediate investigation if the n8n process spawns any of these interpreters. This is a high-fidelity indicator of a successful RCE exploit. The alert should trigger an automated response to isolate the host server from the network to prevent lateral movement or data exfiltration while the incident is investigated. This detection-in-depth approach provides a critical safety net to catch exploitation attempts that bypass other preventative controls.",
      "mitre_mitigation_id": "M1049"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "process_name",
      "value": "sh",
      "description": "The n8n process should not normally spawn shell processes like 'sh', 'bash', or 'powershell.exe'. Such an event is a strong indicator of RCE.",
      "context": "Windows Event ID 4688, Linux auditd logs, EDR process creation logs",
      "confidence": "high"
    },
    {
      "type": "command_line_pattern",
      "value": "n8n start --tunnel",
      "description": "While not malicious, this command indicates a publicly exposed n8n instance, which increases its risk profile significantly.",
      "context": "Process monitoring, Configuration review",
      "confidence": "medium"
    },
    {
      "type": "network_traffic_pattern",
      "value": "Outbound connections from n8n server to non-API endpoints",
      "description": "Monitor for outbound network traffic from the n8n server to destinations other than the legitimate APIs configured in its workflows. This could indicate a reverse shell or C2 communication.",
      "context": "Firewall logs, NetFlow data, VPC flow logs",
      "confidence": "medium"
    },
    {
      "type": "log_source",
      "value": "n8n application logs",
      "description": "Look for errors or warnings related to expression evaluation or sandbox violations, which could precede or indicate an exploitation attempt.",
      "context": "Application log monitoring, SIEM",
      "confidence": "low"
    }
  ],
  "tags": [
    "n8n",
    "RCE",
    "Vulnerability",
    "Workflow Automation",
    "Expression Injection",
    "CVSS 9.9"
  ],
  "extract_datetime": "2025-12-27T15:00:00.000Z",
  "article_type": "Advisory",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Other"
    ],
    "other_affected": [
      "Users of n8n workflow automation"
    ],
    "people_affected_estimate": "Users of over 103,000 exposed instances"
  },
  "keywords": [
    "CVE-2025-68613",
    "n8n vulnerability",
    "n8n RCE",
    "workflow automation security",
    "expression injection",
    "CVSS 9.9",
    "remote code execution"
  ],
  "pub_date": "2025-12-27",
  "reading_time_minutes": 4,
  "createdAt": "2025-12-27T15:00:00.000Z",
  "updatedAt": "2025-12-27T15:00:00.000Z"
}