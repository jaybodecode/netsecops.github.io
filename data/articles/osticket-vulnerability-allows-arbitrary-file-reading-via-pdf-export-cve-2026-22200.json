{
  "id": "2e05719e-17c9-4d88-b8d2-07685cedfb5e",
  "slug": "osticket-vulnerability-allows-arbitrary-file-reading-via-pdf-export-cve-2026-22200",
  "headline": "osTicket Flaw Lets Attackers Read Server Files via Malicious PDF Export",
  "title": "osTicket Vulnerability (CVE-2026-22200) Allows Arbitrary File Reading via PDF Export Feature",
  "summary": "A high-severity vulnerability, CVE-2026-22200, has been disclosed in osTicket, a popular open-source helpdesk system. The flaw allows an unauthenticated, anonymous attacker to read arbitrary files from the server by injecting a malicious PHP filter chain into a support ticket. When a privileged user exports the ticket to PDF, the vulnerability is triggered, embedding the contents of sensitive server files (like configuration files) into the generated PDF as a bitmap image. Researchers warn this flaw can be chained with other vulnerabilities for full remote code execution (RCE). Patches are available in versions 1.18.3 and 1.17.4.",
  "full_report": "## Executive Summary\nA high-severity arbitrary file read vulnerability, **CVE-2026-22200**, has been discovered in the widely-used open-source helpdesk system, **[osTicket](https://osticket.com/)**. The flaw allows an unauthenticated attacker to exfiltrate sensitive files from the underlying server. The attack is carried out by submitting a support ticket containing a malicious **[PHP](https://www.php.net/)** filter chain payload. When an agent or administrator exports this ticket using the 'Export to PDF' function, the server processes the malicious payload, causing the contents of an arbitrary file (e.g., `config.php`) to be rendered as a bitmap image within the PDF. This allows the attacker to reconstruct the file's contents. The vulnerability is particularly dangerous as it can be chained with other flaws like **CVE-2024-2961 (CNEXT)** to achieve full Remote Code Execution (RCE). Patches have been released, and administrators are urged to upgrade immediately.\n\n---\n\n## Vulnerability Details\n- **CVE ID:** **CVE-2026-22200**\n- **Description:** The vulnerability is a form of object injection that abuses the `phar://` stream wrapper and PHP filter chains within the PDF generation library used by osTicket. An attacker can craft a ticket with a payload like `phar://data:;base64,PD9waHAgZWNobyBwaHBpbmZvKCk7ID8+/...`.\n- **Attack Vector:** An anonymous user submits a ticket with the malicious payload. This requires a second step where a privileged user (agent/admin) with access to the ticket export feature triggers the vulnerability by clicking 'Export to PDF'.\n- **Result:** The content of the targeted file on the server is read and embedded into the PDF output, which can then be retrieved by the attacker if they can access the generated file or if it's sent to them.\n\n## Affected Systems\n- **osTicket:** Versions prior to 1.18.3 and 1.17.4 are affected.\n\n## Exploitation Status\nA proof-of-concept is publicly available. While active widespread exploitation has not been confirmed, the public disclosure and ease of exploitation make it a likely target for attackers. The potential to chain this with other vulnerabilities for RCE, as demonstrated by researchers with CNEXT, significantly increases the risk.\n\n## Impact Assessment\n- **Data Exfiltration:** At a minimum, an attacker can read sensitive configuration files, which often contain database credentials, API keys, and other secrets. This information can be used to escalate the attack and compromise the entire application and its data.\n- **Remote Code Execution (RCE):** When chained with a file write or deserialization vulnerability (like CNEXT), this file read capability can be used to achieve full RCE, allowing the attacker to take complete control of the server.\n- **Information Disclosure:** Attackers could read any file readable by the web server user, including system files, application source code, and other sensitive documents stored on the server.\n\n## Detection Methods\n1.  **Web Application Firewall (WAF):** Deploy WAF rules to inspect POST requests to the ticket creation endpoint for suspicious strings like `phar://`, `php://filter`, and other PHP stream wrappers.\n2.  **Log Analysis:** Monitor web server access logs for ticket submission requests containing the aforementioned malicious strings. While often base64 encoded, the presence of the `phar://` wrapper may be visible in logs.\n3.  **File Integrity Monitoring (FIM):** While this flaw is a file read, monitoring for unexpected file writes could detect follow-on RCE attempts if the vulnerability is chained.\n\n## Remediation Steps\n1.  **Upgrade osTicket:** The primary and most effective remediation is to upgrade to a patched version immediately. The fixes are included in **osTicket 1.18.3** and **1.17.4**. This is a direct application of **MITRE ATT&CK Mitigation** [`M1051 - Update Software`](https://attack.mitre.org/mitigations/M1051/).\n2.  **Disable PDF Export (Temporary):** If upgrading is not immediately possible, consider temporarily disabling the PDF export functionality or restricting access to it to a very limited set of trusted administrators while you plan the upgrade.\n3.  **Harden PHP Configuration:** Review and harden your PHP configuration to disable dangerous functions if they are not needed by your application, although this may not directly prevent this specific stream wrapper attack.",
  "twitter_post": "Vulnerability in osTicket (CVE-2026-22200) allows anonymous attackers to read server files by injecting a malicious PHP filter into a ticket and exporting it as a PDF. Patch immediately! ðŸ“„ #osTicket #Vulnerability #PHP #CyberSecurity",
  "meta_description": "A vulnerability (CVE-2026-22200) in the osTicket helpdesk system allows unauthenticated attackers to read arbitrary server files by exploiting the PDF export function with a malicious PHP filter chain.",
  "category": [
    "Vulnerability",
    "Patch Management"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "osTicket",
      "type": "product",
      "url": "https://osticket.com/"
    },
    {
      "name": "PHP",
      "type": "technology",
      "url": "https://www.php.net/"
    }
  ],
  "cves": [
    {
      "id": "CVE-2026-22200"
    },
    {
      "id": "CVE-2024-2961"
    }
  ],
  "sources": [
    {
      "url": "https://www.horizon3.ai/attack-research/disclosures/ticket-to-shell-exploiting-php-filters-and-cnext-in-osticket-cve-2026-22200/",
      "title": "Ticket to Shell: Exploiting PHP Filters and CNEXT in osTicket (CVE-2026-22200)",
      "date": "2026-01-22",
      "friendly_name": "Horizon3.ai",
      "website": "horizon3.ai"
    },
    {
      "url": "https://www.cyware.com/news/daily-threat-briefing-jan-22-2026-c2a8f8d5",
      "title": "Cyware Daily Threat Intelligence, January 22, 2026",
      "date": "2026-01-22",
      "friendly_name": "Cyware",
      "website": "cyware.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1599",
      "name": "Information-stealing",
      "tactic": "Collection"
    },
    {
      "id": "T1005",
      "name": "Data from Local System",
      "tactic": "Collection"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "Upgrade osTicket to a patched version (1.18.3 or 1.17.4) to fix the root cause of the vulnerability.",
      "domain": "enterprise"
    },
    {
      "id": "M1021",
      "name": "Restrict Web-Based Content",
      "d3fend_techniques": [],
      "description": "Use a Web Application Firewall (WAF) to filter for malicious PHP stream wrappers in incoming HTTP requests.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "The definitive countermeasure for CVE-2026-22200 is to upgrade the osTicket application to a patched version, specifically 1.18.3 or 1.17.4. This is not a vulnerability that can be reliably mitigated with configuration changes alone, as it stems from how the application's code interacts with a core PHP feature. Administrators must prioritize this update, as the vulnerability allows unauthenticated attackers to read sensitive files, including the osTicket configuration file which contains database credentials. A successful exploit of this file read is often the first step toward a full system compromise.",
      "mitre_mitigation_id": "M1051"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "command_line_pattern",
      "value": "phar://",
      "description": "The presence of the 'phar://' PHP stream wrapper in POST request bodies sent to ticket creation endpoints is a strong indicator of an attempt to exploit CVE-2026-22200.",
      "context": "Web Application Firewall (WAF) logs, web server access logs",
      "confidence": "high"
    },
    {
      "type": "command_line_pattern",
      "value": "php://filter",
      "description": "The presence of the 'php://filter' stream wrapper, often used in conjunction with other wrappers, in POST request bodies is another strong indicator of exploit attempts.",
      "context": "Web Application Firewall (WAF) logs, web server access logs",
      "confidence": "high"
    }
  ],
  "tags": [
    "osTicket",
    "Vulnerability",
    "PHP",
    "Arbitrary File Read",
    "CVE-2026-22200"
  ],
  "extract_datetime": "2026-01-22T15:00:00.000Z",
  "article_type": "Advisory",
  "impact_scope": {
    "geographic_scope": "global",
    "other_affected": [
      "Organizations using the osTicket helpdesk system"
    ]
  },
  "pub_date": "2026-01-22",
  "reading_time_minutes": 4,
  "createdAt": "2026-01-22T15:00:00.000Z",
  "updatedAt": "2026-01-22T15:00:00.000Z"
}