{
  "id": "15324bb0-143c-4e40-9e1f-c233a9b066e3",
  "slug": "malicious-rust-package-evm-units-targets-web3-developers",
  "headline": "Malicious Rust Package 'evm-units' Targets Web3 Developers",
  "title": "Malicious Rust Crate 'evm-units' Impersonates Ethereum Tool to Steal Crypto from Web3 Developers",
  "summary": "A malicious software package named 'evm-units' has been discovered and removed from Rust's official crates.io registry. The package, downloaded over 7,200 times, targeted Web3 developers by impersonating a legitimate utility for the Ethereum Virtual Machine (EVM). While appearing functional, the crate contained a stealthy, multi-stage loader designed to download and execute operating system-specific malware. The malware included code to specifically evade 360 Total Security, a popular antivirus in China, suggesting the threat actor's focus was on stealing cryptocurrency from developers, likely in the Asian market. A second package, 'uniswap-utils', was also removed for depending on the malicious crate.",
  "full_report": "## Executive Summary\nSecurity researchers have identified and removed a malicious crate named `evm-units` from the official Rust package registry, `crates.io`. This package, part of a software supply chain attack, targeted developers in the Web3 and cryptocurrency space by impersonating a legitimate Ethereum Virtual Machine (EVM) utility. Downloaded over 7,200 times, `evm-units` contained a hidden, cross-platform malware loader. The loader would detect the host operating system (Windows, macOS, or Linux) and download a corresponding second-stage payload. Notably, the malware included a specific check to avoid execution if 360 Total Security, a popular Chinese antivirus, was present, indicating a targeted campaign likely aimed at crypto-theft from developers in Asia.\n\n---\n\n## Threat Overview\nThis incident is another example of a supply chain attack targeting a popular open-source ecosystem, this time the Rust programming language. The threat actor published a seemingly useful package, `evm-units`, to trick developers into including it in their projects. The name was chosen to sound like a legitimate tool for working with Ethereum, a popular platform for Web3 development.\n\nThe attack was amplified by a second package, `uniswap-utils`, which was also published by the same author and listed `evm-units` as a dependency. This tactic increases the chances of the malicious code being pulled into a developer's project indirectly. The ultimate goal of the campaign appears to be financial gain through the theft of cryptocurrency from compromised developers.\n\n## Technical Analysis\nThe attack employed a multi-stage infection process initiated during the package's build process:\n1.  **Initial Compromise:** A developer includes `evm-units` as a dependency in their `Cargo.toml` file. This is an instance of [`T1195.001 - Compromise Software Dependencies and Development Tools`](https://attack.mitre.org/techniques/T1195/001/).\n2.  **Malicious Build Script:** The package contains a `build.rs` script, a standard Rust feature that executes code at compile time. This script contains the malicious logic.\n3.  **OS Detection and Payload Download:** The script decodes a hardcoded URL, checks the host operating system, and downloads an OS-specific script (PowerShell for Windows, shell scripts for macOS/Linux). This is a form of [`T1059 - Command and Scripting Interpreter`](https://attack.mitre.org/techniques/T1059/).\n4.  **Defense Evasion:** On Windows systems, the malware first checks for the presence of `360 Total Security`, an antivirus product from the Chinese company [**Qihoo 360**](https://www.360totalsecurity.com/). If the antivirus is detected, the payload does not execute. This is a clear defense evasion technique, mapped to [`T1497.001 - System Checks`](https://attack.mitre.org/techniques/T1497/001/).\n5.  **Execution:** If no antivirus is detected, the downloaded script is executed, leading to a second-stage infection. The nature of the final payload is likely credential or crypto-wallet stealing malware.\n\n## Impact Assessment\nThe primary risk is the theft of cryptocurrency and other sensitive credentials from Web3 developers. A compromised development machine can lead to:\n-   Theft of private keys from cryptocurrency wallets stored on the machine.\n-   Compromise of credentials for accessing smart contracts, decentralized applications (dApps), or other Web3 services.\n-   Injection of malicious code into the legitimate projects the developer is working on, propagating the supply chain attack to end-users.\n\nThe specific targeting of the Asian market, a major hub for cryptocurrency activity, suggests the attacker had a clear and focused financial motive.\n\n## IOCs\n| Type | Value | Description |\n|---|---|---|\n| `file_name` | `evm-units` | Malicious Rust crate name. |\n| `file_name` | `uniswap-utils` | Malicious Rust crate that depends on `evm-units`. |\n\n## Detection & Response\n- **Dependency Auditing:** Use tools like `cargo-audit` and `cargo-vet` to scan Rust project dependencies (`Cargo.lock`) for known malicious or unvetted crates. Immediately remove `evm-units` and `uniswap-utils` if found.\n- **Build Environment Monitoring:** Monitor network activity from the `cargo` or `rustc` build processes. Build scripts should generally not be making outbound network connections to unknown URLs. This can be detected via D3FEND's [`Network Traffic Analysis`](https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis).\n- **Endpoint Detection:** On developer workstations, EDR tools should be configured to alert on `cargo` or `rustc` processes spawning shells or executing downloaded scripts, which is highly anomalous behavior.\n\n## Mitigation\n1.  **Vet Dependencies:** Do not blindly trust packages from public registries. Before adding a dependency, inspect its author, download statistics, repository, and check for any public security advisories. Favor crates that are well-established and widely used by the community.\n2.  **Principle of Least Privilege:** Run build processes in sandboxed or containerized environments with restricted network access. Deny outbound network connections by default and only allow access to `crates.io` and other necessary, trusted domains.\n3.  **Use Security Tooling:** Integrate automated dependency scanning tools into the CI/CD pipeline to catch malicious packages before they are merged into the main codebase. This is an application of D3FEND's [`Dynamic Analysis`](https://d3fend.mitre.org/technique/d3f:DynamicAnalysis).\n4.  **Secure Developer Workstations:** Ensure developer machines are protected with reputable EDR solutions and that developers are trained on the risks of supply chain attacks.",
  "twitter_post": "ðŸ¦€ Malicious Rust crate 'evm-units' caught targeting Web3 devs! Impersonating an Ethereum tool, it installed a stealthy malware loader to steal crypto. Downloaded 7,200+ times. #RustLang #Web3 #Crypto #SupplyChain #Malware",
  "meta_description": "Malicious Rust package 'evm-units' found on crates.io impersonated an Ethereum utility to target Web3 developers with malware designed for cryptocurrency theft.",
  "category": [
    "Supply Chain Attack",
    "Malware",
    "Threat Intelligence"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "evm-units",
      "type": "malware"
    },
    {
      "name": "uniswap-utils",
      "type": "malware"
    },
    {
      "name": "Socket",
      "type": "security_organization"
    },
    {
      "name": "Qihoo 360",
      "type": "vendor"
    },
    {
      "name": "Rust",
      "type": "technology"
    },
    {
      "name": "Ethereum Virtual Machine (EVM)",
      "type": "technology"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.helpguide.com/news/malicious-rust-packages-targeted-web3-developers/",
      "title": "Malicious Rust packages targeted Web3 developers",
      "date": "2025-12-07",
      "friendly_name": "HelpGuide",
      "website": "helpguide.com"
    },
    {
      "url": "https://www.helpnetsecurity.com/2025/12/07/week-in-review-react-node-js-flaw-patched-ransomware-intrusion-exposes-espionage-foothold/",
      "title": "Week in review: React, Node.js flaw patched, ransomware intrusion exposes espionage foothold",
      "date": "2025-12-07",
      "friendly_name": "Help Net Security",
      "website": "helpnetsecurity.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1195.001",
      "name": "Compromise Software Dependencies and Development Tools",
      "tactic": "Initial Access"
    },
    {
      "id": "T1059.001",
      "name": "PowerShell",
      "tactic": "Execution"
    },
    {
      "id": "T1059.004",
      "name": "Unix Shell",
      "tactic": "Execution"
    },
    {
      "id": "T1497.001",
      "name": "System Checks",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1105",
      "name": "Ingress Tool Transfer",
      "tactic": "Command and Control"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [],
      "description": "Regularly audit software dependencies using automated tools to detect malicious or vulnerable packages.",
      "domain": "enterprise"
    },
    {
      "id": "M1048",
      "name": "Application Isolation and Sandboxing",
      "d3fend_techniques": [],
      "description": "Run build processes in isolated, network-restricted environments to prevent malicious build scripts from downloading payloads or exfiltrating data.",
      "domain": "enterprise"
    },
    {
      "id": "M1017",
      "name": "User Training",
      "d3fend_techniques": [],
      "description": "Train developers to be skeptical of new or unfamiliar open-source packages and to follow best practices for vetting dependencies.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-DA",
      "technique_name": "Dynamic Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:DynamicAnalysis",
      "recommendation": "To counter threats like the `evm-units` crate, development teams should implement dynamic analysis of dependencies within a sandboxed CI/CD pipeline. Before a dependency is approved, the build process should be executed in an isolated environment that monitors for suspicious behaviors. For this specific threat, the analysis would flag the `build.rs` script for making an unauthorized outbound network connection to download a second-stage payload. This behavioral analysis is superior to static checks, as it catches malicious activity that is obfuscated or executed at compile time. Tools that hook into `cargo` and monitor its actions can automatically block such dependencies from being introduced into the codebase.",
      "mitre_mitigation_id": "M1048"
    },
    {
      "technique_id": "D3-OTF",
      "technique_name": "Outbound Traffic Filtering",
      "url": "https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering",
      "recommendation": "Developer workstations and CI/CD build agents should be subject to strict outbound traffic filtering rules. By default, all egress traffic to the internet should be denied. An explicit allow-list should be created for necessary services like `crates.io`, `github.com`, and other vetted corporate resources. This 'deny-by-default' posture would have prevented the malicious `build.rs` script in `evm-units` from successfully connecting to its remote server to download the OS-specific malware. Logging the blocked connection attempts would also serve as a valuable alert for security teams, indicating a compromised dependency is present in the environment.",
      "mitre_mitigation_id": "M1037"
    }
  ],
  "iocs": [
    {
      "type": "file_name",
      "value": "evm-units",
      "description": "Malicious Rust crate name"
    },
    {
      "type": "file_name",
      "value": "uniswap-utils",
      "description": "Dependent malicious Rust crate name"
    }
  ],
  "cyber_observables": [
    {
      "type": "file_path",
      "value": "Cargo.toml",
      "description": "The Rust project manifest file. It should be scanned for the malicious crate names 'evm-units' or 'uniswap-utils'.",
      "context": "Source code repository scanning, dependency analysis tools",
      "confidence": "high"
    },
    {
      "type": "network_traffic_pattern",
      "value": "Outbound HTTP connections from `cargo` or `rustc` processes during compilation.",
      "description": "The malicious build.rs script downloads a second-stage payload from a remote server.",
      "context": "EDR logs, firewall logs, process monitoring",
      "confidence": "high"
    },
    {
      "type": "process_name",
      "value": "360Safe.exe",
      "description": "The malware checks for the process associated with 360 Total Security antivirus to evade detection.",
      "context": "Memory analysis, EDR telemetry on compromised host",
      "confidence": "high"
    }
  ],
  "tags": [
    "Rust",
    "crates.io",
    "Web3",
    "Cryptocurrency",
    "Supply Chain Attack",
    "Malware"
  ],
  "extract_datetime": "2025-12-07T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Finance"
    ],
    "other_affected": [
      "Web3 developers",
      "Cryptocurrency users"
    ]
  },
  "pub_date": "2025-12-07",
  "reading_time_minutes": 4,
  "createdAt": "2025-12-07T15:00:00.000Z",
  "updatedAt": "2025-12-07T15:00:00.000Z"
}