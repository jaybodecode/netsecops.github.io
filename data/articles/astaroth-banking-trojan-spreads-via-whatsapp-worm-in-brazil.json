{
  "id": "44cdcdec-ec3f-48a0-b421-175826d26484",
  "slug": "astaroth-banking-trojan-spreads-via-whatsapp-worm-in-brazil",
  "headline": "WhatsApp Worm Spreads Astaroth Banking Trojan in New Brazilian Campaign",
  "title": "Threat Actor STAC3150 Uses WhatsApp Web to Distribute Astaroth Banking Trojan to Brazilian Users",
  "summary": "A new malware campaign, tracked as STAC3150, is targeting banking users in Brazil by using WhatsApp Web as a distribution vector for the Astaroth banking trojan. The attack begins with a social engineering lure sent via WhatsApp, which persuades the victim to download a malicious ZIP archive. The archive contains a VBS or HTA file that, when executed, initiates a multi-stage infection process to deploy the Astaroth trojan. Astaroth is a well-known information stealer designed to capture banking credentials and other sensitive data. This campaign highlights the increasing use of popular messaging platforms for malware delivery.",
  "full_report": "## Executive Summary\nSecurity researchers at **[Sophos](https://www.sophos.com)** have uncovered a new malware distribution campaign in Brazil, tracked as **STAC3150**, that leverages WhatsApp Web to spread the **[Astaroth](https://malpedia.caad.fkie.fraunhofer.de/details/win.astaroth)** banking trojan. The attack uses social engineering lures sent through the popular messaging platform to trick users into downloading and executing a malicious file. Once infected, the Astaroth trojan works to steal banking credentials and other sensitive financial information from the victim's computer. This campaign demonstrates the continued adaptation of threat actors to use trusted communication channels for initial access, posing a significant risk to users who may have their guard down on platforms like WhatsApp.\n\n---\n\n## Threat Overview\n*   **Threat Actor**: **STAC3150**, a threat actor group active since at least September 2025, focusing on Brazilian targets.\n*   **Malware**: **Astaroth** (also known as Guildma), a notorious information-stealing trojan that has been active for years and is known for its focus on financial data.\n*   **Distribution Vector**: WhatsApp Web.\n*   **Target Geography**: Brazil.\n*   **Objective**: Financial theft through the harvesting of online banking credentials.\n\n## Technical Analysis\nThe attack chain employed by **STAC3150** is a classic social engineering-driven process:\n\n1.  **Initial Access**: The attack begins with a lure message sent to the target via WhatsApp. The content of the message is designed to create urgency or curiosity, compelling the user to click a link ([`T1566.002 - Spearphishing Link`](https://attack.mitre.org/techniques/T1566/002/)).\n2.  **Payload Delivery**: The link directs the user to download a malicious ZIP archive. This archive contains either a Visual Basic Script (`.vbs`) file or an HTML Application (`.hta`) file.\n3.  **Execution**: The victim is tricked into opening the VBS or HTA file from the archive. This action triggers the infection sequence ([`T1204.002 - Malicious File`](https://attack.mitre.org/techniques/T1204/002/)).\n4.  **Staging and Deployment**: The initial script is a dropper or downloader. It executes a series of commands, often using legitimate Windows utilities like `bitsadmin` or `certutil` (a 'living-off-the-land' technique) to download the main Astaroth payload from a remote server ([`T1105 - Ingress Tool Transfer`](https://attack.mitre.org/techniques/T1105/)).\n5.  **Action on Objectives**: Once active, **Astaroth** uses various techniques to steal information. It can log keystrokes, capture clipboard data, and monitor browser activity to specifically target when a user visits a banking website, stealing the credentials as they are entered ([`T1056.001 - Keylogging`](https://attack.mitre.org/techniques/T1056/001/)).\n\n## Impact Assessment\nFor victims in Brazil, the impact is direct financial loss. Astaroth is highly effective at stealing credentials for Brazilian banks. Once the credentials are stolen, the threat actors can log into the victim's account to transfer funds or commit other forms of fraud.\n\nThe use of WhatsApp as a vector is particularly concerning because users tend to have a higher level of trust in messages received on the platform, especially if they appear to come from a known contact whose account may have been compromised and used to spread the worm.\n\n## Detection & Response\n*   **Endpoint Detection**: EDR solutions can detect the execution of suspicious scripts (`.vbs`, `.hta`) and the use of living-off-the-land binaries like `bitsadmin` to download executable content.\n*   **Network Monitoring**: Monitor for network connections to known malicious domains or IPs associated with the Astaroth C2 infrastructure.\n*   **Email/Web Gateway Filtering**: While this attack uses WhatsApp, the malicious link could also be delivered via email. Ensure web filters are in place to block access to known malicious file-hosting sites.\n\n## Mitigation\n1.  **User Training and Awareness**: This is the most critical mitigation. Users must be trained to be skeptical of unsolicited messages, even on WhatsApp. They should be taught never to download and open files, especially ZIP archives or scripts, from unknown or unexpected sources. Emphasize that financial institutions will never send account information or software updates via WhatsApp.\n2.  **File Extension Visibility**: Ensure that Windows is configured to show file extensions. This helps users differentiate between a benign-looking document icon and a potentially malicious script like `document.pdf.vbs`.\n3.  **Script Blocking**: For enterprise environments, consider using application control policies (like AppLocker) to block the execution of VBScript (`wscript.exe`) and HTA files (`mshta.exe`) for most users, as they have few legitimate business uses but are frequently abused by malware.\n4.  **Antivirus/Antimalware**: Keep endpoint security software up to date. Modern AV/EDR solutions have signatures and behavioral detection rules to identify and block known trojans like Astaroth.",
  "twitter_post": "ðŸ‡§ðŸ‡· A new campaign in Brazil is spreading the Astaroth banking trojan via a WhatsApp worm. The attack (STAC3150) uses malicious ZIP files with VBS/HTA scripts to steal financial data. Be wary of suspicious links! #Malware #Phishing #WhatsApp",
  "meta_description": "A malware campaign in Brazil, tracked as STAC3150, is using a WhatsApp worm to spread the Astaroth banking trojan, tricking users into executing malicious VBS and HTA files.",
  "category": [
    "Malware",
    "Phishing",
    "Threat Actor"
  ],
  "severity": "medium",
  "entities": [
    {
      "name": "STAC3150",
      "type": "threat_actor"
    },
    {
      "name": "Astaroth",
      "type": "malware",
      "url": "https://malpedia.caad.fkie.fraunhofer.de/details/win.astaroth"
    },
    {
      "name": "WhatsApp",
      "type": "product"
    },
    {
      "name": "Sophos",
      "type": "vendor",
      "url": "https://www.sophos.com"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://thehackernews.com/2025/12/08/weekly-recap-usb-malware-react2shell-whatsapp-worms-ai-ide-bugs-more.html",
      "title": "Weekly Recap: USB Malware, React2Shell, WhatsApp Worms, AI IDE Bugs & More",
      "date": "2025-12-08",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    },
    {
      "url": "https://news.sophos.com/en-us/2025/12/07/stac3150-whatsapp-worm-delivers-astaroth-trojan/",
      "title": "STAC3150: WhatsApp Worm Delivers Astaroth Trojan to Brazilian Banking Customers",
      "date": "2025-12-07",
      "friendly_name": "Sophos News",
      "website": "news.sophos.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1566.002",
      "name": "Spearphishing Link",
      "tactic": "Initial Access"
    },
    {
      "id": "T1204.002",
      "name": "Malicious File",
      "tactic": "Execution"
    },
    {
      "id": "T1059.005",
      "name": "Visual Basic",
      "tactic": "Execution"
    },
    {
      "id": "T1105",
      "name": "Ingress Tool Transfer",
      "tactic": "Command and Control"
    },
    {
      "id": "T1056.001",
      "name": "Keylogging",
      "tactic": "Collection"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1017",
      "name": "User Training",
      "description": "The most effective defense is training users to recognize and avoid social engineering lures sent via messaging apps.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "d3fend_techniques": [
        {
          "id": "D3-EAL",
          "name": "Executable Allowlisting",
          "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting"
        }
      ],
      "description": "Using application control to block script interpreters like wscript.exe and mshta.exe can prevent the initial infection from running.",
      "domain": "enterprise"
    },
    {
      "id": "M1049",
      "name": "Antivirus/Antimalware",
      "d3fend_techniques": [
        {
          "id": "D3-FCR",
          "name": "File Content Rules",
          "url": "https://d3fend.mitre.org/technique/d3f:FileContentRules"
        }
      ],
      "description": "Up-to-date endpoint security software can detect and quarantine the Astaroth payload.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-UT",
      "technique_name": "User Training",
      "url": "https://d3fend.mitre.org/technique/d3f:UserTraining",
      "recommendation": "This attack hinges entirely on social engineering. The most effective countermeasure is to build a 'human firewall' through continuous security awareness training. Specifically for this threat, training should focus on the misuse of messaging platforms like WhatsApp. Teach users to be inherently suspicious of any unsolicited message containing a link or attachment, even if it appears to be from a known contact. Key training points should include: 1) Never click links or download files from unknown senders. 2) Verify unexpected messages from known contacts through a separate communication channel (e.g., a phone call). 3) Understand the danger of file types like ZIP, VBS, and HTA. 4) Recognize lures that create a false sense of urgency. Phishing simulations that mimic this WhatsApp-based attack vector can be highly effective in reinforcing these lessons.",
      "mitre_mitigation_id": "M1017"
    },
    {
      "technique_id": "D3-EAL",
      "technique_name": "Executable Allowlisting",
      "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting",
      "recommendation": "To technically block this attack chain, organizations should implement application control policies that restrict the use of legacy script interpreters. The Astaroth trojan is delivered via VBS or HTA files, which are executed by `wscript.exe` and `mshta.exe`, respectively. For the vast majority of corporate users, these executables serve no legitimate business purpose and are frequently abused by malware. Use a tool like Windows Defender Application Control or AppLocker to create policies that block these script hosts from running in user space. This form of execution prevention breaks the infection chain at an early stage, preventing the malicious script from ever running, even if a user is tricked into opening it. This is a powerful, proactive defense that moves beyond signature-based detection.",
      "mitre_mitigation_id": "M1038"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "file_name",
      "value": "*.zip",
      "description": "The initial payload is delivered as a ZIP archive via a link in a WhatsApp message.",
      "context": "User awareness, download folder monitoring",
      "confidence": "high"
    },
    {
      "type": "file_name",
      "value": "*.vbs",
      "description": "The ZIP archive contains a malicious Visual Basic Script file to initiate the infection.",
      "context": "File integrity monitoring, EDR process creation events (wscript.exe)",
      "confidence": "high"
    },
    {
      "type": "file_name",
      "value": "*.hta",
      "description": "Alternatively, the ZIP archive may contain a malicious HTML Application file.",
      "context": "File integrity monitoring, EDR process creation events (mshta.exe)",
      "confidence": "high"
    },
    {
      "type": "process_name",
      "value": "wscript.exe",
      "description": "Execution of a .vbs file will spawn the Windows Script Host process. Monitor for this process initiating network connections.",
      "context": "EDR logs, Sysmon Event ID 1",
      "confidence": "high"
    }
  ],
  "tags": [
    "Astaroth",
    "Banking Trojan",
    "WhatsApp",
    "Malware",
    "Phishing",
    "Brazil",
    "STAC3150"
  ],
  "extract_datetime": "2025-12-08T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "national",
    "countries_affected": [
      "Brazil"
    ],
    "industries_affected": [
      "Finance"
    ]
  },
  "pub_date": "2025-12-08",
  "reading_time_minutes": 4,
  "createdAt": "2025-12-08T15:00:00.000Z",
  "updatedAt": "2025-12-08T15:00:00.000Z"
}