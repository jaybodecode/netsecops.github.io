{
  "id": "f21772cf-7e31-48e8-983e-934a9b79b31c",
  "slug": "new-linkpro-linux-rootkit-uses-ebpf-to-hide-from-security-tools",
  "headline": "New 'LinkPro' Linux Rootkit Uses eBPF and 'Magic Packets' for Ultimate Stealth",
  "title": "Novel 'LinkPro' Linux Rootkit Discovered Using eBPF for Stealth and Remote Activation via Magic Packet",
  "summary": "Security researchers have uncovered a sophisticated new GNU/Linux rootkit named 'LinkPro' after investigating a compromised AWS environment. The malware demonstrates advanced stealth capabilities by leveraging extended Berkeley Packet Filter (eBPF) modules to hide its processes and files from security tools. Furthermore, it employs a novel activation mechanism, lying dormant until it receives a specially crafted 'magic packet' over the network. The initial intrusion vector was a vulnerable Jenkins server, from which the attackers deployed the rootkit via a malicious Docker image.",
  "full_report": "## Executive Summary\nSecurity researchers at the French firm Synacktiv have discovered a highly sophisticated and stealthy GNU/Linux rootkit named **LinkPro**. The malware was found during an investigation of a compromised **[Amazon Web Services (AWS)](https://aws.amazon.com/)** infrastructure. **LinkPro** utilizes advanced, modern techniques to evade detection. Its core features include the use of two extended Berkeley Packet Filter (**[eBPF](https://ebpf.io/)**) modules: one to hook kernel functions and hide its own presence (files, processes, network connections), and another to act as a network sniffer that activates the rootkit only upon receiving a specific \"magic packet.\" This allows the malware to remain completely dormant and invisible on a compromised system until the attacker chooses to activate it. The initial compromise was achieved by exploiting **[CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)** in a public-facing **[Jenkins](https://www.jenkins.io/)** server, followed by the deployment of a malicious Docker image.\n\n---\n\n## Threat Overview\nThe discovery of **LinkPro** highlights a growing trend of malware authors adopting eBPF to create powerful and evasive rootkits. eBPF allows programs to run in a sandboxed environment within the Linux kernel, making it a powerful tool for both performance monitoring and, in this case, malicious activity.\n\n**Attack Chain:**\n1.  **Initial Access:** The attackers exploited **[CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)**, a known vulnerability in a **Jenkins** server, to gain an initial foothold in the target's AWS environment.\n2.  **Deployment:** The attackers deployed a malicious Docker Hub image named `kvlnt/vv` onto the victim's Kubernetes clusters. This image, based on Kali Linux, contained the **LinkPro** rootkit components.\n3.  **Execution & Persistence:** The rootkit is installed and executed. It then loads its eBPF modules into the kernel.\n4.  **Stealth:** One eBPF module hooks various kernel functions (kprobes) to filter out any information related to the rootkit's files, processes, or network activity from being returned by system utilities like `ls`, `ps`, and `netstat`.\n5.  **Dormant C2:** The second eBPF module attaches to a raw network socket (XDP - eXpress Data Path) to inspect all incoming network packets at a very low level. It lies dormant, waiting for a TCP packet with specific characteristics (the \"magic packet\").\n6.  **Activation:** When the magic packet is received, the rootkit activates, likely establishing a reverse shell or other command-and-control channel to the attacker.\n\n---\n\n## Technical Analysis\n**LinkPro** represents a significant step up in Linux rootkit sophistication.\n\n### MITRE ATT&CK Techniques:\n- **Initial Access:** [`T1190 - Exploit Public-Facing Application`](https://attack.mitre.org/techniques/T1190/) (exploiting the Jenkins vulnerability).\n- **Execution:** [`T1059.004 - Command and Scripting Interpreter: Unix Shell`](https://attack.mitre.org/techniques/T1059/004/).\n- **Defense Evasion:**\n  - [`T1070.004 - Indicator Removal: File Deletion`](https://attack.mitre.org/techniques/T1070/004/).\n  - [`T1562.001 - Impair Defenses: Disable or Modify Tools`](https://attack.mitre.org/techniques/T1562/001/).\n  - [`T1222.002 - File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification`](https://attack.mitre.org/techniques/T1222/002/).\n  - [`T1574.006 - Hijack Execution Flow: Dynamic Linker Hijacking`](https://attack.mitre.org/techniques/T1574/006/) (a traditional rootkit technique, though eBPF is a more modern approach).\n  - **(New/Emerging) T1613 - eBPF-based Rootkit:** This is a conceptual mapping for this specific technique.\n- **Command and Control:** [`T1090.002 - Proxy: External Proxy`](https://attack.mitre.org/techniques/T1090/002/). The magic packet triggers a C2 connection.\n- **Persistence:** The rootkit itself, once installed, acts as a persistent backdoor.\n\n### eBPF for Malice:\nThe use of eBPF is what makes **LinkPro** so dangerous:\n- **Kernel-Level Operation:** eBPF programs run within the kernel, giving them a high level of privilege and the ability to intercept and manipulate system calls.\n- **Hiding:** By hooking functions related to file and process listing, the rootkit can effectively become invisible to standard administrative tools and some security software operating in user space.\n- **Stealthy C2 Trigger:** Using an eBPF program to sniff for a magic packet is far stealthier than maintaining a constant C2 connection or listening on an open port, both of which are easily detectable via network scanning.\n\n---\n\n## Impact Assessment\nA successful **LinkPro** infection gives an attacker a persistent, stealthy, and powerful foothold within a compromised Linux environment.\n- **Complete System Control:** Once activated, the attacker can execute any command as root, allowing them to steal data, deploy other malware (like cryptominers or ransomware), or use the compromised system as a pivot point to attack other parts of the network.\n- **Detection Difficulty:** The advanced stealth capabilities mean that the rootkit could remain undetected for long periods, allowing attackers to conduct long-term espionage.\n- **Cloud Environment Risk:** The deployment via a malicious Docker image in a Kubernetes cluster highlights the risk to modern cloud-native environments, where a single compromised container can lead to a widespread breach.\n\n---\n\n## Detection & Response\nDetecting eBPF-based rootkits is challenging and requires specialized tools.\n\n1.  **eBPF Monitoring:** Use tools specifically designed to monitor eBPF activity on a system. Tools like `bpftool` can be used to list loaded eBPF programs and the kernel functions they are attached to. Look for unknown or suspicious eBPF programs.\n2.  **Kernel Integrity Monitoring:** Use kernel runtime security tools that can detect hooking of kernel functions or other forms of tampering at the kernel level.\n3.  **Network Analysis:** While the magic packet is designed to be stealthy, deep packet inspection might be able to identify network traffic that doesn't conform to expected patterns, although this is very difficult.\n4.  **IOC Sweeping:** Scan for the file-based indicators of the **LinkPro** rootkit if they are known.\n\n---\n\n## Mitigation\n1.  **Patch Management:** The initial access vector was a known vulnerability. Promptly patching internet-facing services like Jenkins is the most effective way to prevent this attack chain from starting. This is an application of **[D3FEND Software Update (D3-SU)](https://d3fend.mitre.org/technique/d3f:SoftwareUpdate)**.\n2.  **Container Security:** Implement container security best practices. Do not run containers as root. Use trusted, minimal base images. Scan Docker images for vulnerabilities and malware before deployment.\n3.  **Restrict eBPF:** On systems where it is not needed, consider disabling the ability to load new eBPF programs by setting the `kernel.unprivileged_bpf_disabled` sysctl parameter. This is a strong hardening measure but may break legitimate monitoring tools.\n4.  **Least Privilege:** Ensure that services like Jenkins run with the minimum necessary privileges and are isolated from the rest of the environment.",
  "twitter_post": "New 'LinkPro' Linux rootkit found using eBPF to hide from security tools. üêß It stays dormant until activated by a 'magic packet' sent over the network. The malware was deployed via a malicious Docker image on AWS. #Linux #Malware #Rootkit #eBPF",
  "meta_description": "Researchers have discovered 'LinkPro,' a new GNU/Linux rootkit that uses eBPF modules for stealth and is activated remotely by a 'magic packet,' posing a significant threat to cloud environments.",
  "category": [
    "Malware",
    "Cloud Security"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "LinkPro",
      "type": "malware"
    },
    {
      "name": "Synacktiv",
      "type": "security_organization"
    },
    {
      "name": "eBPF",
      "type": "technology",
      "url": "https://ebpf.io/"
    },
    {
      "name": "Amazon Web Services (AWS)",
      "type": "vendor",
      "url": "https://aws.amazon.com/"
    },
    {
      "name": "Jenkins",
      "type": "product",
      "url": "https://www.jenkins.io/"
    },
    {
      "name": "Docker",
      "type": "technology"
    },
    {
      "name": "Kubernetes",
      "type": "technology"
    },
    {
      "name": "GNU/Linux",
      "type": "technology"
    }
  ],
  "cves": [
    {
      "id": "CVE-2024-23897"
    }
  ],
  "sources": [
    {
      "url": "https://thehackernews.com/",
      "title": "LinkPro Linux Rootkit Uses eBPF to Hide and Activates via Magic TCP Packets",
      "date": "2025-10-16",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1210",
      "name": "Exploitation of Remote Services",
      "tactic": "Lateral Movement"
    },
    {
      "id": "T1070.004",
      "name": "File Deletion",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1222.002",
      "name": "Linux and Mac File and Directory Permissions Modification",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1090.002",
      "name": "External Proxy",
      "tactic": "Command and Control"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "Promptly patching the vulnerable Jenkins server would have prevented the initial access for this attack.",
      "domain": "enterprise"
    },
    {
      "id": "M1048",
      "name": "Application Isolation and Sandboxing",
      "d3fend_techniques": [
        {
          "id": "D3-HBPI",
          "name": "Hardware-based Process Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:Hardware-basedProcessIsolation"
        }
      ],
      "description": "Running web services like Jenkins in isolated containers with minimal privileges can limit the impact of a compromise.",
      "domain": "enterprise"
    },
    {
      "id": "M1028",
      "name": "Operating System Configuration",
      "d3fend_techniques": [
        {
          "id": "D3-PH",
          "name": "Platform Hardening",
          "url": "https://d3fend.mitre.org/technique/d3f:PlatformHardening"
        }
      ],
      "description": "Hardening the Linux kernel by disabling unprivileged eBPF can prevent this class of rootkit from being loaded.",
      "domain": "enterprise"
    },
    {
      "id": "M1049",
      "name": "Antivirus/Antimalware",
      "d3fend_techniques": [
        {
          "id": "D3-PA",
          "name": "Process Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:ProcessAnalysis"
        }
      ],
      "description": "Specialized Linux security tools that can monitor kernel activity and eBPF usage are required to detect this type of threat.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-PH",
      "technique_name": "Platform Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:PlatformHardening",
      "recommendation": "To proactively defend against eBPF-based rootkits like LinkPro, harden the Linux kernel on your servers. The most effective step is to disable the use of unprivileged eBPF by setting the sysctl parameter `kernel.unprivileged_bpf_disabled` to 1. This prevents non-root users from loading eBPF programs, which is a common vector. For systems requiring eBPF for legitimate monitoring (e.g., observability tools), this may not be feasible. In such cases, use a security module like AppArmor or SELinux to create strict policies that define which specific applications are allowed to use the `bpf()` system call. This prevents unauthorized processes, like a webshell spawned from a compromised Jenkins server, from loading malicious eBPF programs.",
      "mitre_mitigation_id": "M1028"
    },
    {
      "technique_id": "D3-KMA",
      "technique_name": "Kernel Module Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:KernelModuleAnalysis",
      "recommendation": "For detection, deploy a runtime security tool that is eBPF-aware. Solutions like Falco, Tracee, or commercial Cloud Workload Protection Platforms (CWPP) can monitor kernel activity and detect the loading of suspicious eBPF programs. Configure these tools to alert on any new eBPF program being loaded onto a production server. You can use the `bpftool` utility to periodically dump the list of loaded eBPF programs and compare it against a known-good baseline. An alert on a new, unapproved eBPF program, especially one attached to sensitive kernel functions (kprobes) or raw network sockets (XDP), is a strong indicator of a rootkit like LinkPro and should be investigated immediately.",
      "mitre_mitigation_id": "M1049"
    },
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "While detecting the rootkit is complex, preventing the initial intrusion is straightforward. The entire attack chain began with the exploitation of a known vulnerability, CVE-2024-23897, in a public-facing Jenkins server. Organizations must have a rigorous patch management program for all internet-exposed services. Use vulnerability scanners to continuously assess your external attack surface and identify missing patches. For a critical service like Jenkins, patches for remote code execution vulnerabilities should be applied within days, not weeks. This preventative measure is the most cost-effective way to defend against this threat, as it blocks the attacker at the very first step.",
      "mitre_mitigation_id": "M1051"
    }
  ],
  "iocs": [
    {
      "type": "other",
      "value": "kvlnt/vv",
      "description": "Name of the malicious Docker Hub image used to deploy the LinkPro rootkit."
    }
  ],
  "cyber_observables": [
    {
      "type": "command_line_pattern",
      "value": "bpftool prog list",
      "description": "Command to list all eBPF programs loaded on a Linux system. System administrators can use this to look for suspicious or unknown programs attached to the kernel.",
      "context": "Live response on a Linux host, system auditing scripts",
      "confidence": "high"
    },
    {
      "type": "command_line_pattern",
      "value": "bpftool prog show name <prog_name>",
      "description": "Command to inspect a specific loaded eBPF program. Can reveal what kernel functions (kprobes) a suspicious program is hooked into.",
      "context": "Live response on a Linux host",
      "confidence": "high"
    },
    {
      "type": "other",
      "value": "kernel.unprivileged_bpf_disabled=1",
      "description": "A sysctl setting that can be used to disable unprivileged eBPF, a key hardening measure against some eBPF-based threats.",
      "context": "System configuration hardening",
      "confidence": "high"
    }
  ],
  "tags": [
    "LinkPro",
    "Linux",
    "Rootkit",
    "eBPF",
    "Malware",
    "Cloud Security",
    "AWS",
    "Jenkins",
    "Docker"
  ],
  "extract_datetime": "2025-10-16T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Other"
    ],
    "other_affected": [
      "Users of cloud services like AWS"
    ]
  },
  "pub_date": "2025-10-16",
  "reading_time_minutes": 6,
  "createdAt": "2025-10-16T15:00:00.000Z",
  "updatedAt": "2025-10-16T15:00:00.000Z"
}