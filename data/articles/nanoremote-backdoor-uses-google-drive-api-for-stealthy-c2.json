{
  "id": "6b4479cd-f01b-45d5-905b-75c8228611d2",
  "slug": "nanoremote-backdoor-uses-google-drive-api-for-stealthy-c2",
  "headline": "Stealthy NANOREMOTE Backdoor Abuses Google Drive API for C2 Communications",
  "title": "New Windows Backdoor 'NANOREMOTE' Leverages Google Drive API for Covert Command and Control",
  "summary": "A new and fully-featured Windows backdoor, dubbed NANOREMOTE, has been discovered by Elastic Security Labs. Written in C++, the malware distinguishes itself by using the Google Drive API for all command-and-control (C2) communications, allowing it to blend in with legitimate cloud traffic and evade traditional network security. The malware, which shares characteristics with the FINALDRAFT implant, is capable of reconnaissance, file transfer, and command execution. This tactic poses a significant challenge for organizations, especially those using Google Workspace, as it makes detecting malicious activity within sanctioned cloud services difficult.",
  "full_report": "## Executive Summary\nSecurity researchers at **[Elastic Security Labs](https://www.elastic.co/security-labs/)** have uncovered a sophisticated new Windows backdoor named **NANOREMOTE**. This C++ based malware employs a stealthy command-and-control (C2) technique, leveraging the legitimate **[Google Drive](https://www.google.com/drive/)** API to receive commands and exfiltrate data. This method allows the malware's traffic to be camouflaged within normal, encrypted cloud service activity, making it exceptionally difficult to detect with traditional network-based intrusion detection systems. **NANOREMOTE** exhibits functional similarities to the **FINALDRAFT** implant and appears to be part of an evolving toolset used by threat actors. Its capabilities include reconnaissance, remote command execution, and a robust file transfer management system, posing a significant threat to enterprises that rely on cloud services.\n\n---\n\n## Threat Overview\n**NANOREMOTE** represents a growing trend of malware abusing legitimate online services (also known as Living Off the Trusted Site - LOTS) for C2 operations. By using the Google Drive API, the threat actor can:\n*   **Evade Detection:** C2 traffic is encrypted via HTTPS and directed towards a legitimate, highly trusted domain (`google.com`), bypassing reputation-based blocklists and making it hard to distinguish from benign user activity.\n*   **Stage Payloads:** Attacker-controlled Google Drive folders can be used to store secondary payloads or scripts for the malware to download and execute.\n*   **Exfiltrate Data:** Stolen data can be uploaded to Google Drive, appearing as normal file synchronization activity.\n\nElastic Security Labs discovered a sample of **NANOREMOTE** uploaded to VirusTotal from the Philippines on October 3, 2025. This sample was found in a file named `wmsetup.log`, a filename also associated with the **PATHLOADER** malware, which has been used to deploy **FINALDRAFT**. This connection suggests that the actors behind **NANOREMOTE** may be the same as or collaborating with those using the **FINALDRAFT** toolset.\n\n---\n\n## Technical Analysis\n**NANOREMOTE** is a modular backdoor with a comprehensive feature set designed for stealth and control.\n\n### Malware Capabilities\n*   **C2 Communication:** All C2 functions are routed through the Google Drive API. The malware likely uses OAuth tokens, possibly stolen from the user's machine or embedded within the malware, to authenticate to the service.\n*   **Task Management:** It includes a sophisticated system for managing tasks, allowing operators to queue, pause, resume, and cancel file uploads and downloads. This suggests an intent to exfiltrate large volumes of data.\n*   **Reconnaissance:** The malware can gather information about the compromised system and its network environment.\n*   **Remote Execution:** It can execute arbitrary commands and files delivered via the Google Drive C2 channel.\n\n### MITRE ATT&CK TTPs\n*   **Command and Control:**\n    *   [`T1071.001 - Application Layer Protocol: Web Protocols`](https://attack.mitre.org/techniques/T1071/001/): The underlying communication uses HTTPS.\n    *   [`T1102.002 - Web Service: Bidirectional Communication`](https://attack.mitre.org/techniques/T1102/002/): The core TTP. The malware uses Google Drive as a C2 channel, abusing a legitimate web service.\n*   **Exfiltration:**\n    *   [`T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage`](https://attack.mitre.org/techniques/T1567/002/): Stolen data is uploaded to the attacker's Google Drive account.\n*   **Execution:**\n    *   [`T1059 - Command and Scripting Interpreter`](https://attack.mitre.org/techniques/T1059/): The backdoor is capable of executing received commands and scripts.\n*   **Defense Evasion:**\n    *   [`T1027 - Obfuscated Files or Information`](https://attack.mitre.org/techniques/T1027/): The malware is likely packed or obfuscated to avoid static analysis.\n\n---\n\n## Impact Assessment\nThe use of legitimate cloud services for C2 poses a major challenge for security teams. For businesses, especially the millions that use Google Workspace, this tactic blurs the line between malicious and legitimate network traffic. A successful **NANOREMOTE** infection could lead to long-term, undetected data exfiltration, corporate espionage, and the deployment of further malware like ransomware. The difficulty in detection means the malware could dwell in a network for an extended period, giving attackers ample time to achieve their objectives.\n\n---\n\n## Detection & Response\nDetecting malware like **NANOREMOTE** requires shifting focus from traditional network signatures to behavioral analysis and API monitoring.\n\n**Detection Strategies:**\n1.  **Cloud API Auditing ([D3-CMA](https://d3fend.mitre.org/technique/d3f:CloudApiMonitoring)):** For organizations using Google Workspace, enable and ingest Google Cloud audit logs into your SIEM. Monitor for anomalous API activity, such as a user account accessing Google Drive from a new or unusual process, or a service account performing unexpected file uploads.\n2.  **Endpoint Analysis:** Use an EDR to monitor for processes making unexpected network connections to `*.googleapis.com`. While many legitimate applications do this, a process that has no business using cloud storage (e.g., a non-browser system process) making these connections is highly suspicious.\n3.  **Network Traffic Analysis:** While difficult, it's not impossible. Look for periodic, beacon-like connections to Google Drive APIs that are inconsistent with user behavior. Analyze the size and frequency of data transfers. A process consistently uploading small amounts of data could be a C2 heartbeat, while large, sustained uploads could be data exfiltration.\n\n---\n\n## Mitigation\n1.  **Principle of Least Privilege:** Ensure users and applications only have the permissions they absolutely need. Limit the ability of service accounts to access broad sets of data in cloud storage.\n2.  **Application Control:** Use application allowlisting to prevent unknown executables like `wmsetup.log` from running in the first place.\n3.  **Cloud Access Security Broker (CASB):** Deploy a CASB to gain visibility into and control over how corporate data is accessed and shared in cloud services like Google Drive. A CASB can help enforce policies and detect anomalous behavior.\n4.  **Egress Traffic Filtering:** While the destination is trusted, you can still apply some filtering. For servers that have no need to access Google services, block all outbound connections to `*.googleapis.com` and `*.google.com`.",
  "twitter_post": "New Windows backdoor 'NANOREMOTE' uses the Google Drive API for stealthy C2 communications, hiding in legitimate traffic. The malware, linked to FINALDRAFT, enables data theft & remote execution. ☁️ #Malware #ThreatIntel #C2 #GoogleDrive",
  "meta_description": "Researchers have discovered NANOREMOTE, a new Windows backdoor that uses the Google Drive API for command and control (C2) to evade detection, steal data, and execute commands.",
  "category": [
    "Malware",
    "Threat Intelligence",
    "Cloud Security"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "NANOREMOTE",
      "type": "malware"
    },
    {
      "name": "FINALDRAFT",
      "type": "malware"
    },
    {
      "name": "PATHLOADER",
      "type": "malware"
    },
    {
      "name": "Microsoft Windows",
      "type": "product"
    },
    {
      "name": "Google Drive",
      "type": "product",
      "url": "https://www.google.com/drive/"
    },
    {
      "name": "Elastic Security Labs",
      "type": "security_organization",
      "url": "https://www.elastic.co/security-labs/"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.elastic.co/security-labs/nanoremote-cousin-of-finaldraft",
      "title": "NANOREMOTE, cousin of FINALDRAFT — Elastic Security Labs",
      "date": "2025-12-10",
      "friendly_name": "Elastic Security Labs",
      "website": "elastic.co"
    },
    {
      "url": "https://diesec.com/blog/top-5-cybersecurity-news-stories-december-12-2025",
      "title": "Top 5 Cybersecurity News Stories December 12, 2025",
      "date": "2025-12-12",
      "friendly_name": "DIESEC",
      "website": "diesec.com"
    },
    {
      "url": "https://www.scmagazine.com/news/newly-emergent-nanoremote-malware-sets-sights-on-windows-systems",
      "title": "Newly emergent NANOREMOTE malware sets sights on Windows systems",
      "date": "2025-12-12",
      "friendly_name": "SC Media",
      "website": "scmagazine.com"
    }
  ],
  "events": [
    {
      "datetime": "2025-10-03",
      "summary": "A sample of NANOREMOTE is uploaded to VirusTotal from the Philippines."
    },
    {
      "datetime": "2025-12-10",
      "summary": "Elastic Security Labs publishes its research on the NANOREMOTE backdoor."
    }
  ],
  "mitre_techniques": [
    {
      "id": "T1102.002",
      "name": "Web Service: Bidirectional Communication",
      "tactic": "Command and Control"
    },
    {
      "id": "T1567.002",
      "name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage",
      "tactic": "Exfiltration"
    },
    {
      "id": "T1071.001",
      "name": "Application Layer Protocol: Web Protocols",
      "tactic": "Command and Control"
    },
    {
      "id": "T1027",
      "name": "Obfuscated Files or Information",
      "tactic": "Defense Evasion"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1037",
      "name": "Filter Network Traffic",
      "d3fend_techniques": [
        {
          "id": "D3-NI",
          "name": "Network Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:NetworkIsolation"
        }
      ],
      "description": "Block access to cloud storage services from servers and systems that do not require it.",
      "domain": "enterprise"
    },
    {
      "id": "M1040",
      "name": "Behavior Prevention on Endpoint",
      "d3fend_techniques": [
        {
          "id": "D3-ANET",
          "name": "Authentication Event Thresholding",
          "url": "https://d3fend.mitre.org/technique/d3f:AuthenticationEventThresholding"
        },
        {
          "id": "D3-AZET",
          "name": "Authorization Event Thresholding",
          "url": "https://d3fend.mitre.org/technique/d3f:AuthorizationEventThresholding"
        },
        {
          "id": "D3-RAPA",
          "name": "Resource Access Pattern Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:ResourceAccessPatternAnalysis"
        }
      ],
      "description": "Use EDR to detect anomalous processes making network connections to cloud APIs.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [
        {
          "id": "D3-DAM",
          "name": "Domain Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:DomainAccountMonitoring"
        },
        {
          "id": "D3-LAM",
          "name": "Local Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:LocalAccountMonitoring"
        },
        {
          "id": "D3-SFA",
          "name": "System File Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis"
        }
      ],
      "description": "Audit and analyze cloud service API logs for anomalous activity.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-OTF",
      "technique_name": "Outbound Traffic Filtering",
      "url": "https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering",
      "recommendation": "To counter NANOREMOTE's abuse of Google Drive, organizations must implement intelligent outbound traffic filtering. While blocking Google entirely is not feasible for many, context-aware filtering is key. Create strict firewall and proxy rules for servers and infrastructure that have no legitimate business reason to access consumer cloud services. For user endpoints, use a Cloud Access Security Broker (CASB) or Secure Web Gateway (SWG) to differentiate between corporate-sanctioned Google Workspace instances and personal Google Drive accounts. Block uploads to any non-corporate Google Drive. Furthermore, create policies that alert on processes other than approved Google clients or web browsers making API calls to `www.googleapis.com`. This layered approach to filtering makes it much harder for the malware's C2 traffic to blend in.",
      "mitre_mitigation_id": "M1037"
    },
    {
      "technique_id": "D3-UBA",
      "technique_name": "User Behavior Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:UserBehaviorAnalysis",
      "recommendation": "Since NANOREMOTE mimics legitimate user activity, User Behavior Analytics (UBA) is a critical detection technique. Integrate logs from your EDR, Google Workspace, and network devices into a UBA platform or SIEM. Establish a baseline of normal Google Drive API usage for each user and process. The system should then alert on deviations from this baseline. For example, a background process on a user's machine that has never accessed Google Drive before suddenly starts making periodic API calls, or a user's account starts uploading data at unusual times (e.g., 3 AM) or from a new geographic location. These anomalies, which are invisible to signature-based tools, are strong indicators of a compromised account or endpoint being used by NANOREMOTE for C2.",
      "mitre_mitigation_id": "M1040"
    },
    {
      "technique_id": "D3-PA",
      "technique_name": "Process Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:ProcessAnalysis",
      "recommendation": "At the endpoint level, process analysis can unmask NANOREMOTE's activity. Deploy EDR agents to monitor all running processes and their network connections. Create a specific detection rule to flag any process that is not an official Google Drive client or a standard web browser making persistent connections to Google API domains (`*.googleapis.com`). The discovery of the malware in a file named `wmsetup.log` provides a tangible indicator. Hunt for this filename across all systems. More broadly, focus on the context: a process running from a temporary directory or with a generic name that is communicating with Google Drive is highly suspicious. Correlating this process activity with file creation events (e.g., the creation of `wmsetup.log`) can provide a high-confidence alert for NANOREMOTE infection.",
      "mitre_mitigation_id": "M1049"
    }
  ],
  "iocs": [
    {
      "type": "file_name",
      "value": "wmsetup.log",
      "description": "Filename used by a NANOREMOTE sample, also associated with PATHLOADER malware."
    }
  ],
  "cyber_observables": [
    {
      "type": "domain",
      "value": "www.googleapis.com",
      "description": "The domain used for Google API calls. Monitor for suspicious processes connecting to this domain.",
      "context": "EDR, DNS logs, Proxy logs",
      "confidence": "medium"
    },
    {
      "type": "api_endpoint",
      "value": "/upload/drive/v3/files",
      "description": "Google Drive API endpoint for file uploads. Anomalous or frequent use by non-standard processes is suspicious.",
      "context": "Cloud Access Security Broker (CASB) logs, Network traffic analysis",
      "confidence": "medium"
    },
    {
      "type": "process_name",
      "value": "*",
      "description": "Monitor for any non-browser, non-Google-Drive-client process making connections to Google APIs.",
      "context": "EDR process and network monitoring.",
      "confidence": "high"
    }
  ],
  "tags": [
    "NANOREMOTE",
    "Backdoor",
    "Malware",
    "Google Drive",
    "C2",
    "Cloud Security",
    "FINALDRAFT",
    "Windows"
  ],
  "extract_datetime": "2025-12-13T15:00:00.000Z",
  "article_type": "Analysis",
  "impact_scope": {
    "geographic_scope": "national",
    "countries_affected": [
      "Philippines"
    ],
    "industries_affected": [
      "Other"
    ]
  },
  "pub_date": "2025-12-13",
  "reading_time_minutes": 5,
  "createdAt": "2025-12-13T15:00:00.000Z",
  "updatedAt": "2025-12-13T15:00:00.000Z"
}