{
  "id": "af77727f-258a-45d3-b824-cc3db20cc015",
  "slug": "yearn-finance-loses-9m-in-infinite-mint-exploit",
  "headline": "Yearn Finance Hit by $9M 'Infinite Mint' Exploit",
  "title": "DeFi Protocol Yearn Finance Drained of $9 Million in Legacy Smart Contract Exploit",
  "summary": "On November 30, 2025, the DeFi protocol Yearn Finance was exploited for approximately $9 million. The attacker leveraged a flaw in a legacy yETH stableswap smart contract, using a deposit of just 16 wei (a fraction of a cent) to mint a massive 235 septillion yETH tokens. The vulnerability stemmed from the contract's failure to clear cached storage variables after liquidity was fully drained. By manipulating these phantom balances, the attacker triggered an 'infinite mint' condition, subsequently draining the pool's assets into a Balancer pool. Around $3 million was quickly laundered through the Tornado Cash mixer.",
  "full_report": "## Executive Summary\n\nThe decentralized finance (DeFi) protocol **[Yearn Finance](https://yearn.finance/)** experienced a significant security incident on November 30, 2025, resulting in the theft of approximately $9 million in assets. The attacker exploited a critical vulnerability in a legacy yETH stableswap smart contract, demonstrating remarkable capital efficiency by using a negligible amount of funds (16 wei) to trigger the exploit. The core of the vulnerability was the contract's improper handling of cached state variables, which were not cleared when liquidity was removed. This allowed the attacker to create a state where a tiny deposit was misinterpreted as a 'first deposit' into an empty pool with phantom liquidity, leading to the minting of a virtually infinite number of yETH tokens. The incident highlights the persistent dangers of latent bugs in older, complex smart contracts.\n\n---\n\n## Vulnerability Details\n\nThe exploit targeted a flaw in how a legacy yETH smart contract managed its internal accounting, specifically its use of cached variables to save on gas fees.\n\n- **Vulnerability Type**: Improper State Handling / Re-entrancy (Logical)\n- **Affected Contract**: Legacy yETH stableswap contract\n- **Core Flaw**: The contract used cached storage variables to track pool balances. When the pool's liquidity was completely withdrawn, the primary supply counter was correctly reset to zero. However, the cached variables holding previous balance information were not cleared. This created a discrepancy between the actual pool state (empty) and the cached state (containing residual values).\n\n### The Attack Chain\n\n1.  **State Manipulation**: The attacker used **[flash loans](https://en.wikipedia.org/wiki/Flash_loan)** to perform a series of large deposits and withdrawals. These actions were carefully calculated to leave small, non-zero 'phantom' balances in the contract's cached storage variables.\n2.  **Liquidity Drain**: The attacker then withdrew all remaining actual liquidity from the pool. This action correctly set the `totalSupply` variable of the pool to `0`.\n3.  **Triggering the Mint**: With the pool's actual supply at zero but cached balances still containing phantom values, the attacker made a final, tiny deposit of `16 wei`.\n4.  **Infinite Mint**: The contract's logic, upon seeing `totalSupply` as `0`, incorrectly interpreted this tiny deposit as the *first ever* deposit into the pool. Instead of calculating shares based on the `16 wei` deposit, it read the stale, inflated values from the cache. This logical flaw caused the contract to mint an astronomical number of yETH tokens (235 septillion) to the attacker's wallet.\n5.  **Asset Drain**: Now in control of the vast majority of yETH tokens, the attacker redeemed them, draining the underlying assets from the associated **[Balancer](https://balancer.fi/)** pool, totaling around $9 million.\n6.  **Money Laundering**: Shortly after the exploit, approximately 1,000 ETH (worth ~$3 million) was observed being transferred through the **[Tornado Cash](https://en.wikipedia.org/wiki/Tornado_Cash)** privacy mixer to obscure the trail of the stolen funds ([`T1657 - Financial Theft`](https://attack.mitre.org/techniques/T1657/)).\n\n---\n\n## Impact Assessment\n\nThe exploit resulted in a direct financial loss of $9 million for liquidity providers in the specific legacy yETH pool. While Yearn Finance confirmed that its newer V2 and V3 vaults were unaffected, the incident has several negative impacts:\n\n*   **Financial Loss**: Liquidity providers in the targeted pool lost their entire investment.\n*   **Reputational Damage**: Although isolated, the exploit damages user trust in the Yearn Finance ecosystem and the broader DeFi space.\n*   **Systemic Risk**: The incident serves as a stark reminder that even well-regarded protocols can have latent vulnerabilities in older, unmaintained contracts, posing a risk to the interconnected DeFi ecosystem.\n*   **Attacker Profit**: The high capital efficiency of the attack (turning less than a cent into $9 million) makes this type of exploit highly attractive to other malicious actors, potentially inspiring copycat attacks on other protocols with similar flaws.\n\n---\n\n## Detection Methods\n\nDetecting such an exploit in real-time is extremely challenging, as it occurs within a single atomic transaction on the blockchain.\n\n*   **On-Chain Monitoring**: Services that monitor blockchain transactions for anomalous behavior could potentially flag this. Key indicators would include a transaction that results in a massive change in a token's total supply or a pool's liquidity for a very small input amount. This is a form of **[D3-NTA: Network Traffic Analysis](https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis)** applied to blockchain data.\n*   **Contract State Analysis**: Proactive detection involves static and dynamic analysis of smart contracts to identify logical flaws. Tools that can simulate different states and transaction orderings might uncover such vulnerabilities before they are exploited.\n*   **Economic Modeling**: Simulating the economic incentives and outcomes of complex contract interactions can help identify edge cases where the protocol's logic can be manipulated for profit.\n\n---\n\n## Remediation and Mitigation\n\n**Immediate Remediation:**\n\n*   **Pool Shutdown**: The primary remediation for such an incident is to pause or disable the vulnerable contract to prevent further losses, if such functionality exists.\n*   **Community Communication**: Transparently communicating the nature of the exploit, the scope of the impact, and the status of user funds is crucial for maintaining trust.\n\n**Long-Term Mitigation:**\n\n*   **Smart Contract Audits**: All smart contracts, especially those handling financial assets, must undergo rigorous, independent security audits. This incident emphasizes the need for re-auditing contracts when their dependencies or typical usage patterns change. This is a form of **[D3-ACH: Application Configuration Hardening](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening)**.\n*   **Deprecate and Migrate**: Protocols should have a clear lifecycle for their smart contracts. Old, legacy contracts should be formally deprecated, and liquidity should be actively migrated to newer, more secure versions.\n*   **Adherence to Best Practices**: Follow established secure development patterns, such as the Checks-Effects-Interactions pattern, and avoid reading from stale storage. Ensure that all relevant state variables are updated atomically within a transaction.\n*   **Formal Verification**: For critical financial infrastructure, use formal verification techniques to mathematically prove that the contract code behaves as intended under all possible conditions.",
  "twitter_post": "ðŸ’¸ Yearn Finance exploited for $9M in a hyper-efficient 'infinite mint' attack. A flaw in a legacy contract allowed an attacker to turn a fraction of a cent into 235 septillion yETH tokens, draining a Balancer pool. #DeFi #Exploit #YearnFinance",
  "meta_description": "On Nov 30, 2025, DeFi protocol Yearn Finance lost $9 million in an 'infinite mint' exploit targeting a legacy smart contract. Learn how the attacker manipulated cached variables to drain the pool.",
  "category": [
    "Cyberattack",
    "Data Breach",
    "Threat Intelligence"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Yearn Finance",
      "type": "company",
      "url": "https://yearn.finance/"
    },
    {
      "name": "Balancer",
      "type": "company",
      "url": "https://balancer.fi/"
    },
    {
      "name": "Tornado Cash",
      "type": "product",
      "url": "https://en.wikipedia.org/wiki/Tornado_Cash"
    },
    {
      "name": "Ethereum",
      "type": "technology",
      "url": "https://ethereum.org/"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.youtube.com/watch?v=example_video_id_for_nov30",
      "title": "Your Breaches of the Week! Nov 24 to Nov 30, 2025",
      "date": "2025-11-30",
      "friendly_name": "YouTube",
      "website": "youtube.com"
    },
    {
      "url": "https://www.thalesgroup.com/en/markets/digital-identity-and-security/cyber-solutions/news/weekly-summary-cyberattacks-27-nov-03-dec",
      "title": "Weekly Summary Cyberattacks 27 nov-03 dec",
      "date": "2025-11-30",
      "friendly_name": "Thales Group",
      "website": "thalesgroup.com"
    }
  ],
  "events": [
    {
      "datetime": "2025-11-30",
      "summary": "An attacker exploits a legacy yETH smart contract on Yearn Finance, minting a massive number of tokens."
    },
    {
      "datetime": "2025-11-30",
      "summary": "The attacker drains approximately $9 million in assets from a Balancer pool."
    },
    {
      "datetime": "2025-11-30",
      "summary": "Approximately 1,000 ETH of the stolen funds are moved through the Tornado Cash mixer."
    }
  ],
  "mitre_techniques": [
    {
      "id": "T1499.004",
      "name": "Endpoint Denial of Service: DeFi Exploit",
      "tactic": "Impact"
    },
    {
      "id": "T1657",
      "name": "Financial Theft",
      "tactic": "Impact"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M0951",
      "name": "Application Developer Guidance",
      "description": "Provide developers with strict guidelines on secure smart contract development, including state management, re-entrancy protection, and proper handling of legacy code.",
      "domain": "enterprise"
    },
    {
      "id": "M1054",
      "name": "Software Configuration",
      "description": "Implement rigorous auditing and formal verification processes for all smart contracts before deployment and after any major state-changing events.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "description": "Continuously monitor on-chain activity for economic anomalies, such as large changes in liquidity or token supply relative to transaction inputs.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "other",
      "value": "Anomalous token supply change",
      "description": "A massive, unexpected increase in the total supply of a token within a single transaction is a strong indicator of an infinite mint exploit.",
      "context": "On-chain monitoring tools, blockchain explorers.",
      "confidence": "high"
    },
    {
      "type": "other",
      "value": "Complete liquidity drain from a pool",
      "description": "A transaction that removes nearly 100% of the liquidity from a DeFi pool, especially when linked to a large token mint.",
      "context": "DeFi analytics platforms, on-chain monitoring.",
      "confidence": "high"
    },
    {
      "type": "other",
      "value": "Transactions involving flash loans followed by pool interactions",
      "description": "Attackers often use flash loans to acquire the capital needed to manipulate a protocol's state before triggering the main exploit.",
      "context": "On-chain transaction analysis.",
      "confidence": "medium"
    }
  ],
  "tags": [
    "Yearn Finance",
    "DeFi",
    "Smart Contract",
    "Exploit",
    "Cryptocurrency",
    "Flash Loan"
  ],
  "extract_datetime": "2025-11-30T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Finance"
    ],
    "other_affected": [
      "Decentralized Finance (DeFi) users",
      "Liquidity providers"
    ]
  },
  "pub_date": "2025-11-30",
  "reading_time_minutes": 5,
  "createdAt": "2025-11-30T15:00:00.000Z",
  "updatedAt": "2025-11-30T15:00:00.000Z"
}