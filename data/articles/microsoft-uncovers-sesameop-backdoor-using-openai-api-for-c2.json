{
  "id": "cc7b11e1-7a83-4257-9548-dcbacc098061",
  "slug": "microsoft-uncovers-sesameop-backdoor-using-openai-api-for-c2",
  "headline": "Microsoft Discovers 'SesameOp' Backdoor Using OpenAI API for Covert C2",
  "title": "Microsoft DART Uncovers Novel 'SesameOp' Backdoor Leveraging OpenAI Assistants API for Command and Control in Espionage Campaign",
  "summary": "Microsoft's Detection and Response Team (DART) has discovered a novel backdoor named 'SesameOp' that uniquely uses the OpenAI Assistants API for its command-and-control (C2) communications. Found during an espionage investigation, the malware hides its malicious traffic within legitimate API calls to the OpenAI platform, making it extremely difficult to detect. The attackers also used .NET AppDomainManager injection by compromising Microsoft Visual Studio utilities to achieve persistence.",
  "full_report": "## Executive Summary\nResearchers from **[Microsoft's](https://www.microsoft.com/security)** Detection and Response Team (DART) have identified a novel and highly stealthy backdoor, dubbed **SesameOp**. The malware was discovered in July 2025 during an incident response engagement involving a sophisticated, espionage-focused threat actor. SesameOp's defining characteristic is its use of the **[OpenAI](https://openai.com/)** Assistants API as its command-and-control (C2) channel. This technique allows the malware to mask its communications as legitimate traffic to a trusted, widely used service, thereby bypassing many network-based security controls. The attackers also employed advanced persistence techniques, including the compromise of Microsoft Visual Studio utilities through .NET AppDomainManager injection.\n\n---\n\n## Threat Overview\nThe threat actor behind SesameOp is focused on long-term espionage, maintaining persistence in the target environment for several months. The core of their operation is the **SesameOp** backdoor, which uses an unconventional method for C2.\n\nInstead of connecting to an attacker-controlled server, a component of the malware makes API calls to the OpenAI Assistants API. The attacker stores commands within the context of an 'Assistant' object on the OpenAI platform. The malware periodically queries this object via the API to retrieve new commands for execution. The output of these commands is then sent back through the same API. This abuse of a legitimate service ([`T1102.002 - Bidirectional Communication`](https://attack.mitre.org/techniques/T1102/002/)) makes the C2 traffic exceptionally difficult to distinguish from benign use of the OpenAI API.\n\n## Technical Analysis\n### C2 via OpenAI Assistants API\nThe malware leverages the OpenAI platform as a third-party proxy for C2. This method offers several advantages to the attacker:\n- **Stealth**: Network traffic is directed to a legitimate, reputable domain (`api.openai.com`), which is unlikely to be blocked.\n- **Encryption**: All communication is encrypted via standard TLS, blending in with normal web traffic.\n- **Anonymity**: It obfuscates the true location of the attacker's C2 server.\n\nThe malware uses the API to fetch commands, which are then executed on the compromised system using a series of internal web shells.\n\n### Persistence via AppDomainManager Injection\nThe attackers achieved persistence by compromising multiple **Microsoft Visual Studio** utilities. They used a technique known as .NET AppDomainManager injection ([`T1546.011 - AppDomainManager`](https://attack.mitre.org/techniques/T1546/011/)). This involves modifying configuration files to force a .NET application to load a malicious library upon startup. By targeting legitimate, signed Microsoft utilities, the attackers were able to execute their code in a trusted process, a form of defense evasion.\n\nThe DART team discovered the backdoor by hunting for Visual Studio utilities that were loading unusual or unexpected libraries, which led them to the malicious artifact containing SesameOp.\n\n## Impact Assessment\nThe primary goal of this campaign is espionage. The stealthy nature of the **SesameOp** backdoor and its persistence mechanism allows the threat actor to maintain long-term access to a compromised network for intelligence gathering. This can include stealing intellectual property, sensitive corporate data, and government secrets. The use of a novel C2 channel like the OpenAI API indicates a trend towards more sophisticated evasion techniques that challenge traditional detection models.\n\n## Cyber Observables for Detection\n| Type | Value | Description |\n|---|---|---|\n| domain | `api.openai.com` | Monitor for connections to this domain from servers or workstations that have no legitimate business reason to use the OpenAI API. |\n| api_endpoint | `/v1/assistants` | Specific API endpoint used by the malware. Anomalous traffic patterns to this endpoint are suspicious. |\n| command_line_pattern | `devenv.exe` loading unusual DLLs | The Visual Studio process loading non-standard or unsigned libraries could indicate AppDomainManager injection. |\n| log_source | `Web Proxy Logs` | Analyze logs for endpoints making frequent, small, and regular API calls to OpenAI, which could be C2 beacons. |\n\n## Detection & Response\n1.  **Egress Traffic Analysis**: Monitor and analyze all outbound traffic to `api.openai.com`. While many organizations may have legitimate use, traffic from servers or specific user segments that do not typically use AI services should be scrutinized. This is a direct application of **[D3-OTF: Outbound Traffic Filtering](https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering)**.\n2.  **API Key Auditing**: Audit the usage of OpenAI API keys within your organization. Look for keys being used from unexpected geographic locations or systems.\n3.  **Endpoint Monitoring**: Use an EDR to monitor for signs of AppDomainManager injection. Hunt for modifications to `.exe.config` files and for processes loading unusual DLLs at startup. This aligns with **[D3-SFA: System File Analysis](https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis)**.\n4.  **Process Baselining**: Establish a baseline of normal process activity and loaded modules for developer tools like Visual Studio. Alert on any deviations from this baseline.\n\n## Mitigation\n1.  **Restrict API Access**: If your organization does not use the OpenAI API, block access to `api.openai.com` at the network perimeter. If it is used, restrict access to only authorized users and systems. See [`M1021 - Restrict Web-Based Content`](https://attack.mitre.org/mitigations/M1021/).\n2.  **Application Control**: Deploy application control policies to prevent legitimate applications like Visual Studio from loading unauthorized or unsigned DLLs. This can help prevent persistence via injection techniques. See [`M1038 - Execution Prevention`](https://attack.mitre.org/mitigations/M1038/).\n3.  **Harden Developer Workstations**: Apply strict security controls to developer workstations, as they are high-value targets. This includes least privilege access, regular patching, and advanced endpoint protection.",
  "twitter_post": "ðŸ¤– Novel 'SesameOp' backdoor discovered by Microsoft uses the OpenAI Assistants API for C2 communications. This espionage tool hides malicious traffic within legitimate API calls, making detection a major challenge. #Malware #OpenAI #C2 #Espionage",
  "meta_description": "Microsoft researchers have discovered 'SesameOp,' a new backdoor that abuses the OpenAI Assistants API for stealthy command-and-control in a targeted espionage campaign.",
  "category": [
    "Malware",
    "Threat Actor",
    "Cloud Security"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Microsoft",
      "type": "vendor",
      "url": "https://www.microsoft.com/security"
    },
    {
      "name": "Microsoft DART",
      "type": "security_organization"
    },
    {
      "name": "OpenAI",
      "type": "vendor",
      "url": "https://openai.com/"
    },
    {
      "name": "OpenAI Assistants API",
      "type": "product"
    },
    {
      "name": "SesameOp",
      "type": "malware"
    },
    {
      "name": "Microsoft Visual Studio",
      "type": "product"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://www.microsoft.com/en-us/security/blog/2025/11/03/sesameop-novel-backdoor-uses-openai-assistants-api-for-command-and-control/",
      "title": "SesameOp: Novel backdoor uses OpenAI Assistants API for command and control",
      "date": "2025-11-03",
      "friendly_name": "Microsoft Security Blog",
      "website": "microsoft.com"
    }
  ],
  "events": [
    {
      "datetime": "2025-07",
      "summary": "Microsoft's DART discovers the SesameOp backdoor during an incident response investigation."
    }
  ],
  "mitre_techniques": [
    {
      "id": "T1102.002",
      "name": "Bidirectional Communication",
      "tactic": "Command and Control"
    },
    {
      "id": "T1071.001",
      "name": "Web Protocols",
      "tactic": "Command and Control"
    },
    {
      "id": "T1546.011",
      "name": "AppDomainManager",
      "tactic": "Persistence"
    },
    {
      "id": "T1105",
      "name": "Ingress Tool Transfer",
      "tactic": "Command and Control"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1021",
      "name": "Restrict Web-Based Content",
      "d3fend_techniques": [
        {
          "id": "D3-OTF",
          "name": "Outbound Traffic Filtering",
          "url": "https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering"
        }
      ],
      "description": "Block or restrict outbound connections to services like the OpenAI API from servers and user segments that have no legitimate need for them.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "d3fend_techniques": [
        {
          "id": "D3-EAL",
          "name": "Executable Allowlisting",
          "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting"
        }
      ],
      "description": "Use application control to prevent legitimate developer tools from loading unauthorized or malicious DLLs, mitigating the AppDomainManager persistence technique.",
      "domain": "enterprise"
    },
    {
      "id": "M1048",
      "name": "Application Isolation and Sandboxing",
      "description": "Run developer tools and other high-risk applications in isolated or sandboxed environments to limit their ability to impact the host system if compromised.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-OTF",
      "technique_name": "Outbound Traffic Filtering",
      "url": "https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering",
      "recommendation": "To counter C2 channels like SesameOp that abuse legitimate services, a strict outbound traffic filtering policy is essential. The default policy should be to deny all outbound traffic. Then, explicitly allow connections only to known-good, required services on a per-system or per-user-group basis. In the context of SesameOp, this means that unless a server has a documented, approved business need to contact `api.openai.com`, all such connections should be blocked at the firewall. For approved use cases, access should be limited to specific source IPs. This preventative control drastically shrinks the C2 surface area available to attackers.",
      "mitre_mitigation_id": "M1021"
    },
    {
      "technique_id": "D3-SFA",
      "technique_name": "System File Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis",
      "recommendation": "To detect the AppDomainManager injection persistence used by the SesameOp actors, organizations should implement System File Analysis, likely through a File Integrity Monitoring (FIM) solution. A FIM agent should be configured to monitor all `.exe.config` files associated with Microsoft Visual Studio and other .NET applications. Any unauthorized modification to these files is a strong indicator of a persistence attempt. Alerts should be generated immediately for any changes, allowing security teams to investigate and determine if the modification is legitimate or an attempt to inject a malicious DLL, as seen in this campaign.",
      "mitre_mitigation_id": "M1047"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "api_endpoint",
      "value": "api.openai.com/v1/assistants",
      "description": "The specific API endpoint abused by SesameOp for C2. Anomalous traffic from servers to this endpoint is highly suspicious.",
      "context": "Web proxy logs, NDR solutions",
      "confidence": "high"
    },
    {
      "type": "registry_key",
      "value": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
      "description": "While the article mentions AppDomainManager injection, attackers often use related techniques. Monitoring this registry key for unusual DLLs is a good general practice for persistence.",
      "context": "EDR, Registry monitoring tools",
      "confidence": "low"
    },
    {
      "type": "file_path",
      "value": "<application_name>.exe.config",
      "description": "Modification of .NET application configuration files, particularly for Visual Studio utilities, can indicate AppDomainManager injection.",
      "context": "File Integrity Monitoring (FIM)",
      "confidence": "medium"
    }
  ],
  "tags": [
    "SesameOp",
    "Malware",
    "Backdoor",
    "OpenAI",
    "API",
    "C2",
    "Espionage",
    "Microsoft",
    "AppDomainManager"
  ],
  "extract_datetime": "2025-11-03T15:00:00.000Z",
  "article_type": "NewsArticle",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Government",
      "Defense"
    ],
    "other_affected": [
      "Organizations targeted for espionage"
    ]
  },
  "pub_date": "2025-11-03",
  "reading_time_minutes": 5,
  "createdAt": "2025-11-03T15:00:00.000Z",
  "updatedAt": "2025-11-03T15:00:00.000Z"
}