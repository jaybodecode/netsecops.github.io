{
  "id": "7e66af22-ead2-4097-867b-df7f322253ce",
  "slug": "aws-codebuild-codebreach-supply-chain-vulnerability",
  "headline": "AWS Patches 'CodeBreach' Flaw, Averting Massive GitHub Supply Chain Attack",
  "title": "AWS Fixes Critical \"CodeBreach\" Flaw in CodeBuild That Exposed GitHub Repositories to Widespread Supply Chain Attacks",
  "summary": "Amazon Web Services (AWS) has remediated a critical vulnerability in its AWS CodeBuild service, dubbed 'CodeBreach' by Wiz researchers. The flaw, which stemmed from a misconfigured webhook filter, could have allowed unauthenticated attackers to inject malicious code into the build processes of major open-source projects, including the AWS JavaScript SDK. An exploit could have granted attackers administrative control over key GitHub repositories, creating a catastrophic supply chain risk for the millions of applications and cloud environments that depend on these libraries. The vulnerability was discovered following a separate, failed attack attempt, highlighting the real-world threat. AWS has since patched the issue and implemented global hardening measures.",
  "full_report": "## Executive Summary\nOn January 15, 2026, security firm **[Wiz](https://www.wiz.io)** disclosed **CodeBreach**, a critical vulnerability in **[Amazon Web Services](https://aws.amazon.com/)**' **[AWS CodeBuild](https://aws.amazon.com/codebuild/)** service. The flaw, now patched, could have allowed unauthenticated attackers to gain administrative access to connected **[GitHub](https://github.com/)** repositories by bypassing misconfigured webhook filters. The primary risk was a potential supply chain attack against core software libraries, most notably the **AWS JavaScript SDK**, which is used in a majority of cloud environments and within the AWS Console itself. A successful exploit could have led to the widespread distribution of malicious code, compromising countless downstream users and cloud infrastructures. AWS confirmed the flaw was fixed promptly after responsible disclosure in August 2025 and stated that no customer environments were impacted.\n\n---\n\n## Threat Overview\nThe CodeBreach vulnerability was a high-impact misconfiguration within the AWS CodeBuild CI/CD service. It allowed an attacker to bypass the intended security controls that trigger build jobs from GitHub events. The core of the issue was a faulty regular expression in a webhook filter that failed to properly validate the source of a build trigger. An unauthenticated attacker, knowing the `actor ID` of a legitimate GitHub account associated with a target repository, could craft a malicious request to initiate a build.\n\nOnce the build was triggered, the attacker could exploit the environment to leak the highly privileged GitHub Personal Access Token (PAT) associated with the CodeBuild project. In the case of the AWS JavaScript SDK repository, this token had full administrative privileges, enabling the attacker to:\n1.  Push malicious code directly to the main branch.\n2.  Approve their own malicious pull requests.\n3.  Modify repository settings and secrets.\n\nThe discovery was prompted by a real-world, albeit failed, supply chain attack attempt against the Amazon Q VS Code extension, which used a similarly vulnerable CodeBuild project. This incident underscores the growing trend of attackers targeting CI/CD pipelines as a vector for broad-impact supply chain compromises.\n\n---\n\n## Technical Analysis\nThe attack chain relied on exploiting a logic flaw in the webhook filtering mechanism of AWS CodeBuild.\n\n1.  **Initial Access - Bypassing Webhook Filters:** The attacker crafts a `git-upload-pack` request that includes a specific GitHub `actor ID` in the payload. The misconfigured regex on the AWS CodeBuild webhook listener failed to properly anchor its checks, allowing this crafted request to be processed as a legitimate trigger. This maps to [`T1190 - Exploit Public-Facing Application`](https://attack.mitre.org/techniques/T1190/).\n\n2.  **Execution - Triggering a Malicious Build:** The malicious request successfully triggers a new build job within the victim's CodeBuild environment. The attacker can specify a buildspec that contains commands to exfiltrate secrets.\n\n3.  **Credential Access - Leaking GitHub Token:** Inside the compromised build environment, the attacker's commands can access environment variables or configuration files containing the GitHub PAT. This token is then exfiltrated to an attacker-controlled server. This aligns with [`T1552.006 - Group Policy Preferences`](https://attack.mitre.org/techniques/T1552/006/) where secrets are stored in accessible locations.\n\n4.  **Impact & Persistence - Code Repository Compromise:** With the administrative PAT, the attacker gains full control over the target GitHub repository. They can inject malicious code, creating a backdoor in a trusted software library. This constitutes a classic [`T1195.001 - Compromise Software Dependencies and Development Tools`](https://attack.mitre.org/techniques/T1195/001/) supply chain attack. The ability to approve pull requests and modify code also provides a form of persistence within the development lifecycle.\n\n### MITRE ATT&CK Mapping\n| Tactic | Technique ID | Technique Name |\n| :--- | :--- | :--- |\n| Initial Access | `T1190` | Exploit Public-Facing Application |\n| Credential Access | `T1552.006` | Group Policy Preferences |\n| Impact | `T1195.001` | Compromise Software Dependencies and Development Tools |\n| Defense Evasion | `T1078` | Valid Accounts |\n\n---\n\n## Impact Assessment\nA successful exploitation of CodeBreach would have been catastrophic. The primary target identified, the **AWS JavaScript SDK**, is a foundational component for a vast number of applications and services that interact with AWS. According to Wiz, 66% of cloud environments utilize this SDK.\n\n*   **Widespread Compromise:** Injecting malicious code into an official release of the SDK would have resulted in a massive supply chain attack, distributing malware to potentially millions of downstream systems and applications globally.\n*   **Compromise of AWS Console:** Since the AWS Console itself uses this SDK, attackers could have potentially gained code execution capabilities within the primary management interface for all AWS services, giving them a foothold to attack customer environments from a trusted source.\n*   **Loss of Trust:** Such a breach would have severely damaged trust in AWS's software distribution and the security of its core services.\n*   **Financial and Reputational Damage:** The fallout for AWS and its customers would have been immense, involving costly incident response, remediation efforts, and significant reputational harm.\n\n---\n\n## Cyber Observables for Detection\nSecurity teams should hunt for signs of CI/CD pipeline abuse:\n\n| Type | Value | Description |\n| :--- | :--- | :--- |\n| log_source | `AWS CloudTrail` | Monitor for unusual or unauthorized `StartBuild` API calls in CodeBuild. |\n| log_source | `GitHub Audit Logs` | Look for suspicious pull request approvals, direct pushes to main branches, or changes to repository secrets by service accounts. |\n| network_traffic_pattern | Outbound traffic from build runners | Monitor for network connections from CodeBuild environments to unknown or suspicious IP addresses, especially those associated with data exfiltration. |\n| command_line_pattern | `printenv`, `cat /root/.git-credentials` | Look for build commands that inspect or exfiltrate environment variables or credential files within build logs. |\n\n---\n\n## Detection & Response\nDetecting this type of attack requires deep visibility into CI/CD pipeline activity and repository interactions.\n\n*   **Log Analysis (D3-NTA):** Implement **[Network Traffic Analysis](https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis)** on egress traffic from build environments. Baseline normal traffic patterns and alert on connections to unusual destinations or large data transfers. Ingest AWS CloudTrail and CodeBuild execution logs into a SIEM.\n*   **Behavioral Analysis (D3-UBA):** Use **[User Behavior Analysis](https://d3fend.mitre.org/technique/d3f:UserBehaviorAnalysis)** on service accounts and CI/CD roles. Alert on anomalous activities, such as a CodeBuild role accessing unusual secrets or a GitHub service account approving PRs outside of normal working hours.\n*   **Configuration Auditing:** Regularly audit CodeBuild project configurations, especially webhook filters and permissions. Use automated tools to detect overly permissive regex or missing authentication checks.\n*   **Incident Response Playbook:** Develop a specific playbook for a suspected CI/CD pipeline compromise. Key steps should include immediately revoking the associated GitHub token, isolating the build environment, analyzing build logs for exfiltrated data, and scanning all recent code commits for malicious changes.\n\n---\n\n## Mitigation\nWhile AWS has patched the specific flaw, organizations should adopt a defense-in-depth strategy for their CI/CD pipelines.\n\n1.  **Principle of Least Privilege (M1026):** Ensure CodeBuild projects and their associated service accounts have the minimum permissions necessary. GitHub tokens should be scoped to specific repositories and granted only the required access (e.g., read-only if pushes are not needed). This maps to **[D3-UAP: User Account Permissions](https://d3fend.mitre.org/technique/d3f:UserAccountPermissions)**.\n\n2.  **Harden Webhook Configurations (M1054):** Implement strict validation on all incoming webhooks. Use cryptographic verification (e.g., webhook secrets) to ensure triggers originate from a trusted source, rather than relying solely on IP filtering or payload inspection. This is a form of **[Application Configuration Hardening (D3-ACH)](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening)**.\n\n3.  **Audit and Monitor (M1047):** Continuously monitor CI/CD logs (CloudTrail, CodeBuild logs) and source code repository audit logs (GitHub audit logs) for suspicious activity. Set up alerts for events like direct pushes to protected branches or changes in repository permissions by automated accounts. This relates to **[Domain Account Monitoring (D3-DAM)](https://d3fend.mitre.org/technique/d3f:DomainAccountMonitoring)**.\n\n4.  **Require Pull Request Reviews:** Enforce policies that require human review for all pull requests, even those from automated systems. Do not allow CI/CD service accounts to merge code into protected branches without oversight.",
  "twitter_post": "ðŸš¨ CRITICAL FLAW: AWS patches 'CodeBreach' vulnerability in CodeBuild that exposed GitHub repos to massive supply chain attacks. The flaw could have allowed attackers to inject malicious code into the AWS JavaScript SDK. #SupplyChain #AWS #CyberSecurity",
  "meta_description": "AWS has patched a critical 'CodeBreach' vulnerability in its CodeBuild service that could have enabled a massive supply chain attack by allowing attackers to inject malicious code into core GitHub repositories like the AWS JavaScript SDK.",
  "category": [
    "Supply Chain Attack",
    "Cloud Security",
    "Vulnerability"
  ],
  "severity": "critical",
  "entities": [
    {
      "name": "Amazon Web Services",
      "type": "vendor",
      "url": "https://aws.amazon.com/"
    },
    {
      "name": "Wiz",
      "type": "security_organization",
      "url": "https://www.wiz.io/"
    },
    {
      "name": "GitHub",
      "type": "company",
      "url": "https://github.com/"
    },
    {
      "name": "AWS CodeBuild",
      "type": "product",
      "url": "https://aws.amazon.com/codebuild/"
    },
    {
      "name": "AWS JavaScript SDK",
      "type": "product"
    },
    {
      "name": "Amazon Q",
      "type": "product"
    },
    {
      "name": "VS Code",
      "type": "product"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://thehackernews.com/2026/01/aws-codebuild-misconfiguration-exposed.html",
      "title": "AWS CodeBuild Misconfiguration Exposed GitHub Repos to Potential Supply Chain Attacks",
      "date": "2026-01-15",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    },
    {
      "url": "https://www.infoworld.com/article/3715891/possible-software-supply-chain-attack-through-aws-codebuild-service-blunted.html",
      "title": "Possible software supply chain attack through AWS CodeBuild service blunted",
      "date": "2026-01-15",
      "friendly_name": "InfoWorld",
      "website": "infoworld.com"
    },
    {
      "url": "https://www.theregister.com/2026/01/15/aws_codebuild_vulnerability/",
      "title": "A simple CodeBuild flaw put every AWS environment at risk",
      "date": "2026-01-15",
      "friendly_name": "The Register",
      "website": "theregister.com"
    }
  ],
  "events": [
    {
      "datetime": "2025-08-25T00:00:00Z",
      "summary": "Wiz researchers discover and responsibly disclose the 'CodeBreach' vulnerability to AWS."
    },
    {
      "datetime": "2026-01-15T00:00:00Z",
      "summary": "Wiz publicly discloses the details of the 'CodeBreach' vulnerability after AWS implemented patches and hardening measures."
    }
  ],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1195.001",
      "name": "Compromise Software Dependencies and Development Tools",
      "tactic": "Impact"
    },
    {
      "id": "T1078",
      "name": "Valid Accounts",
      "tactic": "Defense Evasion"
    },
    {
      "id": "T1552.006",
      "name": "Group Policy Preferences",
      "tactic": "Credential Access"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1054",
      "name": "Software Configuration",
      "d3fend_techniques": [
        {
          "id": "D3-ACH",
          "name": "Application Configuration Hardening",
          "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening"
        }
      ],
      "description": "Harden CI/CD webhook configurations to require cryptographic verification, preventing spoofed build triggers.",
      "domain": "enterprise"
    },
    {
      "id": "M1026",
      "name": "Privileged Account Management",
      "d3fend_techniques": [
        {
          "id": "D3-DAM",
          "name": "Domain Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:DomainAccountMonitoring"
        },
        {
          "id": "D3-LAM",
          "name": "Local Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:LocalAccountMonitoring"
        }
      ],
      "description": "Apply the principle of least privilege to CI/CD service accounts and their access tokens, scoping permissions to the minimum required.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [
        {
          "id": "D3-DAM",
          "name": "Domain Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:DomainAccountMonitoring"
        },
        {
          "id": "D3-LAM",
          "name": "Local Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:LocalAccountMonitoring"
        },
        {
          "id": "D3-SFA",
          "name": "System File Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis"
        }
      ],
      "description": "Implement comprehensive logging and monitoring for CI/CD pipelines and source code repositories to detect anomalous behavior.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-ACH",
      "technique_name": "Application Configuration Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening",
      "recommendation": "In the context of the CodeBreach vulnerability, Application Configuration Hardening should be applied directly to the CI/CD pipeline's interaction points. Specifically for AWS CodeBuild and GitHub integration, this involves moving beyond simple regex filters for webhook validation. Instead, organizations must implement and enforce the use of webhook secrets. When configuring a webhook in GitHub, a secret token should be generated. This token is then sent with each webhook payload in the `X-Hub-Signature-256` header. The CodeBuild project or an intermediary Lambda function must be configured to validate this signature using the shared secret before processing any build request. This cryptographic verification ensures that the request genuinely originated from the configured GitHub repository and not an attacker spoofing the request structure. This countermeasure directly prevents the initial access vector used in the CodeBreach attack by providing strong authentication for build triggers.",
      "mitre_mitigation_id": "M1054"
    },
    {
      "technique_id": "D3-UAP",
      "technique_name": "User Account Permissions",
      "url": "https://d3fend.mitre.org/technique/d3f:UserAccountPermissions",
      "recommendation": "The impact of CodeBreach was magnified by the administrative privileges of the leaked GitHub PAT. To mitigate this, User Account Permissions must be strictly enforced using the principle of least privilege. Instead of using long-lived, admin-level PATs, organizations should transition to short-lived, fine-grained access tokens. For GitHub, this means using GitHub Apps or fine-grained personal access tokens that can be scoped to specific repositories and specific permissions (e.g., read-only access to code, write access only to pull request comments). For AWS CodeBuild, the associated IAM role should only have permissions to perform its specific build tasks and nothing more. Regularly audit these permissions using tools like IAM Access Analyzer. By ensuring the CI/CD service account can only perform its designated function, the potential damage from a compromised build environment is drastically reduced, preventing an attacker from escalating to full repository control.",
      "mitre_mitigation_id": "M1015"
    },
    {
      "technique_id": "D3-NTA",
      "technique_name": "Network Traffic Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis",
      "recommendation": "To detect the exfiltration phase of an attack like CodeBreach, implement robust Network Traffic Analysis for all egress traffic from CI/CD build environments. Since CodeBuild runners operate within an AWS-managed VPC, this can be achieved by analyzing VPC Flow Logs or deploying a network tap with an IDS/IPS. Security teams should establish a baseline of normal outbound traffic. For most build jobs, this might be limited to package repositories (e.g., npm, PyPI), container registries, and the source code provider (GitHub). Any connection from a build runner to an unknown or suspicious IP address, a cloud storage bucket in a different organization, or a raw data transfer service like Pastebin should trigger a high-severity alert. This technique acts as a critical backstop, allowing for the detection of a compromise even if the initial access and execution phases are missed.",
      "mitre_mitigation_id": "M1031"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "log_source",
      "value": "AWS CloudTrail",
      "description": "Monitor for anomalous 'StartBuild' events in AWS CodeBuild, especially those triggered outside of expected workflows or by unusual principals.",
      "context": "SIEM, Cloud Security Posture Management (CSPM)",
      "confidence": "high"
    },
    {
      "type": "log_source",
      "value": "GitHub Audit Logs",
      "description": "Hunt for pull requests being merged by service accounts without human review, or direct commits to protected branches by CI/CD-related accounts.",
      "context": "Version Control System Security Monitoring",
      "confidence": "high"
    },
    {
      "type": "network_traffic_pattern",
      "value": "*",
      "description": "Egress traffic from CodeBuild execution environments to non-standard, non-approved IP addresses or domains should be considered highly suspicious.",
      "context": "Network Intrusion Detection System (NIDS), VPC Flow Logs",
      "confidence": "medium"
    },
    {
      "type": "command_line_pattern",
      "value": "curl",
      "description": "Build steps executing 'curl' or similar commands to exfiltrate environment variables or files to external endpoints.",
      "context": "CI/CD Build Logs, Endpoint Detection and Response (EDR)",
      "confidence": "high"
    }
  ],
  "tags": [
    "CodeBreach",
    "CI/CD Security",
    "Supply Chain Attack",
    "AWS",
    "CodeBuild",
    "GitHub",
    "Wiz",
    "Vulnerability"
  ],
  "extract_datetime": "2026-01-16T15:00:00.000Z",
  "article_type": "Advisory",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Critical Infrastructure",
      "Finance",
      "Healthcare"
    ],
    "other_affected": [
      "cloud service customers",
      "open-source software users"
    ],
    "people_affected_estimate": "Potentially millions of downstream users of applications built with the AWS JavaScript SDK"
  },
  "pub_date": "2026-01-16",
  "reading_time_minutes": 7,
  "createdAt": "2026-01-16T15:00:00.000Z",
  "updatedAt": "2026-01-16T15:00:00.000Z"
}