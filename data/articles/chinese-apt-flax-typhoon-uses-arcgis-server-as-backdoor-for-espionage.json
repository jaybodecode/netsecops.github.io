{
  "id": "850c557b-6554-4129-af07-24cdba996a4a",
  "slug": "chinese-apt-flax-typhoon-uses-arcgis-server-as-backdoor-for-espionage",
  "headline": "Chinese APT Flax Typhoon Weaponizes ArcGIS Server as Persistent Backdoor in Year-Long Spy Campaign",
  "title": "Flax Typhoon APT Exploited Esri ArcGIS Server for Over a Year as a Backdoor into Government Networks",
  "summary": "The China-linked threat group Flax Typhoon (also known as Ethereal Panda) conducted a sophisticated, year-long espionage campaign against a government agency by compromising an Esri ArcGIS server. According to researchers at ReliaQuest, the attackers modified a legitimate Java server object extension (SOE) to create a persistent web shell. This backdoor, combined with extensive use of living-off-the-land techniques like PowerShell and a renamed SoftEther VPN client, allowed the APT group to maintain long-term access, move laterally, and harvest credentials while evading detection by hiding within legitimate server traffic.",
  "full_report": "## Executive Summary\nA long-term espionage campaign attributed to the Chinese state-sponsored group **[Flax Typhoon](https://attack.mitre.org/groups/G1023/)** (also known as Ethereal Panda) has been uncovered, revealing a novel and stealthy attack vector. The group compromised a government agency's network for over a year by weaponizing a legitimate component of an **[Esri](https://www.esri.com)** ArcGIS Server. By modifying a Java Server Object Extension (SOE), the threat actors created a persistent web shell that served as a durable backdoor. The campaign was characterized by its heavy reliance on living-off-the-land (LotL) techniques to blend in with normal administrative activity, highlighting the group's sophistication and focus on long-term intelligence gathering.\n\n---\n\n## Threat Overview\nThe attack began with Flax Typhoon gaining initial access to a public-facing ArcGIS portal, likely by exploiting a known vulnerability. The core of their operation was the deployment of a custom web shell by modifying a legitimate Java SOE. This allowed the attackers to execute commands on an internal, private ArcGIS server by relaying them through the compromised public portal. This technique effectively laundered their malicious commands through legitimate application traffic, making detection extremely difficult. The campaign's primary objective was espionage, focusing on network reconnaissance, credential harvesting, and establishing long-term persistence for data exfiltration.\n\n## Technical Analysis\nFlax Typhoon's methodology demonstrates a high degree of operational security and technical skill.\n\n- **Web Shell Implantation ([`T1505.003 - Server Software Component: Web Shell`](https://attack.mitre.org/techniques/T1505/003/)):** The attackers modified a Java SOE on the ArcGIS server. This backdoor was designed to accept commands via malicious GET requests. The commands were Base64-encoded within a request parameter, and access was protected by a hardcoded key to prevent hijacking.\n\n- **Living-off-the-Land ([`T1059.001 - PowerShell`](https://attack.mitre.org/techniques/T1059/001/)):** Once inside, the group used **[PowerShell](https://en.wikipedia.org/wiki/PowerShell)** extensively for internal reconnaissance. They created a hidden folder named `Bridge` in the Windows system directory to stage their tools and findings.\n\n- **Credential Access ([`T1003 - OS Credential Dumping`](https://attack.mitre.org/techniques/T1003/)):** Investigators discovered a file named `pass.txt.lnk`, indicating active efforts to harvest credentials, likely to facilitate lateral movement through the victim's Active Directory environment.\n\n- **Command and Control ([`T1090.002 - External Proxy`](https://attack.mitre.org/techniques/T1090/002/)):** To establish a more stable C2 channel for data exfiltration, the group uploaded a renamed version of the **SoftEther VPN** client. This allowed them to create an encrypted tunnel out of the network, further masking their activities.\n\n## Impact Assessment\nThe compromise of an ArcGIS server poses a severe threat, particularly for government and critical infrastructure entities. These systems often house sensitive geospatial data related to national security, infrastructure planning, and emergency management. A breach can lead to:\n- **Espionage:** Theft of sensitive government plans, infrastructure layouts, and operational data.\n- **Sabotage:** Potential disruption of critical services that rely on GIS data, such as utilities and emergency response.\n- **Network Foothold:** The ArcGIS server acted as a critical pivot point into a highly secured network, potentially providing access to operational technology (OT) environments.\n- **Prolonged Exposure:** The year-long dwell time means the attackers had ample opportunity to map the entire network, exfiltrate vast quantities of data, and establish multiple points of persistence.\n\n## Cyber Observables for Detection\nSecurity teams should hunt for the following indicators associated with this campaign:\n\n| Type | Value | Description |\n|---|---|---|\n| file_path | `C:\\Windows\\Bridge\\` | Hidden staging directory created by Flax Typhoon. |\n| file_name | `pass.txt.lnk` | File indicating credential harvesting activities. |\n| url_pattern | `ArcGIS/rest/services/...` | Monitor GET requests to ArcGIS SOE endpoints containing unusually long or Base64-encoded parameters. |\n| process_name | `powershell.exe` | Suspicious PowerShell processes spawned by the ArcGIS Server service account (`arcgissoc.exe`). |\n| network_traffic_pattern | Outbound traffic to known SoftEther VPN nodes from servers not expected to use VPNs. | Could indicate the presence of the C2 channel. |\n\n## Detection & Response\n- **Log Analysis:** Scrutinize web server logs for the ArcGIS portal for GET requests with suspicious, long, or encoded parameters, especially to custom SOE endpoints. Correlate web logs with endpoint process logs to link suspicious requests to command execution.\n- **Endpoint Monitoring:** Use an EDR to monitor for the ArcGIS server process (`arcgissoc.exe` or similar) spawning command shells (`cmd.exe`, `powershell.exe`) or making outbound network connections to non-standard destinations.\n- **File Integrity Monitoring (FIM):** Implement FIM on ArcGIS server directories to detect unauthorized changes to SOE files (`.soe`, `.jar`) or the creation of suspicious directories like `C:\\Windows\\Bridge`.\n- **D3FEND Techniques:** Employ [`D3-NTA: Network Traffic Analysis`](https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis) to baseline traffic from the ArcGIS server and detect anomalous outbound connections. Use [`D3-FA: File Analysis`](https://d3fend.mitre.org/technique/d3f:FileAnalysis) on server components to identify malicious modifications.\n\n## Mitigation\n- **Patch Management:** Ensure all ArcGIS Server components are promptly patched for known vulnerabilities, as this was the likely initial access vector.\n- **Network Segmentation:** Isolate the public-facing ArcGIS portal from the internal network. The internal ArcGIS server should not be directly accessible from the portal; use a properly configured reverse proxy and firewall rules to strictly limit communication.\n- **Application Allowlisting:** Prevent the execution of unauthorized tools like the SoftEther VPN client by implementing application allowlisting on critical servers.\n- **Least Privilege:** Run the ArcGIS Server service account with the minimum necessary permissions to limit the scope of what an attacker can do if the service is compromised.\n- **D3FEND Countermeasures:** Implement [`D3-ACH: Application Configuration Hardening`](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening) by reviewing and securing ArcGIS Server settings, and use [`D3-OTF: Outbound Traffic Filtering`](https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering) to block unauthorized C2 channels.",
  "twitter_post": "Chinese APT Flax Typhoon compromised a gov agency for over a year by turning an ArcGIS server component into a web shell! üêâ The group used living-off-the-land tactics for long-term espionage. #FlaxTyphoon #APT #CyberEspionage",
  "meta_description": "Chinese APT Flax Typhoon (Ethereal Panda) was found to have compromised a government agency's ArcGIS server for over a year, modifying a legitimate component into a persistent web shell for espionage and data theft.",
  "category": [
    "Threat Actor",
    "Cyberattack",
    "Industrial Control Systems"
  ],
  "severity": "high",
  "entities": [
    {
      "name": "Flax Typhoon",
      "type": "threat_actor",
      "url": "https://attack.mitre.org/groups/G1023/"
    },
    {
      "name": "ReliaQuest",
      "type": "security_organization"
    },
    {
      "name": "Esri",
      "type": "vendor"
    },
    {
      "name": "ArcGIS Server",
      "type": "product"
    },
    {
      "name": "SoftEther VPN",
      "type": "product"
    },
    {
      "name": "PowerShell",
      "type": "technology",
      "url": "https://attack.mitre.org/techniques/T1059/001/"
    },
    {
      "name": "China",
      "type": "other"
    }
  ],
  "cves": [],
  "sources": [
    {
      "url": "https://securityaffairs.co/wordpress/169829/apt/flax-typhoon-arcgis-server-backdoor.html",
      "title": "Flax Typhoon APT exploited ArcGIS server for over a year as a backdoor",
      "date": "2025-10-06",
      "friendly_name": "Security Affairs",
      "website": "securityaffairs.co"
    },
    {
      "url": "https://www.infosecurity-magazine.com/news/chinese-hackers-trusted-arcgis-app/",
      "title": "Chinese Hackers Use Trusted ArcGIS App For Year-Long Persistence",
      "date": "2025-10-05",
      "friendly_name": "Infosecurity Magazine",
      "website": "infosecurity-magazine.com"
    }
  ],
  "events": [],
  "mitre_techniques": [
    {
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "tactic": "Initial Access"
    },
    {
      "id": "T1505.003",
      "name": "Server Software Component: Web Shell",
      "tactic": "Persistence"
    },
    {
      "id": "T1059.001",
      "name": "PowerShell",
      "tactic": "Execution"
    },
    {
      "id": "T1003",
      "name": "OS Credential Dumping",
      "tactic": "Credential Access"
    },
    {
      "id": "T1071.001",
      "name": "Application Layer Protocol: Web Protocols",
      "tactic": "Command and Control"
    },
    {
      "id": "T1572",
      "name": "Protocol Tunneling",
      "tactic": "Command and Control"
    },
    {
      "id": "T1133",
      "name": "External Remote Services",
      "tactic": "Persistence"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "Regularly patch public-facing applications like ArcGIS Server to prevent initial access via known vulnerabilities.",
      "domain": "enterprise"
    },
    {
      "id": "M1030",
      "name": "Network Segmentation",
      "d3fend_techniques": [
        {
          "id": "D3-NI",
          "name": "Network Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:NetworkIsolation"
        },
        {
          "id": "D3-ITF",
          "name": "Inbound Traffic Filtering",
          "url": "https://d3fend.mitre.org/technique/d3f:InboundTrafficFiltering"
        }
      ],
      "description": "Segment the network to isolate critical systems and prevent lateral movement from a compromised web server.",
      "domain": "enterprise"
    },
    {
      "id": "M1037",
      "name": "Filter Network Traffic",
      "d3fend_techniques": [
        {
          "id": "D3-NI",
          "name": "Network Isolation",
          "url": "https://d3fend.mitre.org/technique/d3f:NetworkIsolation"
        }
      ],
      "description": "Implement egress filtering to block outbound connections to unauthorized destinations, such as known VPN services.",
      "domain": "enterprise"
    },
    {
      "id": "M1038",
      "name": "Execution Prevention",
      "d3fend_techniques": [
        {
          "id": "D3-EAL",
          "name": "Executable Allowlisting",
          "url": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting"
        }
      ],
      "description": "Use application control policies to prevent the execution of unauthorized software, such as renamed VPN clients or other hacking tools.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-NTA",
      "technique_name": "Network Traffic Analysis",
      "url": "https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis",
      "recommendation": "Deploy network traffic analysis tools to monitor and baseline all traffic to and from the ArcGIS server. Specifically, focus on analyzing the content of GET requests to ArcGIS SOE endpoints. Develop signatures to detect Base64-encoded payloads within URL parameters, which was a key TTP for Flax Typhoon's C2. Furthermore, monitor for and alert on any outbound connections from the server to unexpected IP addresses or domains, especially those associated with commercial VPN providers like SoftEther. By establishing a clear baseline of what constitutes normal application traffic, security teams can more effectively spot the subtle deviations that indicate a web shell or other C2 channel is active.",
      "mitre_mitigation_id": "M1031"
    },
    {
      "technique_id": "D3-ACH",
      "technique_name": "Application Configuration Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening",
      "recommendation": "Perform a thorough security review of the ArcGIS Server configuration. This includes removing or disabling any unnecessary Server Object Extensions (SOEs) to reduce the attack surface. Implement a file integrity monitoring (FIM) solution on the ArcGIS installation directories to immediately alert on any unauthorized modifications to legitimate SOE files or the addition of new ones. The service account for ArcGIS Server should be configured with the principle of least privilege, restricting its ability to write to system directories (like C:\\Windows) or execute administrative tools like PowerShell. This hardening directly counters the attacker's ability to implant a web shell and use the compromised service for lateral movement.",
      "mitre_mitigation_id": "M1054"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "file_path",
      "value": "C:\\Windows\\Bridge",
      "description": "Hidden staging directory created by Flax Typhoon to store tools and harvested data.",
      "context": "File system monitoring on Windows servers.",
      "confidence": "high"
    },
    {
      "type": "file_name",
      "value": "pass.txt.lnk",
      "description": "Indicator of active credential theft efforts by the threat actor.",
      "context": "File integrity monitoring and endpoint detection.",
      "confidence": "high"
    },
    {
      "type": "command_line_pattern",
      "value": "powershell.exe -ExecutionPolicy Bypass",
      "description": "Common command used by attackers to execute malicious scripts after gaining a foothold.",
      "context": "Process creation logs (Event ID 4688).",
      "confidence": "medium"
    },
    {
      "type": "process_name",
      "value": "arcgissoc.exe",
      "description": "The ArcGIS Server Object Container process. Monitor for this process spawning shells (cmd, powershell) or making unusual network connections.",
      "context": "EDR telemetry and process monitoring logs.",
      "confidence": "high"
    },
    {
      "type": "url_pattern",
      "value": "/arcgis/rest/services/",
      "description": "Monitor GET requests to ArcGIS Server Object Extension (SOE) endpoints that contain long, random, or Base64-encoded strings in parameters.",
      "context": "Web server access logs, WAF logs.",
      "confidence": "medium"
    }
  ],
  "tags": [
    "APT",
    "Flax Typhoon",
    "Web Shell",
    "Living-off-the-land",
    "Espionage",
    "ArcGIS",
    "Government"
  ],
  "extract_datetime": "2025-10-06T15:00:00.000Z",
  "article_type": "Analysis",
  "impact_scope": {
    "geographic_scope": "regional",
    "countries_affected": [
      "Taiwan"
    ],
    "industries_affected": [
      "Government",
      "Critical Infrastructure"
    ]
  },
  "pub_date": "2025-10-06",
  "reading_time_minutes": 5,
  "createdAt": "2025-10-06T15:00:00.000Z",
  "updatedAt": "2025-10-06T15:00:00.000Z"
}