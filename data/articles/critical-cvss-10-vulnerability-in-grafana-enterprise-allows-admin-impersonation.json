{
  "id": "2abf3c99-d8f3-4267-a037-b4364539a558",
  "slug": "critical-cvss-10-vulnerability-in-grafana-enterprise-allows-admin-impersonation",
  "headline": "Grafana Enterprise Hit by Critical 10.0 CVSS Flaw Allowing Admin Impersonation",
  "title": "Grafana Patches Critical CVSS 10.0 Vulnerability (CVE-2025-41115) Enabling Admin Impersonation",
  "summary": "Grafana Labs has patched a critical vulnerability, CVE-2025-41115, in Grafana Enterprise that carries the maximum CVSS score of 10.0. The flaw resides in the SCIM provisioning feature and allows a malicious SCIM client to escalate privileges and impersonate any user, including the default administrator, by manipulating the 'externalId' attribute. The vulnerability affects Grafana Enterprise versions 12.0.0 through 12.2.1 and requires specific feature flags to be enabled. Grafana has released patches and confirmed its own cloud instances were not exploited.",
  "full_report": "## Executive Summary\n\n**[Grafana Labs](https://grafana.com/)** has addressed a critical-severity vulnerability, **CVE-2025-41115**, in its **[Grafana Enterprise](https://grafana.com/products/enterprise/)** product, assigning it the highest possible CVSS score of 10.0. The flaw allows a malicious or compromised SCIM client to impersonate any user, including administrators, leading to a complete takeover of the Grafana instance. The vulnerability is a logic flaw in how Grafana's System for Cross-domain Identity Management (SCIM) feature handles user provisioning. An attacker can craft a SCIM request that maps their external ID to the internal ID of a privileged user, thereby inheriting their permissions. The issue affects Grafana Enterprise versions `12.0.0` through `12.2.1` under specific configurations. Grafana has released patched versions and urges all on-premise customers to upgrade immediately.\n\n---\n\n## Vulnerability Details\n\nThe vulnerability, **CVE-2025-41115**, is a privilege escalation flaw rooted in the SCIM implementation. SCIM is a standard used to automate user provisioning from an Identity Provider (IdP) to a Service Provider (like Grafana).\n\nThe core of the issue lies in the handling of the `externalId` attribute in a SCIM request. Grafana's code incorrectly mapped this attacker-controllable field directly to the internal `user.uid` field. The `user.uid` is an integer that uniquely identifies a user within Grafana's database and determines their role and permissions. The default administrator account, for example, typically has a `user.uid` of `1`.\n\nAn attacker with control over a SCIM client could send a provisioning request for a new user but set the `externalId` to `\"1\"`. Grafana would process this request and, due to the flaw, associate the new SCIM user with the existing user who has `uid=1`. This effectively grants the attacker's new account the same privileges as the default administrator, allowing complete impersonation and takeover without needing a password or any other form of authentication for that admin account.\n\n## Exploitation Status\n\nThe vulnerability was discovered internally by Grafana's security team on November 4, 2025. There is currently no evidence of this vulnerability being exploited in the wild. Grafana confirmed that its own Grafana Cloud instances were not vulnerable and were patched within hours of discovery. Patches were also coordinated with cloud partners like **[Amazon](https://aws.amazon.com/)** Managed Grafana and **[Azure](https://azure.microsoft.com/)** Managed Grafana before the public disclosure.\n\n## Affected Systems\n\n*   **[Grafana Enterprise](https://grafana.com/products/enterprise/)** versions `12.0.0` through `12.2.1`\n\nFor the vulnerability to be exploitable, the following two conditions must be met in the Grafana configuration file:\n1.  The SCIM feature flag must be enabled: `enableSCIM=true`\n2.  The user synchronization option must be enabled: `user_sync_enabled=true`\n\n## Impact Assessment\n\nA successful exploit of **CVE-2025-41115** results in a full administrative takeover of a Grafana Enterprise instance. Grafana is a central tool for monitoring and observability, often connected to dozens or hundreds of critical data sources, including databases, cloud environments, and application servers. An attacker with admin access could:\n*   View, modify, or delete any dashboard or data source.\n*   Extract sensitive credentials for connected data sources (e.g., database passwords, API keys).\n*   Create rogue administrator accounts to maintain persistence.\n*   Manipulate dashboards to hide malicious activity or cause misdirection during an incident.\n*   Pivot from Grafana into other parts of the corporate network using the stolen data source credentials.\n\nGiven Grafana's central role in many IT environments, the impact of a compromise is extremely severe.\n\n## IOCs\n\nAs this was discovered internally and there is no known exploitation, no IOCs are available.\n\n## Cyber Observables for Detection\n\n| Type | Value | Description | Context | Confidence |\n|---|---|---|---|---|\n| log_source | Grafana Server Logs | Look for log entries related to SCIM user synchronization, particularly for updates to existing high-privilege accounts. | Application Log Monitoring, SIEM | high |\n| api_endpoint | `/api/scim/v2/Users` | Monitor for POST or PUT requests to the SCIM API endpoint with a numeric `externalId` value. | WAF, Reverse Proxy Logs | high |\n| configuration_file | `grafana.ini` | Search for the configuration `enableSCIM=true` and `user_sync_enabled=true` to identify vulnerable instances. | Asset Inventory, Configuration Management Database (CMDB) | high |\n\n## Detection Methods\n\n1.  **Vulnerability Identification**: The most reliable detection method is to check the version of Grafana Enterprise and its configuration. Any instance between versions `12.0.0` and `12.2.1` with both `enableSCIM` and `user_sync_enabled` set to `true` is vulnerable.\n\n2.  **Log Review**: Review Grafana server logs for unusual SCIM activity. Specifically, look for logs indicating that a privileged user account (like `admin`) was updated via the SCIM sync process. An example log message might look like `t=2025-11-19T10:00:00.000Z lvl=info logger=scim.sync message=\"User synced\" user_id=1 ...` where the update was not expected. This is a form of **[D3-LAM: Local Account Monitoring](https://d3fend.mitre.org/technique/d3f:LocalAccountMonitoring)**.\n\n## Remediation Steps\n\nGrafana Labs has released patched versions to address this vulnerability. On-premise administrators must upgrade immediately.\n\n1.  **Upgrade Grafana Enterprise**: Upgrade to one of the following patched versions or later:\n    *   `12.3`\n    *   `12.2.1`\n    *   `12.1.3`\n    *   `12.0.6`\n\n    This is the most effective remediation and is an application of **[D3-SU: Software Update](https://d3fend.mitre.org/technique/d3f:SoftwareUpdate)**.\n\n2.  **Workaround**: If upgrading is not immediately possible, disable the SCIM feature as a temporary mitigation. This can be done by setting `enableSCIM = false` in the `grafana.ini` configuration file and restarting the Grafana service. This is a form of **[D3-ACH: Application Configuration Hardening](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening)**. However, this will break any automated user provisioning workflows and should only be a temporary measure.",
  "twitter_post": "ðŸ”¥ CRITICAL FLAW: Grafana Enterprise is hit by a 10.0 CVSS vulnerability (CVE-2025-41115). The bug in the SCIM feature allows admin impersonation and full takeover. Patch immediately! ðŸš¨ #Grafana #CVE #Vulnerability #CyberSecurity",
  "meta_description": "Grafana Labs has patched a critical, CVSS 10.0 vulnerability (CVE-2025-41115) in Grafana Enterprise that allows for complete administrator impersonation via the SCIM feature. Details on the flaw and mitigation steps.",
  "category": [
    "Vulnerability",
    "Patch Management",
    "Cloud Security"
  ],
  "severity": "critical",
  "entities": [
    {
      "name": "Grafana Labs",
      "type": "vendor",
      "url": "https://grafana.com/"
    },
    {
      "name": "Grafana Enterprise",
      "type": "product",
      "url": "https://grafana.com/products/enterprise/"
    },
    {
      "name": "SCIM",
      "type": "technology"
    },
    {
      "name": "Amazon",
      "type": "company",
      "url": "https://aws.amazon.com/"
    },
    {
      "name": "Azure",
      "type": "product",
      "url": "https://azure.microsoft.com/"
    }
  ],
  "cves": [
    {
      "id": "CVE-2025-41115",
      "cvss_score": 10,
      "cvss_version": "3.1",
      "kev": false,
      "severity": "critical"
    }
  ],
  "sources": [
    {
      "url": "https://thehackernews.com/2025/11/grafana-patches-cvss-100-scim-flaw.html",
      "title": "Grafana Patches CVSS 10.0 SCIM Flaw Enabling Impersonation and Privilege Escalation",
      "date": "2025-11-21",
      "friendly_name": "The Hacker News",
      "website": "thehackernews.com"
    },
    {
      "url": "https://www.esecurityplanet.com/threats/grafana-scim-vulnerability/",
      "title": "Grafana SCIM Flaw Allows Admin Impersonation and Full Takeover",
      "date": "2025-11-21",
      "friendly_name": "eSecurity Planet",
      "website": "esecurityplanet.com"
    },
    {
      "url": "https://www.cyberpress.com/attackers-escalate-privilege-through-critical-grafana-vulnerability/",
      "title": "Attackers Escalate Privilege Through Critical Grafana Vulnerability",
      "date": "2025-11-21",
      "friendly_name": "Cyber Press",
      "website": "cyberpress.com"
    },
    {
      "url": "https://blog.fieldaffect.com/cve-2025-41115-grafana-enterprise-scim-privilege-escalation/",
      "title": "Maximum-severity Grafana Enterprise vulnerability exposes identity provisioning",
      "date": "2025-11-21",
      "friendly_name": "Field Affect",
      "website": "fieldaffect.com"
    }
  ],
  "events": [
    {
      "datetime": "2025-11-04",
      "summary": "Grafana's internal security team discovers the CVE-2025-41115 vulnerability."
    },
    {
      "datetime": "2025-11-19",
      "summary": "Grafana publicly discloses the vulnerability and releases patched versions."
    }
  ],
  "mitre_techniques": [
    {
      "id": "T1068",
      "name": "Exploitation for Privilege Escalation",
      "tactic": "Privilege Escalation"
    },
    {
      "id": "T1098.002",
      "name": "Account Manipulation: Exchange Email Delegate Permissions",
      "tactic": "Privilege Escalation"
    },
    {
      "id": "T1078",
      "name": "Valid Accounts",
      "tactic": "Defense Evasion"
    }
  ],
  "mitre_mitigations": [
    {
      "id": "M1051",
      "name": "Update Software",
      "d3fend_techniques": [
        {
          "id": "D3-SU",
          "name": "Software Update",
          "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate"
        }
      ],
      "description": "The primary mitigation is to upgrade to a patched version of Grafana Enterprise.",
      "domain": "enterprise"
    },
    {
      "id": "M1042",
      "name": "Disable or Remove Feature or Program",
      "d3fend_techniques": [
        {
          "id": "D3-ACH",
          "name": "Application Configuration Hardening",
          "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening"
        },
        {
          "id": "D3-EDL",
          "name": "Executable Denylisting",
          "url": "https://d3fend.mitre.org/technique/d3f:ExecutableDenylisting"
        },
        {
          "id": "D3-SCF",
          "name": "System Call Filtering",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemCallFiltering"
        }
      ],
      "description": "As a temporary workaround, disable the SCIM feature in the Grafana configuration.",
      "domain": "enterprise"
    },
    {
      "id": "M1047",
      "name": "Audit",
      "d3fend_techniques": [
        {
          "id": "D3-DAM",
          "name": "Domain Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:DomainAccountMonitoring"
        },
        {
          "id": "D3-LAM",
          "name": "Local Account Monitoring",
          "url": "https://d3fend.mitre.org/technique/d3f:LocalAccountMonitoring"
        },
        {
          "id": "D3-SFA",
          "name": "System File Analysis",
          "url": "https://d3fend.mitre.org/technique/d3f:SystemFileAnalysis"
        }
      ],
      "description": "Audit Grafana server logs for unexpected SCIM synchronization events affecting privileged accounts.",
      "domain": "enterprise"
    }
  ],
  "d3fend_countermeasures": [
    {
      "technique_id": "D3-SU",
      "technique_name": "Software Update",
      "url": "https://d3fend.mitre.org/technique/d3f:SoftwareUpdate",
      "recommendation": "The only definitive countermeasure for CVE-2025-41115 is to upgrade all on-premise Grafana Enterprise instances to a patched version (12.3, 12.2.1, 12.1.3, or 12.0.6 and later). This vulnerability is a logic flaw within the application code, and no amount of network filtering or endpoint protection can reliably prevent its exploitation if the vulnerable code is present. Given the 10.0 CVSS score and the potential for complete system takeover, this update should be treated as an emergency change. Administrators must prioritize this patch above all others. After updating, it is crucial to verify the new version is running correctly and to review audit logs for any suspicious account modifications that may have occurred prior to the patch.",
      "mitre_mitigation_id": "M1051"
    },
    {
      "technique_id": "D3-ACH",
      "technique_name": "Application Configuration Hardening",
      "url": "https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening",
      "recommendation": "For organizations unable to patch immediately, the only viable temporary mitigation is to disable the vulnerable feature. This involves editing the `grafana.ini` configuration file and setting `enableSCIM = false`. This action completely removes the attack surface. However, this is a disruptive change that will break any automated user provisioning from an identity provider via SCIM. It should be used only as a stopgap measure while the upgrade is being planned and tested. Furthermore, this incident should prompt a broader review of all feature flags and configurations in Grafana. Any features that are not actively in use should be disabled to reduce the overall attack surface of the application, following the principle of least functionality.",
      "mitre_mitigation_id": "M1054"
    }
  ],
  "iocs": [],
  "cyber_observables": [
    {
      "type": "api_endpoint",
      "value": "/api/scim/v2/Users",
      "description": "The SCIM API endpoint that is targeted by the exploit. Monitor for POST/PUT requests with a numeric 'externalId' field.",
      "context": "WAF Logs, Application Gateway Logs",
      "confidence": "high"
    },
    {
      "type": "log_source",
      "value": "grafana.log",
      "description": "Grafana's server log file. Look for log entries related to SCIM synchronization of privileged accounts.",
      "context": "SIEM, Log Management Platform",
      "confidence": "high"
    },
    {
      "type": "registry_key",
      "value": "HKEY_LOCAL_MACHINE\\SOFTWARE\\GrafanaLabs\\Grafana",
      "description": "On Windows, the Grafana installation path can be found here, which can lead to the vulnerable configuration file.",
      "context": "Asset Inventory, Endpoint Management",
      "confidence": "low"
    }
  ],
  "tags": [
    "CVE-2025-41115",
    "Grafana",
    "Vulnerability",
    "Privilege Escalation",
    "CVSS 10",
    "SCIM",
    "Patch Management"
  ],
  "extract_datetime": "2025-11-22T15:00:00.000Z",
  "article_type": "Advisory",
  "impact_scope": {
    "geographic_scope": "global",
    "industries_affected": [
      "Technology",
      "Finance",
      "Healthcare",
      "Retail"
    ],
    "other_affected": [
      "Users of on-premise Grafana Enterprise"
    ]
  },
  "pub_date": "2025-11-22",
  "reading_time_minutes": 5,
  "createdAt": "2025-11-22T15:00:00.000Z",
  "updatedAt": "2025-11-22T15:00:00.000Z"
}